/home/kim3118/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
2024-08-16 12:08:23.286 | INFO     | __main__:main:747 - tau: 50
2024-08-16 12:08:23.286 | INFO     | __main__:main:758 - Single-label training mode. arch
2024-08-16 12:08:26.278 | INFO     | __main__:train:144 - Training with model: longformer, lr: 5e-05, batch_size: 32, epoch: 30, loss_fn:CLCE, lambd:0.3
2024-08-16 12:08:26.279 | INFO     | __main__:train:159 - ====epoch #1====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:04<06:03,  4.32s/it]
Training:   2%|▏         | 2/85 [00:07<05:14,  3.79s/it]
Training:   4%|▎         | 3/85 [00:11<04:56,  3.62s/it]
Training:   5%|▍         | 4/85 [00:14<04:46,  3.54s/it]
Training:   6%|▌         | 5/85 [00:17<04:39,  3.49s/it]
Training:   7%|▋         | 6/85 [00:21<04:34,  3.47s/it]
Training:   8%|▊         | 7/85 [00:24<04:29,  3.45s/it]
Training:   9%|▉         | 8/85 [00:28<04:24,  3.44s/it]
Training:  11%|█         | 9/85 [00:31<04:20,  3.43s/it]
Training:  12%|█▏        | 10/85 [00:35<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:38<04:13,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.42s/it]
Training:  15%|█▌        | 13/85 [00:45<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:52<03:59,  3.42s/it]
Training:  19%|█▉        | 16/85 [00:55<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:59<04:00,  3.53s/it]
Training:  21%|██        | 18/85 [01:02<03:54,  3.50s/it]
Training:  22%|██▏       | 19/85 [01:06<03:49,  3.47s/it]
Training:  24%|██▎       | 20/85 [01:09<03:44,  3.45s/it]
Training:  25%|██▍       | 21/85 [01:13<03:40,  3.44s/it]
Training:  26%|██▌       | 22/85 [01:16<03:36,  3.44s/it]
Training:  27%|██▋       | 23/85 [01:19<03:32,  3.43s/it]
Training:  28%|██▊       | 24/85 [01:23<03:28,  3.43s/it]
Training:  29%|██▉       | 25/85 [01:26<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:30<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:33<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:36<03:15,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:40<03:11,  3.42s/it]
Training:  35%|███▌      | 30/85 [01:43<03:08,  3.42s/it]
Training:  36%|███▋      | 31/85 [01:47<03:04,  3.42s/it]
Training:  38%|███▊      | 32/85 [01:50<03:01,  3.42s/it]
Training:  39%|███▉      | 33/85 [01:54<02:58,  3.42s/it]
Training:  40%|████      | 34/85 [01:57<02:54,  3.42s/it]
Training:  41%|████      | 35/85 [02:00<02:51,  3.43s/it]
Training:  42%|████▏     | 36/85 [02:04<02:47,  3.43s/it]
Training:  44%|████▎     | 37/85 [02:07<02:44,  3.43s/it]
Training:  45%|████▍     | 38/85 [02:11<02:40,  3.42s/it]
Training:  46%|████▌     | 39/85 [02:14<02:37,  3.43s/it]
Training:  47%|████▋     | 40/85 [02:18<02:34,  3.43s/it]
Training:  48%|████▊     | 41/85 [02:21<02:30,  3.43s/it]
Training:  49%|████▉     | 42/85 [02:24<02:27,  3.43s/it]
Training:  51%|█████     | 43/85 [02:28<02:23,  3.43s/it]
Training:  52%|█████▏    | 44/85 [02:31<02:20,  3.43s/it]
Training:  53%|█████▎    | 45/85 [02:35<02:17,  3.43s/it]
Training:  54%|█████▍    | 46/85 [02:38<02:13,  3.43s/it]
Training:  55%|█████▌    | 47/85 [02:42<02:10,  3.43s/it]
Training:  56%|█████▋    | 48/85 [02:45<02:06,  3.43s/it]
Training:  58%|█████▊    | 49/85 [02:48<02:03,  3.43s/it]
Training:  59%|█████▉    | 50/85 [02:52<02:00,  3.43s/it]
Training:  60%|██████    | 51/85 [02:55<01:56,  3.43s/it]
Training:  61%|██████    | 52/85 [02:59<01:53,  3.43s/it]
Training:  62%|██████▏   | 53/85 [03:02<01:49,  3.43s/it]
Training:  64%|██████▎   | 54/85 [03:06<01:46,  3.43s/it]
Training:  65%|██████▍   | 55/85 [03:09<01:42,  3.43s/it]
Training:  66%|██████▌   | 56/85 [03:12<01:39,  3.43s/it]
Training:  67%|██████▋   | 57/85 [03:16<01:35,  3.43s/it]
Training:  68%|██████▊   | 58/85 [03:19<01:32,  3.43s/it]
Training:  69%|██████▉   | 59/85 [03:23<01:29,  3.42s/it]
Training:  71%|███████   | 60/85 [03:26<01:25,  3.42s/it]
Training:  72%|███████▏  | 61/85 [03:30<01:22,  3.42s/it]
Training:  73%|███████▎  | 62/85 [03:33<01:18,  3.42s/it]
Training:  74%|███████▍  | 63/85 [03:36<01:15,  3.42s/it]
Training:  75%|███████▌  | 64/85 [03:40<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:43<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:47<01:05,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:50<01:01,  3.42s/it]
Training:  80%|████████  | 68/85 [03:53<00:58,  3.42s/it]
Training:  81%|████████  | 69/85 [03:57<00:54,  3.42s/it]
Training:  82%|████████▏ | 70/85 [04:00<00:51,  3.42s/it]
Training:  84%|████████▎ | 71/85 [04:04<00:47,  3.42s/it]
Training:  85%|████████▍ | 72/85 [04:07<00:44,  3.42s/it]
Training:  86%|████████▌ | 73/85 [04:11<00:41,  3.42s/it]
Training:  87%|████████▋ | 74/85 [04:14<00:37,  3.42s/it]
Training:  88%|████████▊ | 75/85 [04:17<00:34,  3.42s/it]
Training:  89%|████████▉ | 76/85 [04:21<00:30,  3.42s/it]
Training:  91%|█████████ | 77/85 [04:24<00:27,  3.42s/it]
Training:  92%|█████████▏| 78/85 [04:28<00:23,  3.42s/it]
Training:  93%|█████████▎| 79/85 [04:31<00:20,  3.42s/it]
Training:  94%|█████████▍| 80/85 [04:35<00:17,  3.42s/it]
Training:  95%|█████████▌| 81/85 [04:38<00:13,  3.42s/it]
Training:  96%|█████████▋| 82/85 [04:41<00:10,  3.42s/it]
Training:  98%|█████████▊| 83/85 [04:45<00:06,  3.42s/it]
Training:  99%|█████████▉| 84/85 [04:48<00:03,  3.42s/it]
Training: 100%|██████████| 85/85 [04:52<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:52<00:00,  3.44s/it]
2024-08-16 12:13:18.511 | INFO     | __main__:train:207 - Epoch 1 Average Loss: 10.77589
2024-08-16 12:13:19.258 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL1*****
2024-08-16 12:13:19.259 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:13:19.259 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.19it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:13,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.24it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:13:36.485 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     0.8333    1.0000    0.9091         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.0000    0.0000       nan         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration     0.1000    0.3333    0.1538         3
                     BartForQuestionAnswering     0.0000    0.0000       nan         3
                BartForSequenceClassification     0.0000    0.0000       nan         7
                                    BartModel     0.0000    0.0000       nan         4
                   BeitForImageClassification     0.5714    0.6667    0.6154         6
                                    BertForCL     0.1111    0.5714    0.1860         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification        nan    0.0000       nan         4
                   BertForTokenClassification        nan    0.0000       nan         3
                   BertForV2QuestionAnswering     0.2778    1.0000    0.4348        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM        nan    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration        nan    0.0000       nan         5
                                    CLIPModel        nan    0.0000       nan         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.0305    0.6667    0.0584         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM        nan    0.0000       nan         4
               ConvNextForImageClassification     0.7000    1.0000    0.8235         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder        nan    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.1923    1.0000    0.3226         5
             DebertaForSequenceClassification        nan    0.0000       nan         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.2500    1.0000    0.4000         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification        nan    0.0000       nan         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection        nan    0.0000       nan         3
                        DistilBertForMaskedLM     0.1613    1.0000    0.2778         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering     0.0000    0.0000       nan         5
          DistilBertForSequenceClassification     0.2500    0.6000    0.3529         5
             DistilBertForTokenClassification        nan    0.0000       nan         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM     0.0217    0.2500    0.0400         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.4000    0.6667    0.5000         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification        nan    0.0000       nan         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM        nan    0.0000       nan         6
                            GPTNeoForCausalLM     1.0000    0.3333    0.5000         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM        nan    0.0000       nan         2
                  LEDForConditionalGeneration     0.4167    1.0000    0.5882         5
              LSGBartForConditionalGeneration        nan    0.0000       nan         5
                LSTMForSequenceClassification        nan    0.0000       nan         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification        nan    0.0000       nan         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM        nan    0.0000       nan         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration        nan    0.0000       nan         3
                        LongformerForMaskedLM     0.0357    1.0000    0.0690         2
               LongformerForQuestionAnswering     0.0000    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration        nan    0.0000       nan         4
                MBartForConditionalGeneration        nan    0.0000       nan         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.0000    0.0000       nan         6
                                   MPNetModel        nan    0.0000       nan         7
                               MPTForCausalLM        nan    0.0000       nan         6
                  MT5ForConditionalGeneration        nan    0.0000       nan         6
                                MarianMTModel     1.0000    0.6000    0.7500         5
          Mask2FormerForUniversalSegmentation     0.5000    0.1250    0.2000         8
            MaskFormerForInstanceSegmentation     0.1579    0.6000    0.2500         5
          MobileBertForSequenceClassification        nan    0.0000       nan         5
            MobileNetV2ForImageClassification        nan    0.0000       nan         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.2000    0.3333         5
               PLBartForConditionalGeneration     0.3529    1.0000    0.5217         6
              PegasusForConditionalGeneration        nan    0.0000       nan         7
             PegasusXForConditionalGeneration        nan    0.0000       nan         1
                 RegNetForImageClassification     0.2143    1.0000    0.3529         3
                 ResNetForImageClassification        nan    0.0000       nan         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification        nan    0.0000       nan         6
                  RobertaForQuestionAnswering        nan    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering        nan    0.0000       nan         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM        nan    0.0000       nan         5
                                     SamModel        nan    0.0000       nan         2
             SegformerForSemanticSegmentation     0.6000    1.0000    0.7500         3
          Speech2TextForConditionalGeneration     0.0000    0.0000       nan         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     0.5556    0.8333    0.6667         6
                               T5EncoderModel        nan    0.0000       nan         4
                                      T5Model     0.4000    0.5000    0.4444         4
                            T5WithLMHeadModel        nan    0.0000       nan         6
                              UniSpeechForCTC     0.4286    0.7500    0.5455         4
                           UniSpeechSatForCTC        nan    0.0000       nan         2
                    ViTForImageClassification        nan    0.0000       nan         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC        nan    0.0000       nan        11
                           Wav2Vec2ForCTCnCLS     0.1765    1.0000    0.3000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.2000    0.5000    0.2857         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.1333    1.0000    0.2353         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration        nan    0.0000       nan         8
                              XGLMForCausalLM     0.7500    0.7500    0.7500         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering        nan    0.0000       nan         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.0000    0.0000       nan         7
               XLNetForSequenceClassification        nan    0.0000       nan         7
                             XLNetLMHeadModel        nan    0.0000       nan         4
                      YolosForObjectDetection        nan    0.0000       nan         3

                                    micro avg     0.1850    0.1850    0.1850       681
                                    macro avg     0.3410    0.1780    0.4928       681
                                 weighted avg     0.3357    0.1850    0.4806       681

2024-08-16 12:13:36.485 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.185
2024-08-16 12:13:36.497 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:13:36.497 | INFO     | __main__:eval:454 - Validation loss: 13.717152335427024
2024-08-16 12:13:36.503 | INFO     | __main__:train:256 - epochs: 1
2024-08-16 12:13:36.504 | INFO     | __main__:train:257 - train_loss: [10.775885727826287]
2024-08-16 12:13:36.504 | INFO     | __main__:train:258 - test_loss: [13.717152335427024]
2024-08-16 12:13:36.504 | INFO     | __main__:train:159 - ====epoch #2====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:01,  3.59s/it]
Training:   2%|▏         | 2/85 [00:07<04:49,  3.49s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.46s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.44s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.42s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:13,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.42s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:48<04:03,  3.43s/it]
Training:  18%|█▊        | 15/85 [00:51<04:00,  3.43s/it]
Training:  19%|█▉        | 16/85 [00:54<03:56,  3.43s/it]
Training:  20%|██        | 17/85 [00:58<03:53,  3.43s/it]
Training:  21%|██        | 18/85 [01:01<03:49,  3.43s/it]
Training:  22%|██▏       | 19/85 [01:05<03:46,  3.43s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.43s/it]
Training:  25%|██▍       | 21/85 [01:12<03:39,  3.43s/it]
Training:  26%|██▌       | 22/85 [01:15<03:36,  3.43s/it]
Training:  27%|██▋       | 23/85 [01:18<03:32,  3.43s/it]
Training:  28%|██▊       | 24/85 [01:22<03:29,  3.43s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.43s/it]
Training:  31%|███       | 26/85 [01:29<03:22,  3.43s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.43s/it]
Training:  33%|███▎      | 28/85 [01:36<03:15,  3.43s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.43s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.43s/it]
Training:  36%|███▋      | 31/85 [01:46<03:05,  3.43s/it]
Training:  38%|███▊      | 32/85 [01:49<03:01,  3.43s/it]
Training:  39%|███▉      | 33/85 [01:53<02:58,  3.43s/it]
Training:  40%|████      | 34/85 [01:56<02:54,  3.43s/it]
Training:  41%|████      | 35/85 [02:00<02:51,  3.43s/it]
Training:  42%|████▏     | 36/85 [02:03<02:48,  3.43s/it]
Training:  44%|████▎     | 37/85 [02:06<02:44,  3.43s/it]
Training:  45%|████▍     | 38/85 [02:10<02:41,  3.43s/it]
Training:  46%|████▌     | 39/85 [02:13<02:37,  3.43s/it]
Training:  47%|████▋     | 40/85 [02:17<02:34,  3.42s/it]
Training:  48%|████▊     | 41/85 [02:20<02:30,  3.43s/it]
Training:  49%|████▉     | 42/85 [02:24<02:27,  3.43s/it]
Training:  51%|█████     | 43/85 [02:27<02:23,  3.43s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:20,  3.43s/it]
Training:  53%|█████▎    | 45/85 [02:34<02:17,  3.43s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:13,  3.43s/it]
Training:  55%|█████▌    | 47/85 [02:41<02:10,  3.43s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:06,  3.43s/it]
Training:  58%|█████▊    | 49/85 [02:48<02:03,  3.43s/it]
Training:  59%|█████▉    | 50/85 [02:51<02:00,  3.43s/it]
Training:  60%|██████    | 51/85 [02:54<01:56,  3.43s/it]
Training:  61%|██████    | 52/85 [02:58<01:53,  3.43s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.43s/it]
Training:  64%|██████▎   | 54/85 [03:05<01:46,  3.43s/it]
Training:  65%|██████▍   | 55/85 [03:08<01:42,  3.43s/it]
Training:  66%|██████▌   | 56/85 [03:12<01:39,  3.43s/it]
Training:  67%|██████▋   | 57/85 [03:15<01:36,  3.43s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.43s/it]
Training:  69%|██████▉   | 59/85 [03:22<01:29,  3.43s/it]
Training:  71%|███████   | 60/85 [03:25<01:25,  3.43s/it]
Training:  72%|███████▏  | 61/85 [03:29<01:22,  3.43s/it]
Training:  73%|███████▎  | 62/85 [03:32<01:18,  3.43s/it]
Training:  74%|███████▍  | 63/85 [03:36<01:15,  3.43s/it]
Training:  75%|███████▌  | 64/85 [03:39<01:11,  3.43s/it]
Training:  76%|███████▋  | 65/85 [03:42<01:08,  3.43s/it]
Training:  78%|███████▊  | 66/85 [03:46<01:05,  3.43s/it]
Training:  79%|███████▉  | 67/85 [03:49<01:01,  3.43s/it]
Training:  80%|████████  | 68/85 [03:53<00:58,  3.43s/it]
Training:  81%|████████  | 69/85 [03:56<00:54,  3.43s/it]
Training:  82%|████████▏ | 70/85 [04:00<00:51,  3.43s/it]
Training:  84%|████████▎ | 71/85 [04:03<00:47,  3.43s/it]
Training:  85%|████████▍ | 72/85 [04:06<00:44,  3.43s/it]
Training:  86%|████████▌ | 73/85 [04:10<00:41,  3.43s/it]
Training:  87%|████████▋ | 74/85 [04:13<00:37,  3.43s/it]
Training:  88%|████████▊ | 75/85 [04:17<00:34,  3.43s/it]
Training:  89%|████████▉ | 76/85 [04:20<00:30,  3.43s/it]
Training:  91%|█████████ | 77/85 [04:24<00:27,  3.43s/it]
Training:  92%|█████████▏| 78/85 [04:27<00:24,  3.43s/it]
Training:  93%|█████████▎| 79/85 [04:30<00:20,  3.43s/it]
Training:  94%|█████████▍| 80/85 [04:34<00:17,  3.43s/it]
Training:  95%|█████████▌| 81/85 [04:37<00:13,  3.43s/it]
Training:  96%|█████████▋| 82/85 [04:41<00:10,  3.42s/it]
Training:  98%|█████████▊| 83/85 [04:44<00:06,  3.42s/it]
Training:  99%|█████████▉| 84/85 [04:48<00:03,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.43s/it]
2024-08-16 12:18:28.006 | INFO     | __main__:train:207 - Epoch 2 Average Loss: 9.94854
2024-08-16 12:18:28.707 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL2*****
2024-08-16 12:18:28.707 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:18:28.707 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.08it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.19it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.24it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.27it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.27it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.28it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.28it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.28it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.28it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.27it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.65it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 12:18:45.595 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     0.6250    1.0000    0.7692         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.2069    1.0000    0.3429         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification        nan    0.0000       nan         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.1500    1.0000    0.2609         3
                BartForSequenceClassification     0.0000    0.0000       nan         7
                                    BartModel     0.0000    0.0000       nan         4
                   BeitForImageClassification     0.5000    0.6667    0.5714         6
                                    BertForCL        nan    0.0000       nan         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering     0.0000    0.0000       nan         5
                BertForSequenceClassification        nan    0.0000       nan         4
                   BertForTokenClassification        nan    0.0000       nan         3
                   BertForV2QuestionAnswering        nan    0.0000       nan        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM        nan    0.0000       nan         1
                  BigBirdForQuestionAnswering     0.3333    1.0000    0.5000         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    0.8000    0.8889         5
                                    CLIPModel        nan    0.0000       nan         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM     0.0870    0.2500    0.1290         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     0.6667    1.0000    0.8000         2
                           CodeGenForCausalLM     0.3333    0.2500    0.2857         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder        nan    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.2500    0.2000    0.2222         5
             DebertaForSequenceClassification        nan    0.0000       nan         6
                DebertaForTokenClassification     0.2727    1.0000    0.4286         3
                         DebertaV2ForMaskedLM     0.2273    1.0000    0.3704         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection        nan    0.0000       nan         3
                        DistilBertForMaskedLM     0.2222    0.8000    0.3478         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification        nan    0.0000       nan         6
                              DistilBertModel     0.0000    0.0000       nan         8
                                   DprEncoder     0.0455    0.2500    0.0769         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.0000    0.0000       nan         3
                    EsmForTokenClassification     0.4000    0.6667    0.5000         3
                FNetForSequenceClassification        nan    0.0000       nan         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.5000    0.6667         6
                            GPTNeoForCausalLM     0.1667    0.3333    0.2222         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM        nan    0.0000       nan         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.7500    0.6000    0.6667         5
                LSTMForSequenceClassification        nan    0.0000       nan         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification        nan    0.0000       nan         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration     1.0000    0.6667    0.8000         3
                        LongformerForMaskedLM     0.1000    1.0000    0.1818         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     0.5714    1.0000    0.7273         4
                MBartForConditionalGeneration        nan    0.0000       nan         2
                             MPNetForMaskedLM     0.2000    0.2500    0.2222         4
               MPNetForSequenceClassification        nan    0.0000       nan         6
                                   MPNetModel        nan    0.0000       nan         7
                               MPTForCausalLM        nan    0.0000       nan         6
                  MT5ForConditionalGeneration     0.6000    1.0000    0.7500         6
                                MarianMTModel     0.8000    0.8000    0.8000         5
          Mask2FormerForUniversalSegmentation     1.0000    0.1250    0.2222         8
            MaskFormerForInstanceSegmentation     0.2500    0.2000    0.2222         5
          MobileBertForSequenceClassification     0.0741    0.8000    0.1356         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     0.3333    0.4000    0.3636         5
               PLBartForConditionalGeneration     0.6667    1.0000    0.8000         6
              PegasusForConditionalGeneration     1.0000    0.8571    0.9231         7
             PegasusXForConditionalGeneration        nan    0.0000       nan         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     0.6667    1.0000    0.8000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice        nan    0.0000       nan         4
    RobertaForNonlinearSequenceClassification        nan    0.0000       nan         6
                  RobertaForQuestionAnswering        nan    0.0000       nan         4
             RobertaForSequenceClassification     0.1087    0.8333    0.1923         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.0789    0.6000    0.1395         5
                                 RobertaModel     0.0000    0.0000       nan         6
                              RwkvForCausalLM     1.0000    0.8000    0.8889         5
                                     SamModel        nan    0.0000       nan         2
             SegformerForSemanticSegmentation     0.7500    1.0000    0.8571         3
          Speech2TextForConditionalGeneration     1.0000    0.7500    0.8571         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     0.4000    1.0000    0.5714         6
                               T5EncoderModel        nan    0.0000       nan         4
                                      T5Model     0.0000    0.0000       nan         4
                            T5WithLMHeadModel     0.6250    0.8333    0.7143         6
                              UniSpeechForCTC     1.0000    0.5000    0.6667         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification        nan    0.0000       nan         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC        nan    0.0000       nan        11
                           Wav2Vec2ForCTCnCLS     0.4286    1.0000    0.6000         3
                       Wav2Vec2ForPreTraining     0.0000    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4286    0.5000    0.4615         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.1481    1.0000    0.2581         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    0.1250    0.2222         8
                              XGLMForCausalLM     0.2500    0.7500    0.3750         4
                        XLMRobertaForMaskedLM     0.0000    0.0000       nan         8
               XLMRobertaForQuestionAnswering        nan    0.0000       nan         6
          XLMRobertaForSequenceClassification     0.0000    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6364    1.0000    0.7778         7
                             XLNetLMHeadModel        nan    0.0000       nan         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.2937    0.2937    0.2937       681
                                    macro avg     0.4521    0.2930    0.5700       681
                                 weighted avg     0.4645    0.2937    0.5597       681

2024-08-16 12:18:45.595 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.2937
2024-08-16 12:18:45.611 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:18:45.611 | INFO     | __main__:eval:454 - Validation loss: 10.432234027168967
2024-08-16 12:18:45.618 | INFO     | __main__:train:256 - epochs: 2
2024-08-16 12:18:45.619 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308]
2024-08-16 12:18:45.619 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967]
2024-08-16 12:18:45.619 | INFO     | __main__:train:159 - ====epoch #3====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:07<04:50,  3.50s/it]
Training:   4%|▎         | 3/85 [00:10<04:44,  3.47s/it]
Training:   5%|▍         | 4/85 [00:13<04:39,  3.45s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:24<04:25,  3.40s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:34<04:14,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.39s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.38s/it]
Training:  15%|█▌        | 13/85 [00:44<04:03,  3.38s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.38s/it]
Training:  18%|█▊        | 15/85 [00:51<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:53,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.38s/it]
Training:  21%|██        | 18/85 [01:01<03:46,  3.38s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:11<03:36,  3.38s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:18<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:24<03:24,  3.41s/it]
Training:  31%|███       | 26/85 [01:28<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:31<03:18,  3.43s/it]
Training:  33%|███▎      | 28/85 [01:35<03:15,  3.43s/it]
Training:  34%|███▍      | 29/85 [01:38<03:12,  3.43s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.43s/it]
Training:  36%|███▋      | 31/85 [01:45<03:05,  3.43s/it]
Training:  38%|███▊      | 32/85 [01:49<03:02,  3.44s/it]
Training:  39%|███▉      | 33/85 [01:52<02:58,  3.44s/it]
Training:  40%|████      | 34/85 [01:55<02:55,  3.44s/it]
Training:  41%|████      | 35/85 [01:59<02:51,  3.44s/it]
Training:  42%|████▏     | 36/85 [02:02<02:48,  3.44s/it]
Training:  44%|████▎     | 37/85 [02:06<02:44,  3.44s/it]
Training:  45%|████▍     | 38/85 [02:09<02:41,  3.44s/it]
Training:  46%|████▌     | 39/85 [02:13<02:38,  3.44s/it]
Training:  47%|████▋     | 40/85 [02:16<02:34,  3.44s/it]
Training:  48%|████▊     | 41/85 [02:19<02:31,  3.44s/it]
Training:  49%|████▉     | 42/85 [02:23<02:27,  3.44s/it]
Training:  51%|█████     | 43/85 [02:26<02:24,  3.44s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:20,  3.44s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:17,  3.44s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:14,  3.44s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:10,  3.44s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:07,  3.44s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:03,  3.43s/it]
Training:  59%|█████▉    | 50/85 [02:50<02:00,  3.43s/it]
Training:  60%|██████    | 51/85 [02:54<01:56,  3.43s/it]
Training:  61%|██████    | 52/85 [02:57<01:53,  3.43s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.44s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:46,  3.44s/it]
Training:  65%|██████▍   | 55/85 [03:08<01:43,  3.44s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:39,  3.44s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:36,  3.44s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.44s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:29,  3.44s/it]
Training:  71%|███████   | 60/85 [03:25<01:25,  3.44s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:22,  3.44s/it]
Training:  73%|███████▎  | 62/85 [03:32<01:19,  3.44s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:15,  3.44s/it]
Training:  75%|███████▌  | 64/85 [03:39<01:12,  3.44s/it]
Training:  76%|███████▋  | 65/85 [03:42<01:08,  3.44s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:05,  3.44s/it]
Training:  79%|███████▉  | 67/85 [03:49<01:01,  3.43s/it]
Training:  80%|████████  | 68/85 [03:52<00:58,  3.43s/it]
Training:  81%|████████  | 69/85 [03:56<00:54,  3.43s/it]
Training:  82%|████████▏ | 70/85 [03:59<00:51,  3.44s/it]
Training:  84%|████████▎ | 71/85 [04:03<00:48,  3.44s/it]
Training:  85%|████████▍ | 72/85 [04:06<00:44,  3.43s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:41,  3.44s/it]
Training:  87%|████████▋ | 74/85 [04:13<00:37,  3.43s/it]
Training:  88%|████████▊ | 75/85 [04:16<00:34,  3.43s/it]
Training:  89%|████████▉ | 76/85 [04:20<00:30,  3.43s/it]
Training:  91%|█████████ | 77/85 [04:23<00:27,  3.43s/it]
Training:  92%|█████████▏| 78/85 [04:27<00:24,  3.43s/it]
Training:  93%|█████████▎| 79/85 [04:30<00:20,  3.43s/it]
Training:  94%|█████████▍| 80/85 [04:33<00:17,  3.44s/it]
Training:  95%|█████████▌| 81/85 [04:37<00:13,  3.44s/it]
Training:  96%|█████████▋| 82/85 [04:40<00:10,  3.44s/it]
Training:  98%|█████████▊| 83/85 [04:44<00:06,  3.44s/it]
Training:  99%|█████████▉| 84/85 [04:47<00:03,  3.44s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.44s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.43s/it]
2024-08-16 12:23:36.945 | INFO     | __main__:train:207 - Epoch 3 Average Loss: 8.83241
2024-08-16 12:23:37.641 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL3*****
2024-08-16 12:23:37.641 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:23:37.641 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.19it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.28it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.28it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.28it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.32it/s]
2024-08-16 12:23:54.414 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     0.6250    1.0000    0.7692         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.1739    1.0000    0.2963         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2222    0.6667    0.3333         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.0000    0.0000       nan         4
                   BeitForImageClassification     0.6667    0.3333    0.4444         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.1250    0.2000         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.1429    0.2500    0.1818         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering        nan    0.0000       nan        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM        nan    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     0.1818    1.0000    0.3077         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    0.5000    0.6667         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.0833    0.6667    0.1481         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     0.6667    1.0000    0.8000         2
                           CodeGenForCausalLM     0.3333    1.0000    0.5000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder        nan    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3333    1.0000    0.5000         5
             DebertaForSequenceClassification        nan    0.0000       nan         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM        nan    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     0.8000    1.0000    0.8889         4
              DebertaV2ForTokenClassification     0.3636    0.8000    0.5000         5
                               DebertaV2Model     0.1000    0.5000    0.1667         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3333    0.6000    0.4286         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering     0.0000    0.0000       nan         5
          DistilBertForSequenceClassification     0.2667    0.8000    0.4000         5
             DistilBertForTokenClassification     0.3750    0.5000    0.4286         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder     0.0741    1.0000    0.1379         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.3750    1.0000    0.5455         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification        nan    0.0000       nan         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     0.6667    0.3333    0.4444         6
                            GPTNeoForCausalLM     0.3333    0.3333    0.3333         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    0.5000    0.6667         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.5000    0.6000    0.5455         5
                LSTMForSequenceClassification        nan    0.0000       nan         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.3333    1.0000    0.5000         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration     1.0000    0.6667    0.8000         3
                        LongformerForMaskedLM     0.1000    1.0000    0.1818         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     0.6000    0.7500    0.6667         4
                MBartForConditionalGeneration        nan    0.0000       nan         2
                             MPNetForMaskedLM     0.5000    0.2500    0.3333         4
               MPNetForSequenceClassification     0.1429    0.6667    0.2353         6
                                   MPNetModel     1.0000    0.5714    0.7273         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     0.8000    0.8000    0.8000         5
          Mask2FormerForUniversalSegmentation     0.5385    0.8750    0.6667         8
            MaskFormerForInstanceSegmentation     0.5000    0.2000    0.2857         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     0.8000    0.8000    0.8000         5
               PLBartForConditionalGeneration     0.8571    1.0000    0.9231         6
              PegasusForConditionalGeneration     0.7500    0.8571    0.8000         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     0.6667    1.0000    0.8000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0769    0.1667    0.1053         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.1765    0.6000    0.2727         5
                                 RobertaModel     0.0000    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel        nan    0.0000       nan         2
             SegformerForSemanticSegmentation     0.5000    1.0000    0.6667         3
          Speech2TextForConditionalGeneration     0.6000    0.7500    0.6667         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.3333    0.5000         6
                               T5EncoderModel     0.6000    0.7500    0.6667         4
                                      T5Model     1.0000    0.2500    0.4000         4
                            T5WithLMHeadModel     0.6000    1.0000    0.7500         6
                              UniSpeechForCTC     1.0000    0.5000    0.6667         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification        nan    0.0000       nan         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC        nan    0.0000       nan        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4286    0.5000    0.4615         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.1481    1.0000    0.2581         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     0.8333    0.6250    0.7143         8
                              XGLMForCausalLM     0.6000    0.7500    0.6667         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.4444    0.6667    0.5333         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.1818    0.2857    0.2222         7
               XLNetForSequenceClassification     0.5455    0.8571    0.6667         7
                             XLNetLMHeadModel     0.2500    0.2500    0.2500         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.3671    0.3671    0.3671       681
                                    macro avg     0.5428    0.3733    0.6001       681
                                 weighted avg     0.5583    0.3671    0.5928       681

2024-08-16 12:23:54.415 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.3671
2024-08-16 12:23:54.432 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:23:54.432 | INFO     | __main__:eval:454 - Validation loss: 10.176388263702393
2024-08-16 12:23:54.439 | INFO     | __main__:train:256 - epochs: 3
2024-08-16 12:23:54.439 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321]
2024-08-16 12:23:54.440 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393]
2024-08-16 12:23:54.440 | INFO     | __main__:train:159 - ====epoch #4====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:49,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.46s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.44s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.42s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.42s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:51<03:59,  3.42s/it]
Training:  19%|█▉        | 16/85 [00:54<03:56,  3.42s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.42s/it]
Training:  21%|██        | 18/85 [01:01<03:49,  3.42s/it]
Training:  22%|██▏       | 19/85 [01:05<03:45,  3.42s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.42s/it]
Training:  25%|██▍       | 21/85 [01:11<03:39,  3.42s/it]
Training:  26%|██▌       | 22/85 [01:15<03:35,  3.42s/it]
Training:  27%|██▋       | 23/85 [01:18<03:32,  3.42s/it]
Training:  28%|██▊       | 24/85 [01:22<03:28,  3.42s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:29<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:35<03:15,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.42s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.42s/it]
Training:  36%|███▋      | 31/85 [01:46<03:04,  3.42s/it]
Training:  38%|███▊      | 32/85 [01:49<03:04,  3.48s/it]
Training:  39%|███▉      | 33/85 [01:53<03:00,  3.46s/it]
Training:  40%|████      | 34/85 [01:56<02:56,  3.45s/it]
Training:  41%|████      | 35/85 [02:00<02:52,  3.44s/it]
Training:  42%|████▏     | 36/85 [02:03<02:48,  3.44s/it]
Training:  44%|████▎     | 37/85 [02:06<02:44,  3.43s/it]
Training:  45%|████▍     | 38/85 [02:10<02:41,  3.43s/it]
Training:  46%|████▌     | 39/85 [02:13<02:37,  3.43s/it]
Training:  47%|████▋     | 40/85 [02:17<02:34,  3.42s/it]
Training:  48%|████▊     | 41/85 [02:20<02:30,  3.42s/it]
Training:  49%|████▉     | 42/85 [02:24<02:27,  3.43s/it]
Training:  51%|█████     | 43/85 [02:27<02:23,  3.43s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:20,  3.43s/it]
Training:  53%|█████▎    | 45/85 [02:34<02:16,  3.42s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:13,  3.42s/it]
Training:  55%|█████▌    | 47/85 [02:41<02:10,  3.42s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:06,  3.42s/it]
Training:  58%|█████▊    | 49/85 [02:48<02:03,  3.42s/it]
Training:  59%|█████▉    | 50/85 [02:51<01:59,  3.42s/it]
Training:  60%|██████    | 51/85 [02:54<01:56,  3.42s/it]
Training:  61%|██████    | 52/85 [02:58<01:52,  3.42s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.42s/it]
Training:  64%|██████▎   | 54/85 [03:05<01:46,  3.42s/it]
Training:  65%|██████▍   | 55/85 [03:08<01:42,  3.42s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:39,  3.42s/it]
Training:  67%|██████▋   | 57/85 [03:15<01:35,  3.42s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.42s/it]
Training:  69%|██████▉   | 59/85 [03:22<01:29,  3.42s/it]
Training:  71%|███████   | 60/85 [03:25<01:25,  3.43s/it]
Training:  72%|███████▏  | 61/85 [03:29<01:22,  3.43s/it]
Training:  73%|███████▎  | 62/85 [03:32<01:18,  3.43s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:15,  3.43s/it]
Training:  75%|███████▌  | 64/85 [03:39<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:42<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:46<01:05,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:49<01:01,  3.42s/it]
Training:  80%|████████  | 68/85 [03:53<00:58,  3.43s/it]
Training:  81%|████████  | 69/85 [03:56<00:54,  3.42s/it]
Training:  82%|████████▏ | 70/85 [03:59<00:51,  3.42s/it]
Training:  84%|████████▎ | 71/85 [04:03<00:47,  3.42s/it]
Training:  85%|████████▍ | 72/85 [04:06<00:44,  3.43s/it]
Training:  86%|████████▌ | 73/85 [04:10<00:41,  3.43s/it]
Training:  87%|████████▋ | 74/85 [04:13<00:37,  3.42s/it]
Training:  88%|████████▊ | 75/85 [04:17<00:34,  3.43s/it]
Training:  89%|████████▉ | 76/85 [04:20<00:30,  3.43s/it]
Training:  91%|█████████ | 77/85 [04:23<00:27,  3.43s/it]
Training:  92%|█████████▏| 78/85 [04:27<00:24,  3.43s/it]
Training:  93%|█████████▎| 79/85 [04:30<00:20,  3.43s/it]
Training:  94%|█████████▍| 80/85 [04:34<00:17,  3.43s/it]
Training:  95%|█████████▌| 81/85 [04:37<00:13,  3.42s/it]
Training:  96%|█████████▋| 82/85 [04:41<00:10,  3.42s/it]
Training:  98%|█████████▊| 83/85 [04:44<00:06,  3.43s/it]
Training:  99%|█████████▉| 84/85 [04:47<00:03,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.43s/it]
2024-08-16 12:28:45.782 | INFO     | __main__:train:207 - Epoch 4 Average Loss: 8.65767
2024-08-16 12:28:46.496 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL4*****
2024-08-16 12:28:46.497 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:28:46.497 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.19it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:29:03.755 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.2632    0.8333    0.4000         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.4000    0.5000    0.4444         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration     0.1250    0.3333    0.1818         3
                     BartForQuestionAnswering     0.1250    0.3333    0.1818         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     0.5714    0.6667    0.6154         6
                                    BertForCL        nan    0.0000       nan         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1569    1.0000    0.2712         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification        nan    0.0000       nan         3
                   BertForV2QuestionAnswering     0.8000    0.8000    0.8000        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering     0.0000    0.0000       nan         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.5000    1.0000    0.6667         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.1111    0.5000    0.1818         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3333    1.0000    0.5000         5
             DebertaForSequenceClassification        nan    0.0000       nan         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.2273    1.0000    0.3704         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2667    0.8000    0.4000         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering     0.1667    0.4000    0.2353         5
          DistilBertForSequenceClassification        nan    0.0000       nan         5
             DistilBertForTokenClassification     0.0000    0.0000       nan         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.0000    0.0000       nan         3
                    EsmForTokenClassification     0.3333    0.6667    0.4444         3
                FNetForSequenceClassification        nan    0.0000       nan         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     0.7500    0.5000    0.6000         6
                            GPTNeoForCausalLM     0.3333    0.3333    0.3333         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM        nan    0.0000       nan         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification        nan    0.0000       nan         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification        nan    0.0000       nan         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.3333    1.0000    0.5000         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.2857    0.6667    0.4000         3
             LongformerForTokenClassification     0.5000    0.8000    0.6154         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.5556    0.8333    0.6667         6
                                   MPNetModel     1.0000    0.5714    0.7273         7
                               MPTForCausalLM     0.8571    1.0000    0.9231         6
                  MT5ForConditionalGeneration     0.8571    1.0000    0.9231         6
                                MarianMTModel     0.8000    0.8000    0.8000         5
          Mask2FormerForUniversalSegmentation     0.8000    0.5000    0.6154         8
            MaskFormerForInstanceSegmentation     0.5000    0.4000    0.4444         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     0.5714    0.8000    0.6667         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     0.5000    1.0000    0.6667         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     0.6667    1.0000    0.8000         4
                                 RobertaForCL     0.0000    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice        nan    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1429    0.1667    0.1538         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.0694    1.0000    0.1299         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel        nan    0.0000       nan         2
             SegformerForSemanticSegmentation     0.7500    1.0000    0.8571         3
          Speech2TextForConditionalGeneration     0.7500    0.7500    0.7500         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     0.7500    1.0000    0.8571         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.2500    0.2500    0.2500         4
                            T5WithLMHeadModel     0.6667    0.6667    0.6667         6
                              UniSpeechForCTC        nan    0.0000       nan         4
                           UniSpeechSatForCTC     0.1429    0.5000    0.2222         2
                    ViTForImageClassification     1.0000    0.6667    0.8000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.8889    0.7273    0.8000        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4286    0.5000    0.4615         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    0.8750    0.9333         8
                              XGLMForCausalLM     0.5000    1.0000    0.6667         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.0000    0.0000       nan         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.3906    0.3906    0.3906       681
                                    macro avg     0.5453    0.3751    0.6691       681
                                 weighted avg     0.5816    0.3906    0.6761       681

2024-08-16 12:29:03.755 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.3906
2024-08-16 12:29:03.774 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:29:03.775 | INFO     | __main__:eval:454 - Validation loss: 10.353548396717418
2024-08-16 12:29:03.781 | INFO     | __main__:train:256 - epochs: 4
2024-08-16 12:29:03.781 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948]
2024-08-16 12:29:03.781 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418]
2024-08-16 12:29:03.782 | INFO     | __main__:train:159 - ====epoch #5====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.56s/it]
Training:   2%|▏         | 2/85 [00:07<04:50,  3.50s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.46s/it]
Training:   5%|▍         | 4/85 [00:13<04:39,  3.45s/it]
Training:   6%|▌         | 5/85 [00:17<04:35,  3.44s/it]
Training:   7%|▋         | 6/85 [00:20<04:31,  3.44s/it]
Training:   8%|▊         | 7/85 [00:24<04:27,  3.43s/it]
Training:   9%|▉         | 8/85 [00:27<04:24,  3.43s/it]
Training:  11%|█         | 9/85 [00:30<04:20,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:13,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:10,  3.43s/it]
Training:  15%|█▌        | 13/85 [00:44<04:07,  3.43s/it]
Training:  16%|█▋        | 14/85 [00:48<04:03,  3.43s/it]
Training:  18%|█▊        | 15/85 [00:51<03:59,  3.43s/it]
Training:  19%|█▉        | 16/85 [00:54<03:56,  3.43s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.42s/it]
Training:  21%|██        | 18/85 [01:01<03:49,  3.42s/it]
Training:  22%|██▏       | 19/85 [01:05<03:46,  3.42s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.42s/it]
Training:  25%|██▍       | 21/85 [01:12<03:39,  3.42s/it]
Training:  26%|██▌       | 22/85 [01:15<03:35,  3.42s/it]
Training:  27%|██▋       | 23/85 [01:18<03:32,  3.42s/it]
Training:  28%|██▊       | 24/85 [01:22<03:28,  3.42s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:29<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:36<03:15,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.42s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.42s/it]
Training:  36%|███▋      | 31/85 [01:46<03:04,  3.42s/it]
Training:  38%|███▊      | 32/85 [01:49<03:01,  3.42s/it]
Training:  39%|███▉      | 33/85 [01:53<02:57,  3.42s/it]
Training:  40%|████      | 34/85 [01:56<02:54,  3.42s/it]
Training:  41%|████      | 35/85 [01:59<02:51,  3.42s/it]
Training:  42%|████▏     | 36/85 [02:03<02:47,  3.42s/it]
Training:  44%|████▎     | 37/85 [02:06<02:44,  3.42s/it]
Training:  45%|████▍     | 38/85 [02:10<02:40,  3.42s/it]
Training:  46%|████▌     | 39/85 [02:13<02:37,  3.42s/it]
Training:  47%|████▋     | 40/85 [02:17<02:33,  3.42s/it]
Training:  48%|████▊     | 41/85 [02:20<02:30,  3.42s/it]
Training:  49%|████▉     | 42/85 [02:23<02:27,  3.42s/it]
Training:  51%|█████     | 43/85 [02:27<02:23,  3.42s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:20,  3.42s/it]
Training:  53%|█████▎    | 45/85 [02:34<02:16,  3.42s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:13,  3.42s/it]
Training:  55%|█████▌    | 47/85 [02:41<02:10,  3.42s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:06,  3.42s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:03,  3.42s/it]
Training:  59%|█████▉    | 50/85 [02:51<01:59,  3.42s/it]
Training:  60%|██████    | 51/85 [02:54<01:56,  3.42s/it]
Training:  61%|██████    | 52/85 [02:58<01:52,  3.42s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.42s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:46,  3.42s/it]
Training:  65%|██████▍   | 55/85 [03:08<01:42,  3.42s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:39,  3.42s/it]
Training:  67%|██████▋   | 57/85 [03:15<01:35,  3.42s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.42s/it]
Training:  69%|██████▉   | 59/85 [03:22<01:28,  3.42s/it]
Training:  71%|███████   | 60/85 [03:25<01:25,  3.42s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:22,  3.42s/it]
Training:  73%|███████▎  | 62/85 [03:32<01:18,  3.42s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:15,  3.42s/it]
Training:  75%|███████▌  | 64/85 [03:39<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:42<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:46<01:04,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:49<01:01,  3.42s/it]
Training:  80%|████████  | 68/85 [03:52<00:58,  3.42s/it]
Training:  81%|████████  | 69/85 [03:56<00:54,  3.42s/it]
Training:  82%|████████▏ | 70/85 [03:59<00:51,  3.42s/it]
Training:  84%|████████▎ | 71/85 [04:03<00:47,  3.42s/it]
Training:  85%|████████▍ | 72/85 [04:06<00:44,  3.42s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:41,  3.42s/it]
Training:  87%|████████▋ | 74/85 [04:13<00:37,  3.42s/it]
Training:  88%|████████▊ | 75/85 [04:16<00:34,  3.42s/it]
Training:  89%|████████▉ | 76/85 [04:20<00:30,  3.42s/it]
Training:  91%|█████████ | 77/85 [04:23<00:27,  3.42s/it]
Training:  92%|█████████▏| 78/85 [04:27<00:23,  3.42s/it]
Training:  93%|█████████▎| 79/85 [04:30<00:20,  3.42s/it]
Training:  94%|█████████▍| 80/85 [04:33<00:17,  3.42s/it]
Training:  95%|█████████▌| 81/85 [04:37<00:13,  3.42s/it]
Training:  96%|█████████▋| 82/85 [04:40<00:10,  3.42s/it]
Training:  98%|█████████▊| 83/85 [04:44<00:06,  3.42s/it]
Training:  99%|█████████▉| 84/85 [04:47<00:03,  3.42s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.42s/it]
2024-08-16 12:33:54.802 | INFO     | __main__:train:207 - Epoch 5 Average Loss: 8.55311
2024-08-16 12:33:55.505 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL5*****
2024-08-16 12:33:55.505 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:33:55.505 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.19it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:34:12.710 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.0000    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.1579    0.7500    0.2609         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.1875    1.0000    0.3158         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     0.8000    0.6667    0.7273         6
                                    BertForCL     0.1207    1.0000    0.2154         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.4762    1.0000    0.6452        10
                              BertLMHeadModel     0.0000    0.0000       nan         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM        nan    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     0.6667    1.0000    0.8000         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.0667    0.2500    0.1053         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.2500    0.2500    0.2500         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.7500    0.4286    0.5455         7
                           DPRQuestionEncoder     0.4000    0.5000    0.4444         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     0.8000    1.0000    0.8889         4
              DebertaV2ForTokenClassification     0.1538    0.4000    0.2222         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.1667    0.2000    0.1818         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2105    0.8000    0.3333         5
             DistilBertForTokenClassification     0.3333    0.6667    0.4444         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.3750    1.0000    0.5455         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification        nan    0.0000       nan         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     0.6667    0.3333    0.4444         6
                            GPTNeoForCausalLM     0.4286    1.0000    0.6000         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    0.5000    0.6667         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.0000    0.0000       nan         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.3333    1.0000    0.5000         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.3333    0.3333    0.3333         3
             LongformerForTokenClassification     0.3125    1.0000    0.4762         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.5000    0.2500    0.3333         4
               MPNetForSequenceClassification     0.5556    0.8333    0.6667         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    0.8000    0.8889         5
          Mask2FormerForUniversalSegmentation     1.0000    0.3750    0.5455         8
            MaskFormerForInstanceSegmentation     0.5000    0.8000    0.6154         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.6000    0.7500         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.6667    0.8571    0.7500         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    0.6667    0.8000         3
                 ResNetForImageClassification     0.6667    1.0000    0.8000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1111    0.1667    0.1333         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.1154    0.5000    0.1875         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.2727    0.6000    0.3750         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    0.5000    0.6667         2
             SegformerForSemanticSegmentation     0.7500    1.0000    0.8571         3
          Speech2TextForConditionalGeneration     0.6667    1.0000    0.8000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     0.7500    1.0000    0.8571         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.5000    0.2500    0.3333         4
                            T5WithLMHeadModel     0.5556    0.8333    0.6667         6
                              UniSpeechForCTC     0.3333    0.2500    0.2857         4
                           UniSpeechSatForCTC     0.0000    0.0000       nan         2
                    ViTForImageClassification     1.0000    0.6667    0.8000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.8889    0.7273    0.8000        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.2400    1.0000    0.3871         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC        nan    0.0000       nan         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering        nan    0.0000       nan         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.1111    0.2857    0.1600         7
               XLNetForSequenceClassification        nan    0.0000       nan         7
                             XLNetLMHeadModel     0.3636    1.0000    0.5333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4038    0.4038    0.4038       681
                                    macro avg     0.5504    0.3914    0.6627       681
                                 weighted avg     0.5603    0.4038    0.6444       681

2024-08-16 12:34:12.710 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4038
2024-08-16 12:34:12.719 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:34:12.719 | INFO     | __main__:eval:454 - Validation loss: 10.357522184198553
2024-08-16 12:34:12.726 | INFO     | __main__:train:256 - epochs: 5
2024-08-16 12:34:12.726 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524]
2024-08-16 12:34:12.726 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553]
2024-08-16 12:34:12.726 | INFO     | __main__:train:159 - ====epoch #6====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:49,  3.49s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.43s/it]
Training:   8%|▊         | 7/85 [00:24<04:27,  3.43s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.43s/it]
Training:  11%|█         | 9/85 [00:30<04:20,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:13,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.42s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:51<03:59,  3.42s/it]
Training:  19%|█▉        | 16/85 [00:54<03:56,  3.42s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.42s/it]
Training:  21%|██        | 18/85 [01:01<03:49,  3.42s/it]
Training:  22%|██▏       | 19/85 [01:05<03:45,  3.42s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.42s/it]
Training:  25%|██▍       | 21/85 [01:11<03:39,  3.42s/it]
Training:  26%|██▌       | 22/85 [01:15<03:35,  3.42s/it]
Training:  27%|██▋       | 23/85 [01:18<03:32,  3.42s/it]
Training:  28%|██▊       | 24/85 [01:22<03:28,  3.42s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:29<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.42s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.42s/it]
Training:  36%|███▋      | 31/85 [01:46<03:04,  3.42s/it]
Training:  38%|███▊      | 32/85 [01:49<03:01,  3.42s/it]
Training:  39%|███▉      | 33/85 [01:53<02:57,  3.42s/it]
Training:  40%|████      | 34/85 [01:56<02:54,  3.42s/it]
Training:  41%|████      | 35/85 [01:59<02:51,  3.42s/it]
Training:  42%|████▏     | 36/85 [02:03<02:47,  3.42s/it]
Training:  44%|████▎     | 37/85 [02:06<02:44,  3.42s/it]
Training:  45%|████▍     | 38/85 [02:10<02:40,  3.42s/it]
Training:  46%|████▌     | 39/85 [02:13<02:37,  3.43s/it]
Training:  47%|████▋     | 40/85 [02:17<02:34,  3.43s/it]
Training:  48%|████▊     | 41/85 [02:20<02:30,  3.42s/it]
Training:  49%|████▉     | 42/85 [02:23<02:27,  3.42s/it]
Training:  51%|█████     | 43/85 [02:27<02:23,  3.43s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:20,  3.42s/it]
Training:  53%|█████▎    | 45/85 [02:34<02:17,  3.43s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:13,  3.42s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:10,  3.42s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:06,  3.42s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:03,  3.42s/it]
Training:  59%|█████▉    | 50/85 [02:51<01:59,  3.42s/it]
Training:  60%|██████    | 51/85 [02:54<01:56,  3.42s/it]
Training:  61%|██████    | 52/85 [02:58<01:52,  3.42s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.42s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:46,  3.42s/it]
Training:  65%|██████▍   | 55/85 [03:08<01:42,  3.42s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:39,  3.42s/it]
Training:  67%|██████▋   | 57/85 [03:15<01:35,  3.42s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.42s/it]
Training:  69%|██████▉   | 59/85 [03:22<01:29,  3.42s/it]
Training:  71%|███████   | 60/85 [03:25<01:25,  3.42s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:22,  3.42s/it]
Training:  73%|███████▎  | 62/85 [03:32<01:18,  3.42s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:15,  3.42s/it]
Training:  75%|███████▌  | 64/85 [03:39<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:42<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:46<01:05,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:49<01:01,  3.42s/it]
Training:  80%|████████  | 68/85 [03:52<00:58,  3.42s/it]
Training:  81%|████████  | 69/85 [03:56<00:54,  3.42s/it]
Training:  82%|████████▏ | 70/85 [03:59<00:51,  3.42s/it]
Training:  84%|████████▎ | 71/85 [04:03<00:47,  3.42s/it]
Training:  85%|████████▍ | 72/85 [04:06<00:44,  3.42s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:41,  3.42s/it]
Training:  87%|████████▋ | 74/85 [04:13<00:37,  3.42s/it]
Training:  88%|████████▊ | 75/85 [04:16<00:34,  3.42s/it]
Training:  89%|████████▉ | 76/85 [04:20<00:30,  3.42s/it]
Training:  91%|█████████ | 77/85 [04:23<00:27,  3.42s/it]
Training:  92%|█████████▏| 78/85 [04:27<00:23,  3.42s/it]
Training:  93%|█████████▎| 79/85 [04:30<00:20,  3.42s/it]
Training:  94%|█████████▍| 80/85 [04:33<00:17,  3.42s/it]
Training:  95%|█████████▌| 81/85 [04:37<00:13,  3.42s/it]
Training:  96%|█████████▋| 82/85 [04:40<00:10,  3.42s/it]
Training:  98%|█████████▊| 83/85 [04:44<00:06,  3.42s/it]
Training:  99%|█████████▉| 84/85 [04:47<00:03,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:51<00:00,  3.42s/it]
2024-08-16 12:39:03.807 | INFO     | __main__:train:207 - Epoch 6 Average Loss: 8.32903
2024-08-16 12:39:04.506 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL6*****
2024-08-16 12:39:04.506 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:39:04.506 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:39:21.685 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.3000    1.0000    0.4615         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.5000    0.2500    0.3333         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.1818    0.6667    0.2857         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.2000    0.2500    0.2222         4
                   BeitForImageClassification     0.8000    0.6667    0.7273         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5556    1.0000    0.7143        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM     0.1190    0.6250    0.2000         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.6667    0.5000    0.5714         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.8000    0.5714    0.6667         7
                           DPRQuestionEncoder     0.5000    0.5000    0.5000         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering        nan    0.0000       nan         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.2727    1.0000    0.4286         3
                         DebertaV2ForMaskedLM        nan    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     0.8000    1.0000    0.8889         4
              DebertaV2ForTokenClassification     0.2381    1.0000    0.3846         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.0000    0.0000       nan         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering     0.0000    0.0000       nan         5
          DistilBertForSequenceClassification     0.2353    0.8000    0.3636         5
             DistilBertForTokenClassification     0.4286    0.5000    0.4615         6
                              DistilBertModel     0.2500    0.2500    0.2500         8
                                   DprEncoder     0.0769    1.0000    0.1429         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining        nan    0.0000       nan         2
                  ElectraForQuestionAnswering     0.0000    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.2500    0.2500    0.2500         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.0000    0.0000       nan         3
                    EsmForTokenClassification     0.5000    1.0000    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM     0.0000    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.4286    1.0000    0.6000         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    0.5000    0.6667         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.5000    1.0000    0.6667         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.3333    1.0000    0.5000         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1176    1.0000    0.2105         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.0000    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.4000    0.5000    0.4444         4
               MPNetForSequenceClassification     0.5714    0.6667    0.6154         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.6000    0.7500    0.6667         8
            MaskFormerForInstanceSegmentation     0.5000    0.6000    0.5455         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.4000    0.5714         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     0.6667    1.0000    0.8000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification        nan    0.0000       nan         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.1143    0.6667    0.1951         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.3125    1.0000    0.4762         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    0.5000    0.6667         2
             SegformerForSemanticSegmentation     0.7500    1.0000    0.8571         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.3333    0.5000         6
                               T5EncoderModel     0.7500    0.7500    0.7500         4
                                      T5Model        nan    0.0000       nan         4
                            T5WithLMHeadModel     0.5556    0.8333    0.6667         6
                              UniSpeechForCTC        nan    0.0000       nan         4
                           UniSpeechSatForCTC     0.1250    0.5000    0.2000         2
                    ViTForImageClassification     1.0000    0.6667    0.8000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.8889    0.7273    0.8000        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     0.8000    1.0000    0.8889         8
                              XGLMForCausalLM     0.8000    1.0000    0.8889         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.6000    0.5000    0.5455         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.1538    0.2857    0.2000         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4332    0.4332    0.4332       681
                                    macro avg     0.5641    0.4309    0.6736       681
                                 weighted avg     0.5841    0.4332    0.6570       681

2024-08-16 12:39:21.686 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4332
2024-08-16 12:39:21.692 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:39:21.692 | INFO     | __main__:eval:454 - Validation loss: 10.042855046012185
2024-08-16 12:39:21.698 | INFO     | __main__:train:256 - epochs: 6
2024-08-16 12:39:21.698 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357]
2024-08-16 12:39:21.698 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185]
2024-08-16 12:39:21.698 | INFO     | __main__:train:159 - ====epoch #7====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.54s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.44s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:33,  3.45s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:29,  3.44s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.43s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:22,  3.42s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.41s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.41s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 12:44:11.262 | INFO     | __main__:train:207 - Epoch 7 Average Loss: 8.20112
2024-08-16 12:44:11.973 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL7*****
2024-08-16 12:44:11.973 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:44:11.973 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.26it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:44:29.162 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.3750    0.5455         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification     0.6250    0.7143    0.6667         7
                 AlbertForTokenClassification     0.1818    1.0000    0.3077         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration     0.2000    0.3333    0.2500         3
                     BartForQuestionAnswering     0.0000    0.0000       nan         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.2000    0.2500    0.2222         4
                   BeitForImageClassification     0.8000    0.6667    0.7273         6
                                    BertForCL     0.2308    0.4286    0.3000         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1951    1.0000    0.3265         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.3333    0.2500    0.2857         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5556    1.0000    0.7143        10
                              BertLMHeadModel     1.0000    0.3333    0.5000         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1250    0.1250    0.1250         8
              CamembertForTokenClassification     0.0312    0.3333    0.0571         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.2105    0.8000    0.3333         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3125    1.0000    0.4762         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.1429    0.1667    0.1538         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining        nan    0.0000       nan         2
                  ElectraForQuestionAnswering     0.4545    0.7143    0.5556         7
             ElectraForSequenceClassification     0.0000    0.0000       nan         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification        nan    0.0000       nan         3
                    EsmForTokenClassification     0.3750    1.0000    0.5455         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel        nan    0.0000       nan         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    1.0000    0.6667         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     1.0000    1.0000    1.0000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.3333    1.0000    0.5000         1
               LlamaForSequenceClassification        nan    0.0000       nan         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM        nan    0.0000       nan         2
               LongformerForQuestionAnswering     0.2727    0.6000    0.3750         5
          LongformerForSequenceClassification     0.2222    0.6667    0.3333         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.3636    1.0000    0.5333         4
               MPNetForSequenceClassification     1.0000    0.1667    0.2857         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.6364    0.8750    0.7368         8
            MaskFormerForInstanceSegmentation     0.7143    1.0000    0.8333         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.4000    0.5714         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0769    0.1667    0.1053         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.2941    1.0000    0.4545         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    0.5000    0.6667         2
             SegformerForSemanticSegmentation     0.7500    1.0000    0.8571         3
          Speech2TextForConditionalGeneration     0.8000    1.0000    0.8889         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.3333    0.5000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.6667    0.5000    0.5714         4
                            T5WithLMHeadModel     0.6250    0.8333    0.7143         6
                              UniSpeechForCTC     1.0000    0.5000    0.6667         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    0.6667    0.8000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.8889    0.7273    0.8000        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining     0.1429    0.3333    0.2000         3
            Wav2Vec2ForSequenceClassification        nan    0.0000       nan         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     0.6667    1.0000    0.8000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.6000    0.5000    0.5455         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification     0.2727    0.6000    0.3750         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification        nan    0.0000       nan         7
                             XLNetLMHeadModel     0.3636    1.0000    0.5333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4449    0.4449    0.4449       681
                                    macro avg     0.6020    0.4477    0.6782       681
                                 weighted avg     0.6139    0.4449    0.6582       681

2024-08-16 12:44:29.162 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4449
2024-08-16 12:44:29.175 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:44:29.176 | INFO     | __main__:eval:454 - Validation loss: 9.825158032503994
2024-08-16 12:44:29.182 | INFO     | __main__:train:256 - epochs: 7
2024-08-16 12:44:29.182 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935]
2024-08-16 12:44:29.182 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994]
2024-08-16 12:44:29.182 | INFO     | __main__:train:159 - ====epoch #8====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:26,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:23,  3.41s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 12:49:18.695 | INFO     | __main__:train:207 - Epoch 8 Average Loss: 8.07427
2024-08-16 12:49:19.388 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL8*****
2024-08-16 12:49:19.388 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:49:19.389 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.05it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.24it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:49:36.647 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.1818    1.0000    0.3077         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.1875    1.0000    0.3158         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.0000    0.0000       nan         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.0000    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering        nan    0.0000       nan        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.0625    1.0000    0.1176         1
                  BigBirdForQuestionAnswering     0.1667    0.1429    0.1538         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    0.5000    0.6667         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.2857    0.4000         7
                           DPRQuestionEncoder     0.3333    0.5000    0.4000         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model     0.0833    0.5000    0.1429         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.5000    0.2000    0.2857         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.6667    0.4444         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.0000    0.0000       nan         6
                              DistilBertModel     0.3571    0.6250    0.4545         8
                                   DprEncoder     0.0851    1.0000    0.1569         4
                           ElectraForMaskedLM     0.1667    0.2500    0.2000         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.2800    0.8750    0.4242         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.3333    0.3333         3
                    EsmForTokenClassification     0.2500    0.3333    0.2857         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation        nan    0.0000       nan         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM     0.0000    0.0000       nan         1
                              GPTJForCausalLM     0.8333    0.8333    0.8333         6
                            GPTNeoForCausalLM     0.7500    1.0000    0.8571         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    0.5000    0.6667         2
                  LEDForConditionalGeneration     1.0000    0.6000    0.7500         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0800    1.0000    0.1481         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel        nan    0.0000       nan         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.0000    0.0000       nan         4
               MPNetForSequenceClassification     0.5000    0.8333    0.6250         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     0.8333    1.0000    0.9091         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     1.0000    0.8571    0.9231         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM     1.0000    0.3333    0.5000         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0000    0.0000       nan         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.1154    0.5000    0.1875         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.3125    1.0000    0.4762         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     0.7500    1.0000    0.8571         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.3750    0.7500    0.5000         4
                            T5WithLMHeadModel     0.6000    0.5000    0.5455         6
                              UniSpeechForCTC        nan    0.0000       nan         4
                           UniSpeechSatForCTC     0.1250    0.5000    0.2000         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.8889    0.7273    0.8000        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4286    0.5000    0.4615         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.6000    0.5000    0.5455         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.1538    0.2857    0.2000         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4302    0.4302    0.4302       681
                                    macro avg     0.5817    0.4588    0.6931       681
                                 weighted avg     0.5880    0.4302    0.6937       681

2024-08-16 12:49:36.647 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4302
2024-08-16 12:49:36.656 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:49:36.656 | INFO     | __main__:eval:454 - Validation loss: 9.730173501101406
2024-08-16 12:49:36.661 | INFO     | __main__:train:256 - epochs: 8
2024-08-16 12:49:36.661 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446]
2024-08-16 12:49:36.661 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406]
2024-08-16 12:49:36.661 | INFO     | __main__:train:159 - ====epoch #9====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:55,  3.52s/it]
Training:   2%|▏         | 2/85 [00:06<04:46,  3.45s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.41s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.41s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.41s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:23,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 12:54:25.982 | INFO     | __main__:train:207 - Epoch 9 Average Loss: 8.13707
2024-08-16 12:54:26.679 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL9*****
2024-08-16 12:54:26.679 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:54:26.679 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.27it/s]
2024-08-16 12:54:44.015 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.3000    1.0000    0.4615         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     1.0000    0.2500    0.4000         4
                                  AlbertModel     1.0000    0.1250    0.2222         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2500    1.0000    0.4000         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL        nan    0.0000       nan         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.3333    0.1250    0.1818         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0536    0.7500    0.1000         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5882    1.0000    0.7407        10
                              BertLMHeadModel     1.0000    0.3333    0.5000         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     0.5000    0.2500    0.3333         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel        nan    0.0000       nan         1
                         CamembertForMaskedLM     0.1667    0.1250    0.1429         8
           CamembertForSequenceClassification     0.1364    0.7500    0.2308         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.8571    0.7500         7
                           DPRQuestionEncoder        nan    0.0000       nan         4
                           DebertaForMaskedLM     0.2500    0.5000    0.3333         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification        nan    0.0000       nan         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.2273    1.0000    0.3704         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3125    1.0000    0.4762         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2857    0.8000    0.4211         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM        nan    0.0000       nan         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering     0.3571    0.7143    0.4762         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel        nan    0.0000       nan         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.1667    0.3333    0.2222         3
                    EsmForTokenClassification     0.0000    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM     0.0000    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.7143    1.0000    0.8333         5
                LSTMForSequenceClassification     1.0000    1.0000    1.0000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1333    1.0000    0.2353         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.5000    0.6667    0.5714         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.1250    0.2222         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.0000    0.0000       nan         4
               MPNetForSequenceClassification     0.4444    0.6667    0.5333         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.8000    0.8889         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.7500    0.8571    0.8000         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.0833    0.2000    0.1176         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0769    0.1667    0.1053         6
                  RobertaForQuestionAnswering        nan    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification     0.0625    0.1667    0.0909         6
                RobertaForV2QuestionAnswering     0.3846    1.0000    0.5556         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.5000    0.2500    0.3333         4
                            T5WithLMHeadModel     0.5000    0.6667    0.5714         6
                              UniSpeechForCTC        nan    0.0000       nan         4
                           UniSpeechSatForCTC     0.1250    0.5000    0.2000         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.8889    0.7273    0.8000        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    0.7500    0.8571         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.6000    0.5000    0.5455         6
          XLMRobertaForSequenceClassification     0.0000    0.0000       nan         4
             XLMRobertaForTokenClassification     0.2500    0.6000    0.3529         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4655    0.4655    0.4655       681
                                    macro avg     0.6195    0.4772    0.6895       681
                                 weighted avg     0.6382    0.4655    0.6591       681

2024-08-16 12:54:44.015 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4655
2024-08-16 12:54:44.029 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:54:44.029 | INFO     | __main__:eval:454 - Validation loss: 9.70071250742132
2024-08-16 12:54:44.035 | INFO     | __main__:train:256 - epochs: 9
2024-08-16 12:54:44.036 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233]
2024-08-16 12:54:44.036 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132]
2024-08-16 12:54:44.036 | INFO     | __main__:train:159 - ====epoch #10====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:49,  3.49s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.46s/it]
Training:   5%|▍         | 4/85 [00:13<04:39,  3.45s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.43s/it]
Training:   8%|▊         | 7/85 [00:24<04:27,  3.43s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.43s/it]
Training:  11%|█         | 9/85 [00:30<04:20,  3.43s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.43s/it]
Training:  13%|█▎        | 11/85 [00:37<04:13,  3.43s/it]
Training:  14%|█▍        | 12/85 [00:41<04:10,  3.43s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:51<03:59,  3.42s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.42s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.42s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.41s/it]
Training:  22%|██▏       | 19/85 [01:05<03:45,  3.41s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.41s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:22<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:39<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:56<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:02,  3.39s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:31,  3.45s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.44s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.42s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.42s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.41s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.41s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.41s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.41s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.41s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 12:59:33.829 | INFO     | __main__:train:207 - Epoch 10 Average Loss: 8.12830
2024-08-16 12:59:34.537 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL10*****
2024-08-16 12:59:34.537 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:59:34.537 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.26it/s]
2024-08-16 12:59:52.114 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.1818    1.0000    0.3077         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.0000    0.0000       nan         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.3000    0.7500    0.4286         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.2857    0.2857    0.2857         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.3333    0.2500    0.2857         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5556    1.0000    0.7143        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering     0.5000    0.1429    0.2222         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model     0.0769    0.5000    0.1333         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.5000    0.2000    0.2857         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.6667    0.4444         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.0000    0.0000       nan         6
                              DistilBertModel     0.3571    0.6250    0.4545         8
                                   DprEncoder     0.0833    1.0000    0.1538         4
                           ElectraForMaskedLM     0.1667    0.2500    0.2000         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.3125    0.6250    0.4167         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.6667    0.4444         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM     0.0000    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    0.6667    0.5714         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM        nan    0.0000       nan         2
               LongformerForQuestionAnswering     0.0000    0.0000       nan         5
          LongformerForSequenceClassification     0.1667    1.0000    0.2857         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.1250    0.2222         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.3333    0.2500    0.2857         4
               MPNetForSequenceClassification     0.5000    0.6667    0.5714         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.5000    0.2000    0.2857         5
                           RobertaForCausalLM     0.2500    0.3333    0.2857         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1429    0.5000    0.2222         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4167    1.0000    0.5882         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.2500    0.7500    0.3750         4
                            T5WithLMHeadModel     0.0000    0.0000       nan         6
                              UniSpeechForCTC     0.6000    0.7500    0.6667         4
                           UniSpeechSatForCTC     0.0000    0.0000       nan         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     0.6000    1.0000    0.7500         3
                       Wav2Vec2ForPreTraining     0.1176    0.6667    0.2000         3
            Wav2Vec2ForSequenceClassification     0.2857    0.3333    0.3077         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC        nan    0.0000       nan         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    0.8750    0.9333         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.6000    0.5000    0.5455         6
          XLMRobertaForSequenceClassification     0.0000    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2000    0.2857    0.2353         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4523    0.4523    0.4523       681
                                    macro avg     0.5735    0.4706    0.6945       681
                                 weighted avg     0.5946    0.4523    0.6726       681

2024-08-16 12:59:52.114 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4523
2024-08-16 12:59:52.243 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 12:59:52.243 | INFO     | __main__:eval:454 - Validation loss: 9.684283646670254
2024-08-16 12:59:52.251 | INFO     | __main__:train:256 - epochs: 10
2024-08-16 12:59:52.251 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335]
2024-08-16 12:59:52.251 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254]
2024-08-16 12:59:52.251 | INFO     | __main__:train:159 - ====epoch #11====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 13:04:41.718 | INFO     | __main__:train:207 - Epoch 11 Average Loss: 7.96542
2024-08-16 13:04:42.412 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL11*****
2024-08-16 13:04:42.413 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:04:42.413 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.26it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.27it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.28it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.28it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.28it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.28it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 13:04:59.210 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.3000    1.0000    0.4615         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.5000    0.2500    0.3333         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.0000    0.0000       nan         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.2727    0.7500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.2000    0.1429    0.1667         7
                              BertForMaskedLM     0.1667    0.1250    0.1429         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1739    1.0000    0.2963         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5556    1.0000    0.7143        10
                              BertLMHeadModel     1.0000    0.3333    0.5000         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering     0.5000    0.1429    0.2222         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.2000    0.1250    0.1538         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.1429    0.3333    0.2000         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.8571    0.7500         7
                           DPRQuestionEncoder        nan    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering        nan    0.0000       nan         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.2727    1.0000    0.4286         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.3077    0.5714    0.4000         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.5000    0.2000    0.2857         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.3333    0.1667    0.2222         6
                              DistilBertModel     0.3571    0.6250    0.4545         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM     0.1111    0.2500    0.1538         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering     0.0000    0.0000       nan         7
             ElectraForSequenceClassification     0.4000    0.2857    0.3333         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.2069    0.7500    0.3243         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.6667    0.4444         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     1.0000    1.0000    1.0000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1053    1.0000    0.1905         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.1250    0.2222         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.2500    0.2500    0.2500         4
               MPNetForSequenceClassification     0.5714    0.6667    0.6154         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.6667    1.0000    0.8000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM     0.3333    0.3333    0.3333         3
                           RobertaForMaskedLM     1.0000    0.1429    0.2500         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0909    0.5000    0.1538         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.5000    0.6000    0.5455         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.3333    0.5000         6
                               T5EncoderModel        nan    0.0000       nan         4
                                      T5Model     0.3000    0.7500    0.4286         4
                            T5WithLMHeadModel     0.6000    0.5000    0.5455         6
                              UniSpeechForCTC     0.6000    0.7500    0.6667         4
                           UniSpeechSatForCTC     0.0000    0.0000       nan         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     1.0000    0.1818    0.3077        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining     0.0769    0.3333    0.1250         3
            Wav2Vec2ForSequenceClassification     0.3333    0.1667    0.2222         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.3750    0.5000    0.4286         6
          XLMRobertaForSequenceClassification     0.0000    0.0000       nan         4
             XLMRobertaForTokenClassification     0.0000    0.0000       nan         5
                              XLMRobertaModel     0.2857    0.2857    0.2857         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4655    0.4655    0.4655       681
                                    macro avg     0.5926    0.4757    0.6637       681
                                 weighted avg     0.5973    0.4655    0.6112       681

2024-08-16 13:04:59.211 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4655
2024-08-16 13:04:59.213 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:04:59.214 | INFO     | __main__:eval:454 - Validation loss: 9.582782875407826
2024-08-16 13:04:59.222 | INFO     | __main__:train:256 - epochs: 11
2024-08-16 13:04:59.223 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411]
2024-08-16 13:04:59.223 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826]
2024-08-16 13:04:59.223 | INFO     | __main__:train:159 - ====epoch #12====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:09:48.541 | INFO     | __main__:train:207 - Epoch 12 Average Loss: 8.11499
2024-08-16 13:09:49.237 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL12*****
2024-08-16 13:09:49.237 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:09:49.237 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:18,  1.11it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.20it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.21it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.22it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.23it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.24it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.24it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.24it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 13:10:06.438 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.1818    1.0000    0.3077         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2500    1.0000    0.4000         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.3333    0.2500    0.2857         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.3750    0.3750    0.3750         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.3333    0.2500    0.2857         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5000    0.1000    0.1667        10
                              BertLMHeadModel     1.0000    0.3333    0.5000         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     1.0000    1.0000    1.0000         1
                  BigBirdForQuestionAnswering     0.3684    1.0000    0.5385         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1111    0.2500    0.1538         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.1333    0.4000    0.2000         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.5000    0.2000    0.2857         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2222    0.8000    0.3478         5
             DistilBertForTokenClassification        nan    0.0000       nan         6
                              DistilBertModel     0.3571    0.6250    0.4545         8
                                   DprEncoder     0.0732    0.7500    0.1333         4
                           ElectraForMaskedLM     0.2000    0.2500    0.2222         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.2424    1.0000    0.3902         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.4286    1.0000    0.6000         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.8333    0.9091         6
                            GPTNeoForCausalLM     0.6667    0.6667    0.6667         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.8000    0.8889         5
                LSTMForSequenceClassification     1.0000    1.0000    1.0000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.2222    1.0000    0.3636         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.0000    0.0000       nan         3
             LongformerForTokenClassification     0.6667    0.4000    0.5000         5
                              LongformerModel     0.7143    0.6250    0.6667         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.5455    1.0000    0.7059         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    0.8750    0.9333         8
            MaskFormerForInstanceSegmentation     0.8333    1.0000    0.9091         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1250    0.2000    0.1538         5
                           RobertaForCausalLM     0.3333    0.3333    0.3333         3
                           RobertaForMaskedLM        nan    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1538    0.3333    0.2105         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4444    0.8000    0.5714         5
                                 RobertaModel        nan    0.0000       nan         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.7500    0.8571         4
                                      T5Model     0.4286    0.7500    0.5455         4
                            T5WithLMHeadModel     0.8000    0.6667    0.7273         6
                              UniSpeechForCTC     0.6000    0.7500    0.6667         4
                           UniSpeechSatForCTC     0.0000    0.0000       nan         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3750    0.5000    0.4286         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification     0.0000    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2222    0.2857    0.2500         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4860    0.4860    0.4860       681
                                    macro avg     0.5996    0.5024    0.7110       681
                                 weighted avg     0.5974    0.4860    0.6695       681

2024-08-16 13:10:06.439 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.486
2024-08-16 13:10:06.555 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:10:06.555 | INFO     | __main__:eval:454 - Validation loss: 9.927315191789107
2024-08-16 13:10:06.561 | INFO     | __main__:train:256 - epochs: 12
2024-08-16 13:10:06.561 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568]
2024-08-16 13:10:06.561 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107]
2024-08-16 13:10:06.561 | INFO     | __main__:train:159 - ====epoch #13====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:01,  3.58s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.39s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:14:55.915 | INFO     | __main__:train:207 - Epoch 13 Average Loss: 8.09368
2024-08-16 13:14:56.613 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL13*****
2024-08-16 13:14:56.613 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:14:56.614 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.05it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.24it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.24it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.25it/s]
2024-08-16 13:15:14.357 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.0000    0.0000       nan         6
              AlbertForSequenceClassification        nan    0.0000       nan         7
                 AlbertForTokenClassification     0.1000    0.5000    0.1667         4
                                  AlbertModel     0.0000    0.0000       nan         8
                 BartForConditionalGeneration     0.1667    0.6667    0.2667         3
                     BartForQuestionAnswering        nan    0.0000       nan         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     1.0000    0.2500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5556    1.0000    0.7143        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.3333    0.2500    0.2857         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1111    0.2500    0.1538         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.2857    0.4000         7
                           DPRQuestionEncoder     0.3333    0.5000    0.4000         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3333    0.2000    0.2500         5
             DebertaForSequenceClassification     0.3333    0.6667    0.4444         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.1818    0.4000    0.2500         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2857    0.8000    0.4211         5
DistilBertForMultilabelSequenceClassification     0.1818    0.6667    0.2857         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering     0.0000    0.0000       nan         5
          DistilBertForSequenceClassification        nan    0.0000       nan         5
             DistilBertForTokenClassification     0.1250    0.1667    0.1429         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder     0.0816    1.0000    0.1509         4
                           ElectraForMaskedLM     0.1000    0.2500    0.1429         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.1250    0.3750    0.1875         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.5000    0.6667    0.5714         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    0.6667    0.5714         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1250    1.0000    0.2222         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     0.5000    0.2500    0.3333         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.2727    0.7500    0.4000         4
               MPNetForSequenceClassification        nan    0.0000       nan         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1250    0.2000    0.1538         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0769    0.2500    0.1176         4
    RobertaForNonlinearSequenceClassification     0.0714    0.1667    0.1000         6
                  RobertaForQuestionAnswering     0.1111    0.2500    0.1538         4
             RobertaForSequenceClassification     0.1111    0.1667    0.1333         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.5000    0.6000    0.5455         5
                                 RobertaModel     1.0000    0.3333    0.5000         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     0.7500    0.7500    0.7500         4
                                      T5Model     0.5000    0.5000    0.5000         4
                            T5WithLMHeadModel     0.7143    0.8333    0.7692         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel        nan    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.5000    0.4000         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.3750    0.5000    0.4286         6
          XLMRobertaForSequenceClassification     0.2222    0.5000    0.3077         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4552    0.4552    0.4552       681
                                    macro avg     0.5966    0.4786    0.6729       681
                                 weighted avg     0.5955    0.4552    0.6542       681

2024-08-16 13:15:14.357 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4552
2024-08-16 13:15:14.367 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:15:14.368 | INFO     | __main__:eval:454 - Validation loss: 9.7871939052235
2024-08-16 13:15:14.373 | INFO     | __main__:train:256 - epochs: 13
2024-08-16 13:15:14.373 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945]
2024-08-16 13:15:14.373 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235]
2024-08-16 13:15:14.373 | INFO     | __main__:train:159 - ====epoch #14====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.54s/it]
Training:   2%|▏         | 2/85 [00:06<04:49,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:16,  3.46s/it]
Training:  14%|█▍        | 12/85 [00:41<04:11,  3.44s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.43s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:51<03:59,  3.42s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:05<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:22<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:39<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:56<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:42,  3.39s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.39s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.39s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.39s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.39s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.39s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.39s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:20:03.790 | INFO     | __main__:train:207 - Epoch 14 Average Loss: 7.90792
2024-08-16 13:20:04.504 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL14*****
2024-08-16 13:20:04.504 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:20:04.504 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:01<00:21,  1.00s/it]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.13it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:16,  1.18it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.22it/s]
Evaluating:  27%|██▋       | 6/22 [00:05<00:13,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:09<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:13<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 13:20:21.751 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification     0.6250    0.7143    0.6667         7
                 AlbertForTokenClassification     0.1905    1.0000    0.3200         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2000    1.0000    0.3333         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.0000    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM        nan    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.2051    1.0000    0.3404         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     1.0000    0.1250    0.2222         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5882    1.0000    0.7407        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.0000    0.0000       nan         1
                  BigBirdForQuestionAnswering     0.3333    0.1429    0.2000         7
             BigBirdForSequenceClassification     0.0000    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1111    0.2500    0.1538         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.1765    0.6000    0.2727         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.4000    0.2857    0.3333         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification        nan    0.0000       nan         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.0000    0.0000       nan         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2381    0.8333    0.3704         6
                              DistilBertModel     0.0000    0.0000       nan         8
                                   DprEncoder     0.0000    0.0000       nan         4
                           ElectraForMaskedLM     0.1053    0.5000    0.1739         4
                        ElectraForPreTraining        nan    0.0000       nan         2
                  ElectraForQuestionAnswering     0.8333    0.7143    0.7692         7
             ElectraForSequenceClassification        nan    0.0000       nan         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.2500    0.6250    0.3571         8
                               EsmForMaskedLM        nan    0.0000       nan         1
                 EsmForSequenceClassification     0.4286    1.0000    0.6000         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    0.5000    0.6667         2
                  LEDForConditionalGeneration     0.7143    1.0000    0.8333         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.2500    1.0000    0.4000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.5000    1.0000    0.6667         1
               LlamaForSequenceClassification     1.0000    0.5000    0.6667         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1053    1.0000    0.1905         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.2500    0.4000         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.5000    0.5000    0.5000         4
               MPNetForSequenceClassification     0.5000    0.6667    0.5714         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8000    1.0000    0.8889         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL        nan    0.0000       nan         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1429    0.5000    0.2222         6
                  RobertaForQuestionAnswering     0.1250    0.2500    0.1667         4
             RobertaForSequenceClassification     0.0769    0.1667    0.1053         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.5000    0.6000    0.5455         5
                                 RobertaModel     0.5000    0.1667    0.2500         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech        nan    0.0000       nan         2
                   SwinForImageClassification     1.0000    0.6667    0.8000         6
                               T5EncoderModel        nan    0.0000       nan         4
                                      T5Model     0.2000    0.2500    0.2222         4
                            T5WithLMHeadModel     0.4444    0.6667    0.5333         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.1667    0.5000    0.2500         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining     0.0000    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.3750    0.5000    0.4286         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2500    0.2857    0.2667         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4787    0.4787    0.4787       681
                                    macro avg     0.6050    0.4824    0.6836       681
                                 weighted avg     0.6127    0.4787    0.6518       681

2024-08-16 13:20:21.751 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4787
2024-08-16 13:20:21.759 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:20:21.759 | INFO     | __main__:eval:454 - Validation loss: 9.679902987046676
2024-08-16 13:20:21.764 | INFO     | __main__:train:256 - epochs: 14
2024-08-16 13:20:21.765 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091]
2024-08-16 13:20:21.765 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676]
2024-08-16 13:20:21.765 | INFO     | __main__:train:159 - ====epoch #15====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:56,  3.53s/it]
Training:   2%|▏         | 2/85 [00:06<04:46,  3.45s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.42s/it]
Training:   8%|▊         | 7/85 [00:23<04:26,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.41s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.41s/it]
Training:  16%|█▋        | 14/85 [00:47<04:02,  3.41s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.41s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.41s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.41s/it]
Training:  22%|██▏       | 19/85 [01:04<03:45,  3.41s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.41s/it]
Training:  25%|██▍       | 21/85 [01:11<03:38,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.41s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.41s/it]
Training:  28%|██▊       | 24/85 [01:21<03:28,  3.42s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:28<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:35<03:15,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.42s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.42s/it]
Training:  36%|███▋      | 31/85 [01:45<03:04,  3.42s/it]
Training:  38%|███▊      | 32/85 [01:49<03:01,  3.42s/it]
Training:  39%|███▉      | 33/85 [01:52<02:57,  3.42s/it]
Training:  40%|████      | 34/85 [01:56<02:54,  3.42s/it]
Training:  41%|████      | 35/85 [01:59<02:51,  3.42s/it]
Training:  42%|████▏     | 36/85 [02:03<02:47,  3.42s/it]
Training:  44%|████▎     | 37/85 [02:06<02:44,  3.42s/it]
Training:  45%|████▍     | 38/85 [02:09<02:40,  3.42s/it]
Training:  46%|████▌     | 39/85 [02:13<02:37,  3.42s/it]
Training:  47%|████▋     | 40/85 [02:16<02:34,  3.42s/it]
Training:  48%|████▊     | 41/85 [02:20<02:30,  3.42s/it]
Training:  49%|████▉     | 42/85 [02:23<02:27,  3.42s/it]
Training:  51%|█████     | 43/85 [02:26<02:23,  3.42s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:20,  3.42s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.42s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:13,  3.42s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:10,  3.42s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:06,  3.42s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:03,  3.42s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.42s/it]
Training:  60%|██████    | 51/85 [02:54<01:56,  3.42s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.42s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.42s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:46,  3.42s/it]
Training:  65%|██████▍   | 55/85 [03:08<01:42,  3.42s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:39,  3.42s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.42s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.42s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.42s/it]
Training:  71%|███████   | 60/85 [03:25<01:25,  3.42s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:22,  3.42s/it]
Training:  73%|███████▎  | 62/85 [03:32<01:18,  3.42s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:15,  3.42s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:42<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:05,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:49<01:01,  3.42s/it]
Training:  80%|████████  | 68/85 [03:52<00:58,  3.42s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.43s/it]
Training:  82%|████████▏ | 70/85 [03:59<00:51,  3.42s/it]
Training:  84%|████████▎ | 71/85 [04:02<00:47,  3.42s/it]
Training:  85%|████████▍ | 72/85 [04:06<00:44,  3.42s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:40,  3.41s/it]
Training:  87%|████████▋ | 74/85 [04:13<00:37,  3.41s/it]
Training:  88%|████████▊ | 75/85 [04:16<00:34,  3.41s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:30,  3.41s/it]
Training:  91%|█████████ | 77/85 [04:23<00:27,  3.41s/it]
Training:  92%|█████████▏| 78/85 [04:26<00:23,  3.41s/it]
Training:  93%|█████████▎| 79/85 [04:30<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:33<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:40<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:43<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:47<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.42s/it]
2024-08-16 13:25:12.301 | INFO     | __main__:train:207 - Epoch 15 Average Loss: 8.11686
2024-08-16 13:25:13.012 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL15*****
2024-08-16 13:25:13.012 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:25:13.012 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.05it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 13:25:30.268 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification     0.7143    0.7143    0.7143         7
                 AlbertForTokenClassification     0.1818    1.0000    0.3077         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration     0.1429    0.3333    0.2000         3
                     BartForQuestionAnswering     0.1250    0.3333    0.1818         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.0000    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.6667    0.2500    0.3636         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5714    0.8000    0.6667        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.1429    1.0000    0.2500         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     1.0000    0.2500    0.4000         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.1579    0.5000    0.2400         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3333    1.0000    0.5000         5
             DebertaForSequenceClassification        nan    0.0000       nan         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.5000    0.1429    0.2222         7
           DebertaV2ForSequenceClassification     0.8000    1.0000    0.8889         4
              DebertaV2ForTokenClassification     0.0000    0.0000       nan         5
                               DebertaV2Model     0.1429    0.5000    0.2222         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2667    0.8000    0.4000         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice        nan    0.0000       nan         3
               DistilBertForQuestionAnswering     0.0000    0.0000       nan         5
          DistilBertForSequenceClassification     0.2667    0.8000    0.4000         5
             DistilBertForTokenClassification     0.3333    0.1667    0.2222         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder     0.0816    1.0000    0.1509         4
                           ElectraForMaskedLM     0.0769    0.5000    0.1333         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     1.0000    0.1429    0.2500         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.1250    0.1250    0.1250         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.5000    0.3333    0.4000         3
                    EsmForTokenClassification     0.5000    0.6667    0.5714         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1053    1.0000    0.1905         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.1250    0.2222         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM     0.6667    0.5000    0.5714         4
               MPNetForSequenceClassification     0.5556    0.8333    0.6667         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.5000    0.2000    0.2857         5
                           RobertaForCausalLM     1.0000    0.3333    0.5000         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0909    0.1667    0.1176         6
                  RobertaForQuestionAnswering     0.1111    0.2500    0.1538         4
             RobertaForSequenceClassification     0.0714    0.1667    0.1000         6
                RobertaForTokenClassification     0.0000    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     0.5000    0.1667    0.2500         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     1.0000    0.5000    0.6667         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.2500    0.4000         4
                                      T5Model     0.3000    0.7500    0.4286         4
                            T5WithLMHeadModel     0.6667    0.3333    0.4444         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.2857    0.3333    0.3077         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model        nan       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.3750    0.5000    0.4286         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2222    0.2857    0.2500         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4626    0.4626    0.4626       681
                                    macro avg     0.5943    0.4889    0.6591       681
                                 weighted avg     0.6115    0.4626    0.6418       681

2024-08-16 13:25:30.268 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4626
2024-08-16 13:25:30.282 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:25:30.283 | INFO     | __main__:eval:454 - Validation loss: 9.72066965970126
2024-08-16 13:25:30.288 | INFO     | __main__:train:256 - epochs: 15
2024-08-16 13:25:30.288 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883]
2024-08-16 13:25:30.288 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126]
2024-08-16 13:25:30.288 | INFO     | __main__:train:159 - ====epoch #16====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:00,  3.58s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:30:19.379 | INFO     | __main__:train:207 - Epoch 16 Average Loss: 8.01876
2024-08-16 13:30:20.070 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL16*****
2024-08-16 13:30:20.070 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:30:20.070 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 13:30:37.319 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.3750    0.5455         8
                   AlbertForQuestionAnswering     0.3750    1.0000    0.5455         6
              AlbertForSequenceClassification     0.6250    0.7143    0.6667         7
                 AlbertForTokenClassification     0.1667    0.2500    0.2000         4
                                  AlbertModel        nan    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2308    1.0000    0.3750         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.0000    0.0000       nan         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.2105    1.0000    0.3478         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.4000    0.2500    0.3077         8
                     BertForQuestionAnswering     0.3333    0.4000    0.3636         5
                BertForSequenceClassification     0.0769    0.2500    0.1176         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.6154    0.8000    0.6957        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.1111    1.0000    0.2000         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.1786    0.6250    0.2778         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     1.0000    0.1667    0.2857         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.2222    0.4000    0.2857         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.0000    0.0000       nan         5
DistilBertForMultilabelSequenceClassification     0.1818    0.6667    0.2857         3
                  DistilBertForMultipleChoice     0.3333    0.3333    0.3333         3
               DistilBertForQuestionAnswering     0.5000    0.2000    0.2857         5
          DistilBertForSequenceClassification     0.0000    0.0000       nan         5
             DistilBertForTokenClassification        nan    0.0000       nan         6
                              DistilBertModel     0.3571    0.6250    0.4545         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM     0.5000    0.2500    0.3333         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     1.0000    0.2857    0.4444         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.5000    1.0000    0.6667         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.6667    0.4444         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    0.6667    0.5714         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1000    0.5000    0.1667         2
               LongformerForQuestionAnswering     0.2000    0.2000    0.2000         5
          LongformerForSequenceClassification     0.5000    0.6667    0.5714         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.1250    0.2222         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.5556    0.8333    0.6667         6
                                   MPNetModel     0.6250    0.7143    0.6667         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.8000    0.8889         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1154    0.6000    0.1935         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0833    0.1667    0.1111         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification        nan    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     1.0000    0.5000    0.6667         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     1.0000    0.2500    0.4000         4
                                      T5Model     0.5000    0.5000    0.5000         4
                            T5WithLMHeadModel     0.5556    0.8333    0.6667         6
                              UniSpeechForCTC     0.6000    0.7500    0.6667         4
                           UniSpeechSatForCTC     0.0000    0.0000       nan         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     1.0000    0.1818    0.3077        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining     0.0000    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.3636    0.6667    0.4706         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2857    0.2857    0.2857         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4758    0.4758    0.4758       681
                                    macro avg     0.5684    0.4877    0.6784       681
                                 weighted avg     0.5963    0.4758    0.6493       681

2024-08-16 13:30:37.319 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4758
2024-08-16 13:30:37.325 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:30:37.325 | INFO     | __main__:eval:454 - Validation loss: 9.667257222262295
2024-08-16 13:30:37.330 | INFO     | __main__:train:256 - epochs: 16
2024-08-16 13:30:37.330 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087]
2024-08-16 13:30:37.330 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295]
2024-08-16 13:30:37.330 | INFO     | __main__:train:159 - ====epoch #17====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.46s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.40s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:23,  3.45s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.43s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:38<03:11,  3.41s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.41s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.41s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.39s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.39s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:35:26.553 | INFO     | __main__:train:207 - Epoch 17 Average Loss: 7.86920
2024-08-16 13:35:27.247 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL17*****
2024-08-16 13:35:27.247 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:35:27.247 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.28it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.28it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 13:35:44.016 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5000    0.6250    0.5556         8
                   AlbertForQuestionAnswering     0.3125    0.8333    0.4545         6
              AlbertForSequenceClassification     0.0000    0.0000       nan         7
                 AlbertForTokenClassification     0.0000    0.0000       nan         4
                                  AlbertModel     0.0000    0.0000       nan         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2727    1.0000    0.4286         3
                BartForSequenceClassification     1.0000    0.7143    0.8333         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.2051    1.0000    0.3404         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.2000    0.1250    0.1538         8
                     BertForQuestionAnswering     1.0000    0.2000    0.3333         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5833    0.7000    0.6364        10
                              BertLMHeadModel     0.0000    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.1000    1.0000    0.1818         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.1429    0.5000    0.2222         6
                               CamembertModel        nan    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.8571    0.7500         7
                           DPRQuestionEncoder        nan    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.3636    0.5714    0.4444         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.0000    0.0000       nan         5
                               DebertaV2Model        nan    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.0000    0.0000       nan         5
DistilBertForMultilabelSequenceClassification     0.1818    0.6667    0.2857         3
                  DistilBertForMultipleChoice     0.3333    0.6667    0.4444         3
               DistilBertForQuestionAnswering     1.0000    0.2000    0.3333         5
          DistilBertForSequenceClassification        nan    0.0000       nan         5
             DistilBertForTokenClassification        nan    0.0000       nan         6
                              DistilBertModel     0.3333    0.6250    0.4348         8
                                   DprEncoder     0.0000    0.0000       nan         4
                           ElectraForMaskedLM     0.1875    0.7500    0.3000         4
                        ElectraForPreTraining        nan    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5000    0.1429    0.2222         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.1667    0.2500    0.2000         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.6667    0.4444         3
                    EsmForTokenClassification        nan    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    0.6667    0.5714         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1667    1.0000    0.2857         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.0000    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     0.7143    0.6250    0.6667         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     0.6667    1.0000    0.8000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.5455    1.0000    0.7059         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.1250    0.2857    0.1739         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1176    0.3333    0.1739         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     1.0000    0.5000    0.6667         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.4000    0.5000    0.4444         4
                            T5WithLMHeadModel     0.5714    0.6667    0.6154         6
                              UniSpeechForCTC     1.0000    0.5000    0.6667         4
                           UniSpeechSatForCTC     0.2500    0.5000    0.3333         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     0.7500    1.0000    0.8571         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.3636    0.6667    0.4706         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification     0.4286    0.6000    0.5000         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4890    0.4890    0.4890       681
                                    macro avg     0.5682    0.4957    0.6983       681
                                 weighted avg     0.5733    0.4890    0.6737       681

2024-08-16 13:35:44.016 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.489
2024-08-16 13:35:44.024 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:35:44.025 | INFO     | __main__:eval:454 - Validation loss: 9.618915341117166
2024-08-16 13:35:44.031 | INFO     | __main__:train:256 - epochs: 17
2024-08-16 13:35:44.032 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423]
2024-08-16 13:35:44.032 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166]
2024-08-16 13:35:44.032 | INFO     | __main__:train:159 - ====epoch #18====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.46s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:14,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:40:33.247 | INFO     | __main__:train:207 - Epoch 18 Average Loss: 7.87430
2024-08-16 13:40:33.981 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL18*****
2024-08-16 13:40:33.981 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:40:33.981 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.24it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.24it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.24it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.24it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.24it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.24it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.24it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 13:40:51.158 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.0000    0.0000       nan         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.0769    0.2500    0.1176         4
                                  AlbertModel     0.3333    0.1250    0.1818         8
                 BartForConditionalGeneration     0.0000    0.0000       nan         3
                     BartForQuestionAnswering     0.0000    0.0000       nan         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.2500    0.7500    0.3750         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.1429    0.2000         7
                              BertForMaskedLM     0.1818    0.2500    0.2105         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.2105    1.0000    0.3478         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.0000    0.0000       nan         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5625    0.9000    0.6923        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.2000    1.0000    0.3333         1
                  BigBirdForQuestionAnswering     0.0000    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification        nan    0.0000       nan         8
              CamembertForTokenClassification     0.1875    0.5000    0.2727         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.2353    0.8000    0.3636         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.0000    0.0000       nan         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.0000    0.0000       nan         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2857    0.6667    0.4000         3
               DistilBertForQuestionAnswering     0.1667    0.4000    0.2353         5
          DistilBertForSequenceClassification        nan    0.0000       nan         5
             DistilBertForTokenClassification        nan    0.0000       nan         6
                              DistilBertModel     0.3571    0.6250    0.4545         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM     0.1667    0.5000    0.2500         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.6000    0.4286    0.5000         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.1667    0.5000    0.2500         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.4000    0.6667    0.5000         3
                    EsmForTokenClassification     0.0000    0.0000       nan         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.8333    0.9091         6
                            GPTNeoForCausalLM     0.6667    0.6667    0.6667         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering     0.2500    0.4000    0.3077         5
          LongformerForSequenceClassification     0.6667    0.6667    0.6667         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.3750    0.5455         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     0.5000    0.2500    0.3333         4
               MPNetForSequenceClassification     0.5455    1.0000    0.7059         6
                                   MPNetModel     1.0000    0.5714    0.7273         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     0.8889    1.0000    0.9412         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.0769    0.2000    0.1111         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.2000    0.1429    0.1667         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0000    0.0000       nan         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0667    0.1667    0.0952         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     0.6667    0.3333    0.4444         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.6667    1.0000    0.8000         2
                   SwinForImageClassification     1.0000    0.8333    0.9091         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.5000    0.2500    0.3333         4
                            T5WithLMHeadModel     0.5000    0.8333    0.6250         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     0.7500    1.0000    0.8571         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.3636    0.6667    0.4706         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification     0.4286    0.6000    0.5000         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4860    0.4860    0.4860       681
                                    macro avg     0.5617    0.4923    0.6857       681
                                 weighted avg     0.5724    0.4860    0.6563       681

2024-08-16 13:40:51.158 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.486
2024-08-16 13:40:51.167 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:40:51.167 | INFO     | __main__:eval:454 - Validation loss: 9.598710840398615
2024-08-16 13:40:51.175 | INFO     | __main__:train:256 - epochs: 18
2024-08-16 13:40:51.175 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514]
2024-08-16 13:40:51.175 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615]
2024-08-16 13:40:51.175 | INFO     | __main__:train:159 - ====epoch #19====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.56s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.39s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:19,  3.44s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:15,  3.43s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.41s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.41s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.41s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:45:40.476 | INFO     | __main__:train:207 - Epoch 19 Average Loss: 7.98575
2024-08-16 13:45:41.173 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL19*****
2024-08-16 13:45:41.174 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:45:41.174 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.26it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.26it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 13:45:58.289 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     0.5455    0.7500    0.6316         8
                   AlbertForQuestionAnswering     0.3077    0.6667    0.4211         6
              AlbertForSequenceClassification     0.2500    0.1429    0.1818         7
                 AlbertForTokenClassification     0.0000    0.0000       nan         4
                                  AlbertModel     0.5000    0.2500    0.3333         8
                 BartForConditionalGeneration     0.1429    0.3333    0.2000         3
                     BartForQuestionAnswering     0.2000    0.3333    0.2500         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.2500    0.2500    0.2500         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.1176    0.5714    0.1951         7
                              BertForMaskedLM     0.1538    0.2500    0.1905         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.2000    0.2500    0.2222         8
                BertForNextSentencePrediction        nan    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.3333    0.2500    0.2857         8
                     BertForQuestionAnswering        nan    0.0000       nan         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.4000    0.2000    0.2667        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.0588    1.0000    0.1111         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.0000    0.0000       nan         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    0.7500    0.8571         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder        nan    0.0000       nan         7
                           DPRQuestionEncoder     0.3333    0.7500    0.4615         4
                           DebertaForMaskedLM     0.3333    0.5000    0.4000         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     1.0000    0.1667    0.2857         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.2000    0.6000    0.3000         5
                               DebertaV2Model     0.0000    0.0000       nan         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.0000    0.0000       nan         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.0000    0.0000       nan         3
               DistilBertForQuestionAnswering     0.0000    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2778    0.8333    0.4167         6
                              DistilBertModel     0.5000    0.1250    0.2000         8
                                   DprEncoder        nan    0.0000       nan         4
                           ElectraForMaskedLM     0.0000    0.0000       nan         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.6667    0.2857    0.4000         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.2963    1.0000    0.4571         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     0.3333    0.3333    0.3333         3
                    EsmForTokenClassification     0.5000    0.3333    0.4000         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    1.0000    0.6667         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    0.6000    0.7500         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering     0.3333    0.8000    0.4706         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     0.7143    0.6250    0.6667         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.6000    1.0000    0.7500         6
                                   MPNetModel     0.7143    0.7143    0.7143         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    0.8750    0.9333         8
            MaskFormerForInstanceSegmentation     0.8333    1.0000    0.9091         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.2500    0.1429    0.1818         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1538    0.3333    0.2105         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.1579    0.5000    0.2400         6
                RobertaForTokenClassification     0.0000    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.5000    0.6000    0.5455         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.0000    0.0000       nan         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.3333    0.7500    0.4615         4
                            T5WithLMHeadModel     0.6667    0.3333    0.4444         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     1.0000    0.1818    0.3077        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification     0.4286    0.6000    0.5000         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4626    0.4626    0.4626       681
                                    macro avg     0.5504    0.4807    0.6524       681
                                 weighted avg     0.5650    0.4626    0.6083       681

2024-08-16 13:45:58.290 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4626
2024-08-16 13:45:58.299 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:45:58.299 | INFO     | __main__:eval:454 - Validation loss: 9.792378468946977
2024-08-16 13:45:58.304 | INFO     | __main__:train:256 - epochs: 19
2024-08-16 13:45:58.304 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725]
2024-08-16 13:45:58.304 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977]
2024-08-16 13:45:58.304 | INFO     | __main__:train:159 - ====epoch #20====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:00,  3.58s/it]
Training:   2%|▏         | 2/85 [00:07<04:50,  3.50s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.44s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.42s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.41s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.41s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.41s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<02:59,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.39s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:58,  3.45s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.44s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.43s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.42s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.41s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.41s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.41s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 13:50:47.755 | INFO     | __main__:train:207 - Epoch 20 Average Loss: 7.93283
2024-08-16 13:50:48.450 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL20*****
2024-08-16 13:50:48.450 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:50:48.451 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.19it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.28it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.27it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.30it/s]
2024-08-16 13:51:05.371 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.2941    0.8333    0.4348         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.0000    0.0000       nan         4
                                  AlbertModel     0.0000    0.0000       nan         8
                 BartForConditionalGeneration     0.3333    0.3333    0.3333         3
                     BartForQuestionAnswering     0.2000    0.6667    0.3077         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.2000    0.1429    0.1667         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice        nan    0.0000       nan         8
                BertForNextSentencePrediction     0.1538    1.0000    0.2667         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining        nan    0.0000       nan         8
                     BertForQuestionAnswering     0.2000    0.6000    0.3000         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5882    1.0000    0.7407        10
                              BertLMHeadModel     1.0000    0.3333    0.5000         3
                                    BertModel        nan    0.0000       nan         4
                           BigBirdForMaskedLM     0.2000    1.0000    0.3333         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1053    0.2500    0.1481         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     0.8000    1.0000    0.8889         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.2857    0.4000         7
                           DPRQuestionEncoder     0.3333    0.5000    0.4000         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.0000    0.0000       nan         5
                               DebertaV2Model     0.0769    0.5000    0.1333         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3125    1.0000    0.4762         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.3333    0.1667    0.2222         6
                              DistilBertModel        nan    0.0000       nan         8
                                   DprEncoder     0.1081    1.0000    0.1951         4
                           ElectraForMaskedLM     0.2727    0.7500    0.4000         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering     0.0000    0.0000       nan         7
             ElectraForSequenceClassification     0.2857    0.2857    0.2857         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.3333    0.1250    0.1818         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     1.0000    0.3333    0.5000         3
                    EsmForTokenClassification     0.6000    1.0000    0.7500         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.5000    0.6667    0.5714         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.5000    1.0000    0.6667         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering        nan    0.0000       nan         5
          LongformerForSequenceClassification     0.4000    0.6667    0.5000         3
             LongformerForTokenClassification     0.3750    0.6000    0.4615         5
                              LongformerModel     1.0000    0.3750    0.5455         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     0.2857    0.5000    0.3636         4
               MPNetForSequenceClassification     0.5000    0.3333    0.4000         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM     0.0000       nan       nan         0
                 OPTForSequenceClassification     1.0000    0.8000    0.8889         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0833    0.3333    0.1333         6
                  RobertaForQuestionAnswering     0.0000    0.0000       nan         4
             RobertaForSequenceClassification     0.1429    0.1667    0.1538         6
                RobertaForTokenClassification     0.0000    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.7500    0.8571         4
                                      T5Model     0.3750    0.7500    0.5000         4
                            T5WithLMHeadModel     0.6667    0.3333    0.4444         6
                              UniSpeechForCTC     0.6000    0.7500    0.6667         4
                           UniSpeechSatForCTC     0.0000    0.0000       nan         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     0.7500    1.0000    0.8571         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification     0.4286    0.6000    0.5000         5
                              XLMRobertaModel        nan    0.0000       nan         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4846    0.4846    0.4846       681
                                    macro avg     0.5618    0.5074    0.6787       681
                                 weighted avg     0.5824    0.4846    0.6588       681

2024-08-16 13:51:05.371 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4846
2024-08-16 13:51:05.407 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:51:05.408 | INFO     | __main__:eval:454 - Validation loss: 9.619529117237438
2024-08-16 13:51:05.414 | INFO     | __main__:train:256 - epochs: 20
2024-08-16 13:51:05.414 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199]
2024-08-16 13:51:05.414 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438]
2024-08-16 13:51:05.414 | INFO     | __main__:train:159 - ====epoch #21====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:05,  3.63s/it]
Training:   2%|▏         | 2/85 [00:07<04:50,  3.50s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.42s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:24<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:23,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.39s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.39s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.39s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 13:55:54.548 | INFO     | __main__:train:207 - Epoch 21 Average Loss: 7.63218
2024-08-16 13:55:55.280 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL21*****
2024-08-16 13:55:55.280 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:55:55.280 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 13:56:12.685 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.3333    0.5000    0.4000         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.1667    0.2500    0.2000         4
                                  AlbertModel     0.6000    0.3750    0.4615         8
                 BartForConditionalGeneration     0.3333    0.3333    0.3333         3
                     BartForQuestionAnswering     0.2000    0.6667    0.3077         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel        nan    0.0000       nan         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.2000    0.1429    0.1667         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.0625    0.1250    0.0833         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.1250    0.2000         8
                     BertForQuestionAnswering     0.1667    0.2000    0.1818         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5882    1.0000    0.7407        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.2000    1.0000    0.3333         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification     0.1429    0.2500    0.1818         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.2857    0.4000         7
                           DPRQuestionEncoder     0.3333    0.5000    0.4000         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.3333    0.2000    0.2500         5
                               DebertaV2Model     0.0909    0.5000    0.1538         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.1429    0.2000    0.1667         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.3333    0.1667    0.2222         6
                              DistilBertModel     0.2222    0.2500    0.2353         8
                                   DprEncoder     0.0741    0.5000    0.1290         4
                           ElectraForMaskedLM     0.2500    0.7500    0.3750         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.6667    0.5714    0.6154         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.6667    0.2500    0.3636         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     0.5000    0.3333    0.4000         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering     0.0000    0.0000       nan         5
          LongformerForSequenceClassification     0.5000    0.6667    0.5714         3
             LongformerForTokenClassification     0.2500    0.2000    0.2222         5
                              LongformerModel     1.0000    0.5000    0.6667         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     1.0000    0.2500    0.4000         4
               MPNetForSequenceClassification     0.6000    1.0000    0.7500         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1667    0.2000    0.1818         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1176    0.3333    0.1739         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0667    0.1667    0.0952         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.5000    1.0000    0.6667         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.7500    0.8571         4
                                      T5Model     0.5000    0.7500    0.6000         4
                            T5WithLMHeadModel     0.6000    0.5000    0.5455         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     0.7500    1.0000    0.8571         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2857    0.2857    0.2857         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4919    0.4919    0.4919       681
                                    macro avg     0.5730    0.5078    0.6505       681
                                 weighted avg     0.5866    0.4919    0.6239       681

2024-08-16 13:56:12.685 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4919
2024-08-16 13:56:12.735 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 13:56:12.735 | INFO     | __main__:eval:454 - Validation loss: 9.537416371432217
2024-08-16 13:56:12.740 | INFO     | __main__:train:256 - epochs: 21
2024-08-16 13:56:12.740 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229]
2024-08-16 13:56:12.740 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217]
2024-08-16 13:56:12.740 | INFO     | __main__:train:159 - ====epoch #22====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:00,  3.58s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:23,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.39s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.39s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.39s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.41s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.41s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.41s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.41s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.41s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.41s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.41s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 14:01:01.942 | INFO     | __main__:train:207 - Epoch 22 Average Loss: 7.76140
2024-08-16 14:01:02.834 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL22*****
2024-08-16 14:01:02.834 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:01:02.834 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.08it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 14:01:20.110 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.0000    0.0000       nan         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.0769    0.2500    0.1176         4
                                  AlbertModel     0.0000    0.0000       nan         8
                 BartForConditionalGeneration     0.3333    0.3333    0.3333         3
                     BartForQuestionAnswering     0.2222    0.6667    0.3333         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.5000    0.2500    0.3333         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.4286    0.4286    0.4286         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.0625    0.1250    0.0833         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.1667    0.2000    0.1818         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5625    0.9000    0.6923        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.1667    1.0000    0.2857         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification     0.1250    0.2500    0.1667         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.7143    0.7143    0.7143         7
                           DPRQuestionEncoder     0.5000    0.2500    0.3333         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.0000    0.0000       nan         5
                               DebertaV2Model     0.0833    0.5000    0.1429         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.1429    0.2000    0.1667         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel     0.2500    0.2500    0.2500         8
                                   DprEncoder     0.0714    0.5000    0.1250         4
                           ElectraForMaskedLM     0.1667    0.5000    0.2500         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5714    0.5714    0.5714         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.5000    0.3750    0.4286         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     0.5000    0.3333    0.4000         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8000    0.8000    0.8000         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering     0.1667    0.2000    0.1818         5
          LongformerForSequenceClassification     0.5000    0.6667    0.5714         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.5000    0.6667         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     1.0000    0.2500    0.4000         4
               MPNetForSequenceClassification     0.6000    1.0000    0.7500         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.2500    0.1429    0.1818         7
                     RobertaForMultipleChoice        nan    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1176    0.3333    0.1739         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0625    0.1667    0.0909         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.6667    1.0000    0.8000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.7500    0.8571         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.5000    0.5000    0.5000         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     0.7500    1.0000    0.8571         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification        nan    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.5000    0.2500    0.3333         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2857    0.2857    0.2857         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4890    0.4890    0.4890       681
                                    macro avg     0.5736    0.5064    0.6560       681
                                 weighted avg     0.5838    0.4890    0.6309       681

2024-08-16 14:01:20.110 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.489
2024-08-16 14:01:20.120 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:01:20.120 | INFO     | __main__:eval:454 - Validation loss: 9.520012075250799
2024-08-16 14:01:20.126 | INFO     | __main__:train:256 - epochs: 22
2024-08-16 14:01:20.127 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018]
2024-08-16 14:01:20.127 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799]
2024-08-16 14:01:20.127 | INFO     | __main__:train:159 - ====epoch #23====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:00,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.44s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.42s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.42s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:47<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:51<03:59,  3.42s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.42s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.42s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.42s/it]
Training:  22%|██▏       | 19/85 [01:05<03:45,  3.42s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.42s/it]
Training:  25%|██▍       | 21/85 [01:11<03:38,  3.42s/it]
Training:  26%|██▌       | 22/85 [01:15<03:35,  3.42s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.42s/it]
Training:  28%|██▊       | 24/85 [01:22<03:28,  3.42s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:28<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:35<03:15,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.42s/it]
Training:  35%|███▌      | 30/85 [01:42<03:08,  3.43s/it]
Training:  36%|███▋      | 31/85 [01:46<03:05,  3.43s/it]
Training:  38%|███▊      | 32/85 [01:49<03:01,  3.42s/it]
Training:  39%|███▉      | 33/85 [01:52<02:57,  3.42s/it]
Training:  40%|████      | 34/85 [01:56<02:54,  3.41s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.41s/it]
Training:  42%|████▏     | 36/85 [02:03<02:46,  3.41s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:20<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:54<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.39s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:02<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 14:06:09.844 | INFO     | __main__:train:207 - Epoch 23 Average Loss: 7.76508
2024-08-16 14:06:10.541 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL23*****
2024-08-16 14:06:10.541 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:06:10.541 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.02it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.27it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.27it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.28it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.28it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.30it/s]
2024-08-16 14:06:27.528 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.0000    0.0000       nan         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.1765    0.7500    0.2857         4
                                  AlbertModel     0.0000    0.0000       nan         8
                 BartForConditionalGeneration     0.0000    0.0000       nan         3
                     BartForQuestionAnswering     0.1818    0.6667    0.2857         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     1.0000    0.2500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.4286    0.4286    0.4286         7
                              BertForMaskedLM     0.2857    0.2500    0.2667         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.0833    0.1250    0.1000         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.1429    0.4000    0.2105         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5714    0.8000    0.6667        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.2000    1.0000    0.3333         1
                  BigBirdForQuestionAnswering     0.0000    0.0000       nan         7
             BigBirdForSequenceClassification     1.0000    0.2500    0.4000         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification     0.1429    0.2500    0.1818         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.7500    0.4286    0.5455         7
                           DPRQuestionEncoder     0.4000    0.5000    0.4444         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.2500    0.2000    0.2222         5
                               DebertaV2Model     0.0909    0.5000    0.1538         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2500    0.4000    0.3077         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.4000    0.6667    0.5000         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.3333    0.1667    0.2222         6
                              DistilBertModel     0.2857    0.2500    0.2667         8
                                   DprEncoder     0.0833    0.5000    0.1429         4
                           ElectraForMaskedLM     0.1667    0.5000    0.2500         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.6667    0.5714    0.6154         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.5000    0.3750    0.4286         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.3333    0.3333         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1250    0.5000    0.2000         2
               LongformerForQuestionAnswering     0.0000    0.0000       nan         5
          LongformerForSequenceClassification     0.5000    0.6667    0.5714         3
             LongformerForTokenClassification     0.5000    0.4000    0.4444         5
                              LongformerModel     1.0000    0.3750    0.5455         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     0.6667    0.5000    0.5714         4
               MPNetForSequenceClassification     0.6250    0.8333    0.7143         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.1667    0.1429    0.1538         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1111    0.3333    0.1667         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.8333    1.0000    0.9091         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.5000    0.7500    0.6000         4
                            T5WithLMHeadModel     0.5000    0.5000    0.5000         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.5000    0.2500    0.3333         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2500    0.2857    0.2667         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4949    0.4949    0.4949       681
                                    macro avg     0.5562    0.5091    0.6564       681
                                 weighted avg     0.5694    0.4949    0.6313       681

2024-08-16 14:06:27.528 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4949
2024-08-16 14:06:27.536 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:06:27.536 | INFO     | __main__:eval:454 - Validation loss: 9.532030539079146
2024-08-16 14:06:27.545 | INFO     | __main__:train:256 - epochs: 23
2024-08-16 14:06:27.545 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295]
2024-08-16 14:06:27.545 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146]
2024-08-16 14:06:27.545 | INFO     | __main__:train:159 - ====epoch #24====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:01,  3.58s/it]
Training:   2%|▏         | 2/85 [00:06<04:49,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:49,  3.53s/it]
Training:   5%|▍         | 4/85 [00:13<04:41,  3.48s/it]
Training:   6%|▌         | 5/85 [00:17<04:35,  3.45s/it]
Training:   7%|▋         | 6/85 [00:20<04:31,  3.44s/it]
Training:   8%|▊         | 7/85 [00:24<04:27,  3.43s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.42s/it]
Training:  11%|█         | 9/85 [00:31<04:19,  3.42s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.41s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.41s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.41s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.41s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.41s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.41s/it]
Training:  22%|██▏       | 19/85 [01:05<03:45,  3.41s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.41s/it]
Training:  25%|██▍       | 21/85 [01:11<03:38,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.41s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.41s/it]
Training:  28%|██▊       | 24/85 [01:22<03:27,  3.41s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.41s/it]
Training:  31%|███       | 26/85 [01:28<03:21,  3.41s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.41s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.41s/it]
Training:  34%|███▍      | 29/85 [01:39<03:10,  3.41s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.41s/it]
Training:  36%|███▋      | 31/85 [01:46<03:04,  3.41s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.41s/it]
Training:  39%|███▉      | 33/85 [01:52<02:57,  3.41s/it]
Training:  40%|████      | 34/85 [01:56<02:53,  3.41s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.41s/it]
Training:  42%|████▏     | 36/85 [02:03<02:47,  3.41s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.41s/it]
Training:  45%|████▍     | 38/85 [02:09<02:40,  3.41s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.41s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.41s/it]
Training:  48%|████▊     | 41/85 [02:20<02:29,  3.41s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.41s/it]
Training:  51%|█████     | 43/85 [02:26<02:23,  3.41s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.41s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.41s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:12,  3.41s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.41s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:06,  3.41s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:02,  3.41s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.41s/it]
Training:  60%|██████    | 51/85 [02:54<01:55,  3.41s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.41s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:49,  3.42s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:45,  3.42s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.42s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:39,  3.42s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.42s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:32,  3.42s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.42s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.42s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:21,  3.41s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.41s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:14,  3.41s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:52<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:02<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:26<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:43<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.41s/it]
2024-08-16 14:11:17.577 | INFO     | __main__:train:207 - Epoch 24 Average Loss: 7.76297
2024-08-16 14:11:18.270 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL24*****
2024-08-16 14:11:18.270 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:11:18.270 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.62it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 14:11:35.477 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering        nan    0.0000       nan         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.1667    0.7500    0.2727         4
                                  AlbertModel     0.0000    0.0000       nan         8
                 BartForConditionalGeneration     0.0000    0.0000       nan         3
                     BartForQuestionAnswering     0.1818    0.6667    0.2857         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.5000    0.2500    0.3333         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.2500    0.1429    0.1818         7
                              BertForMaskedLM     0.3333    0.2500    0.2857         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1765    0.3750    0.2400         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification     0.0000    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.2500    0.6000    0.3529         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5625    0.9000    0.6923        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.1667    1.0000    0.2857         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.5000    0.1250    0.2000         8
           CamembertForSequenceClassification     0.0769    0.1250    0.0952         8
              CamembertForTokenClassification     0.5000    0.1667    0.2500         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.5000    0.1429    0.2222         7
                           DPRQuestionEncoder     0.2857    0.5000    0.3636         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.3333    0.5000    0.4000         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.5000    0.2000    0.2857         5
                               DebertaV2Model     0.1111    0.5000    0.1818         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2222    0.4000    0.2857         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.3333    0.3333         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.3333    0.1667    0.2222         6
                              DistilBertModel     0.2500    0.2500    0.2500         8
                                   DprEncoder     0.0556    0.2500    0.0909         4
                           ElectraForMaskedLM     0.1818    0.5000    0.2667         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5000    0.8571    0.6316         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.5714    0.5000    0.5333         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     1.0000    0.3333    0.5000         3
                    EsmForTokenClassification     0.7500    1.0000    0.8571         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    1.0000    1.0000         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.0000    0.0000       nan         2
               LongformerForQuestionAnswering     0.2857    0.4000    0.3333         5
          LongformerForSequenceClassification     0.6667    0.6667    0.6667         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     1.0000    0.3750    0.5455         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     1.0000    0.5000    0.6667         4
               MPNetForSequenceClassification     0.6000    1.0000    0.7500         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.2000    0.1429    0.1667         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1111    0.3333    0.1667         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0769    0.1667    0.1053         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.8000    0.8000    0.8000         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.0000    0.0000       nan         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.5000    0.7500    0.6000         4
                            T5WithLMHeadModel     0.5000    0.5000    0.5000         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.5000    0.2500    0.3333         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2500    0.2857    0.2667         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.4993    0.4993    0.4993       681
                                    macro avg     0.5698    0.5137    0.6487       681
                                 weighted avg     0.5875    0.4993    0.6157       681

2024-08-16 14:11:35.477 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.4993
2024-08-16 14:11:35.480 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:11:35.480 | INFO     | __main__:eval:454 - Validation loss: 9.53451202132485
2024-08-16 14:11:35.485 | INFO     | __main__:train:256 - epochs: 24
2024-08-16 14:11:35.486 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946]
2024-08-16 14:11:35.486 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485]
2024-08-16 14:11:35.486 | INFO     | __main__:train:159 - ====epoch #25====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.43s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.41s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.41s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:58<03:51,  3.41s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.41s/it]
Training:  22%|██▏       | 19/85 [01:04<03:45,  3.41s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.41s/it]
Training:  25%|██▍       | 21/85 [01:11<03:38,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.41s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.41s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.41s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.41s/it]
Training:  31%|███       | 26/85 [01:28<03:21,  3.41s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.41s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.41s/it]
Training:  34%|███▍      | 29/85 [01:39<03:11,  3.41s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.41s/it]
Training:  36%|███▋      | 31/85 [01:45<03:04,  3.41s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.41s/it]
Training:  39%|███▉      | 33/85 [01:52<02:57,  3.41s/it]
Training:  40%|████      | 34/85 [01:56<02:54,  3.41s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.41s/it]
Training:  42%|████▏     | 36/85 [02:02<02:47,  3.41s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.41s/it]
Training:  45%|████▍     | 38/85 [02:09<02:40,  3.41s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.41s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.41s/it]
Training:  48%|████▊     | 41/85 [02:19<02:30,  3.41s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.41s/it]
Training:  51%|█████     | 43/85 [02:26<02:23,  3.41s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.41s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.41s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:13,  3.41s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.41s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:06,  3.41s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:02,  3.41s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.41s/it]
Training:  60%|██████    | 51/85 [02:54<01:55,  3.41s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.41s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:49,  3.41s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:45,  3.41s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.41s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.41s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.41s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.41s/it]
Training:  84%|████████▎ | 71/85 [04:02<00:47,  3.41s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.41s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:40,  3.41s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.41s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.41s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:30,  3.42s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.42s/it]
Training:  92%|█████████▏| 78/85 [04:26<00:23,  3.41s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.41s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:17,  3.41s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.42s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.42s/it]
Training:  98%|█████████▊| 83/85 [04:43<00:06,  3.42s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.42s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.41s/it]
2024-08-16 14:16:25.585 | INFO     | __main__:train:207 - Epoch 25 Average Loss: 7.74012
2024-08-16 14:16:26.308 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL25*****
2024-08-16 14:16:26.308 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:16:26.308 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.08it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 14:16:43.417 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.3636    0.6667    0.4706         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.0000    0.0000       nan         4
                                  AlbertModel     0.6000    0.3750    0.4615         8
                 BartForConditionalGeneration     0.0000    0.0000       nan         3
                     BartForQuestionAnswering     0.1818    0.6667    0.2857         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     1.0000    0.2500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM     0.2000    0.1250    0.1538         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.0000    0.0000       nan         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.2308    0.6000    0.3333         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5625    0.9000    0.6923        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.1667    1.0000    0.2857         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     1.0000    0.1250    0.2222         8
           CamembertForSequenceClassification     0.1429    0.2500    0.1818         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.8000    0.5714    0.6667         7
                           DPRQuestionEncoder     0.5000    0.5000    0.5000         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3636    0.8000    0.5000         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification        nan    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering        nan    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.2500    0.2000    0.2222         5
                               DebertaV2Model     0.0909    0.5000    0.1538         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3571    1.0000    0.5263         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.3333    0.3333         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel     0.5000    0.1250    0.2000         8
                                   DprEncoder     0.0870    0.5000    0.1481         4
                           ElectraForMaskedLM     0.1818    0.5000    0.2667         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5000    0.7143    0.5882         7
                ElectraForTokenClassification        nan    0.0000       nan         3
                                 ElectraModel     0.6667    0.5000    0.5714         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     0.3333    0.3333    0.3333         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1250    0.5000    0.2000         2
               LongformerForQuestionAnswering     0.2000    0.2000    0.2000         5
          LongformerForSequenceClassification     0.3333    0.3333    0.3333         3
             LongformerForTokenClassification        nan    0.0000       nan         5
                              LongformerModel     0.7500    0.3750    0.5000         8
               M2M100ForConditionalGeneration     0.7500    0.7500    0.7500         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     1.0000    0.2500    0.4000         4
               MPNetForSequenceClassification     0.6000    1.0000    0.7500         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.2000    0.1429    0.1667         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1000    0.3333    0.1538         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0909    0.1667    0.1176         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.8333    1.0000    0.9091         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.0000    0.0000       nan         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.5714    0.6667    0.6154         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.5000    0.2500    0.3333         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2222    0.2857    0.2500         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.5051    0.5051    0.5051       681
                                    macro avg     0.5837    0.5094    0.6531       681
                                 weighted avg     0.6076    0.5051    0.6262       681

2024-08-16 14:16:43.417 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.5051
2024-08-16 14:16:43.427 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:16:43.427 | INFO     | __main__:eval:454 - Validation loss: 9.530396006324075
2024-08-16 14:16:43.432 | INFO     | __main__:train:256 - epochs: 25
2024-08-16 14:16:43.432 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938]
2024-08-16 14:16:43.432 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075]
2024-08-16 14:16:43.432 | INFO     | __main__:train:159 - ====epoch #26====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.54s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.46s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:56<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.39s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 14:21:32.600 | INFO     | __main__:train:207 - Epoch 26 Average Loss: 7.80890
2024-08-16 14:21:33.293 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL26*****
2024-08-16 14:21:33.294 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:21:33.294 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.19it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.23it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 14:21:50.510 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.2500    0.3333    0.2857         6
              AlbertForSequenceClassification     0.6250    0.7143    0.6667         7
                 AlbertForTokenClassification     0.1429    0.2500    0.1818         4
                                  AlbertModel     0.5000    0.3750    0.4286         8
                 BartForConditionalGeneration     0.2500    0.3333    0.2857         3
                     BartForQuestionAnswering     0.2857    0.6667    0.4000         3
                BartForSequenceClassification     0.7500    0.4286    0.5455         7
                                    BartModel     1.0000    0.2500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.4286    0.4286    0.4286         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.0667    0.1250    0.0870         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.2143    0.6000    0.3158         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.6000    0.9000    0.7200        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.3333    1.0000    0.5000         1
                  BigBirdForQuestionAnswering     0.0000    0.0000       nan         7
             BigBirdForSequenceClassification     0.6667    0.5000    0.5714         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1176    0.2500    0.1600         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.5714    0.6154         7
                           DPRQuestionEncoder     0.3333    0.2500    0.2857         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.3333    0.5000    0.4000         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.1250    0.2000    0.1538         5
                               DebertaV2Model     0.1667    0.5000    0.2500         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3571    1.0000    0.5263         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.3333    0.3333         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel     0.5000    0.1250    0.2000         8
                                   DprEncoder     0.0870    0.5000    0.1481         4
                           ElectraForMaskedLM     0.1000    0.2500    0.1429         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.3750    0.4286    0.4000         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.5714    0.5000    0.5333         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     0.5000    0.3333    0.4000         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1250    0.5000    0.2000         2
               LongformerForQuestionAnswering     0.2500    0.2000    0.2222         5
          LongformerForSequenceClassification     0.5000    0.3333    0.4000         3
             LongformerForTokenClassification     0.5000    0.2000    0.2857         5
                              LongformerModel     0.7500    0.3750    0.5000         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.5455    1.0000    0.7059         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1667    0.2000    0.1818         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.1429    0.1429    0.1429         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.1176    0.3333    0.1739         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.4545    1.0000    0.6250         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.6667    1.0000    0.8000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.5714    0.6667    0.6154         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.4000    0.3333    0.3636         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.5000    0.2500    0.3333         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2500    0.2857    0.2667         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.5051    0.5051    0.5051       681
                                    macro avg     0.5646    0.5231    0.6470       681
                                 weighted avg     0.5712    0.5051    0.6217       681

2024-08-16 14:21:50.510 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.5051
2024-08-16 14:21:50.517 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:21:50.517 | INFO     | __main__:eval:454 - Validation loss: 9.540740489959717
2024-08-16 14:21:50.522 | INFO     | __main__:train:256 - epochs: 26
2024-08-16 14:21:50.522 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938, 7.808897540148567]
2024-08-16 14:21:50.522 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075, 9.540740489959717]
2024-08-16 14:21:50.522 | INFO     | __main__:train:159 - ====epoch #27====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.56s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.40s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:58<03:54,  3.45s/it]
Training:  21%|██        | 18/85 [01:01<03:50,  3.44s/it]
Training:  22%|██▏       | 19/85 [01:04<03:46,  3.43s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.42s/it]
Training:  25%|██▍       | 21/85 [01:11<03:38,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:15<03:34,  3.41s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.41s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.40s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.40s/it]
Training:  41%|████      | 35/85 [01:59<02:49,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:24,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 14:26:39.795 | INFO     | __main__:train:207 - Epoch 27 Average Loss: 7.61540
2024-08-16 14:26:40.494 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL27*****
2024-08-16 14:26:40.494 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:26:40.494 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 14:26:57.714 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.4167    0.8333    0.5556         6
              AlbertForSequenceClassification     0.6250    0.7143    0.6667         7
                 AlbertForTokenClassification     0.0000    0.0000       nan         4
                                  AlbertModel     0.2500    0.1250    0.1667         8
                 BartForConditionalGeneration     0.0000    0.0000       nan         3
                     BartForQuestionAnswering     0.2222    0.6667    0.3333         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     1.0000    0.2500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.5000    0.4286    0.4615         7
                              BertForMaskedLM     0.5000    0.2500    0.3333         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1579    0.3750    0.2222         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.2308    0.6000    0.3333         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.5625    0.9000    0.6923        10
                              BertLMHeadModel     0.0000    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.2000    1.0000    0.3333         1
                  BigBirdForQuestionAnswering     0.0000    0.0000       nan         7
             BigBirdForSequenceClassification        nan    0.0000       nan         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM        nan    0.0000       nan         8
           CamembertForSequenceClassification     0.1250    0.2500    0.1667         8
              CamembertForTokenClassification        nan    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6667    0.5714    0.6154         7
                           DPRQuestionEncoder     0.3333    0.2500    0.2857         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.0000    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.5000    0.1429    0.2222         7
           DebertaV2ForSequenceClassification     0.6667    1.0000    0.8000         4
              DebertaV2ForTokenClassification     0.1250    0.2000    0.1538         5
                               DebertaV2Model     0.2000    0.5000    0.2857         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2500    0.4000    0.3077         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.3333    0.3333         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel     0.2500    0.2500    0.2500         8
                                   DprEncoder     0.0556    0.2500    0.0909         4
                           ElectraForMaskedLM     0.1818    0.5000    0.2667         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5000    0.8571    0.6316         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.6667    0.5000    0.5714         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     0.5000    0.3333    0.4000         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1250    0.5000    0.2000         2
               LongformerForQuestionAnswering     0.2000    0.2000    0.2000         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification     0.0000    0.0000       nan         5
                              LongformerModel     0.6667    0.5000    0.5714         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM        nan    0.0000       nan         4
               MPNetForSequenceClassification     0.5455    1.0000    0.7059         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2500    0.4000    0.3077         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.1667    0.1429    0.1538         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0952    0.3333    0.1481         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.1667    0.1667    0.1667         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.5000    1.0000    0.6667         5
                                 RobertaModel     1.0000    0.1667    0.2857         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.5714    0.6667    0.6154         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM        nan    0.0000       nan         8
               XLMRobertaForQuestionAnswering     0.4000    0.6667    0.5000         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2222    0.2857    0.2500         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.5066    0.5066    0.5066       681
                                    macro avg     0.5644    0.5141    0.6538       681
                                 weighted avg     0.5814    0.5066    0.6260       681

2024-08-16 14:26:57.714 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.5066
2024-08-16 14:26:57.718 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:26:57.719 | INFO     | __main__:eval:454 - Validation loss: 9.434979590502651
2024-08-16 14:26:57.723 | INFO     | __main__:train:256 - epochs: 27
2024-08-16 14:26:57.724 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938, 7.808897540148567, 7.615400387259091]
2024-08-16 14:26:57.724 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075, 9.540740489959717, 9.434979590502651]
2024-08-16 14:26:57.724 | INFO     | __main__:train:159 - ====epoch #28====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:59,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.48s/it]
Training:   4%|▎         | 3/85 [00:10<04:43,  3.46s/it]
Training:   5%|▍         | 4/85 [00:13<04:38,  3.44s/it]
Training:   6%|▌         | 5/85 [00:17<04:34,  3.43s/it]
Training:   7%|▋         | 6/85 [00:20<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.42s/it]
Training:  11%|█         | 9/85 [00:30<04:19,  3.41s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:12,  3.41s/it]
Training:  14%|█▍        | 12/85 [00:41<04:08,  3.41s/it]
Training:  15%|█▌        | 13/85 [00:44<04:05,  3.41s/it]
Training:  16%|█▋        | 14/85 [00:47<04:02,  3.41s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.41s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.41s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.42s/it]
Training:  22%|██▏       | 19/85 [01:04<03:45,  3.41s/it]
Training:  24%|██▎       | 20/85 [01:08<03:41,  3.41s/it]
Training:  25%|██▍       | 21/85 [01:11<03:38,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:15<03:35,  3.41s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.42s/it]
Training:  28%|██▊       | 24/85 [01:22<03:28,  3.41s/it]
Training:  29%|██▉       | 25/85 [01:25<03:24,  3.41s/it]
Training:  31%|███       | 26/85 [01:28<03:21,  3.41s/it]
Training:  32%|███▏      | 27/85 [01:32<03:17,  3.41s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.41s/it]
Training:  34%|███▍      | 29/85 [01:39<03:10,  3.41s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.41s/it]
Training:  36%|███▋      | 31/85 [01:45<03:04,  3.41s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.41s/it]
Training:  39%|███▉      | 33/85 [01:52<02:57,  3.41s/it]
Training:  40%|████      | 34/85 [01:56<02:53,  3.41s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.41s/it]
Training:  42%|████▏     | 36/85 [02:02<02:47,  3.41s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.41s/it]
Training:  45%|████▍     | 38/85 [02:09<02:40,  3.41s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.41s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.41s/it]
Training:  48%|████▊     | 41/85 [02:20<02:30,  3.41s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.41s/it]
Training:  51%|█████     | 43/85 [02:26<02:23,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.41s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.41s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:12,  3.41s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.41s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:06,  3.41s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:02,  3.41s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:59,  3.41s/it]
Training:  60%|██████    | 51/85 [02:54<01:55,  3.41s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.41s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:49,  3.41s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:45,  3.41s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.41s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:38,  3.41s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.41s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:32,  3.41s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.41s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.41s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:21,  3.41s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.41s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:15,  3.41s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.42s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:04,  3.42s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.42s/it]
Training:  80%|████████  | 68/85 [03:52<00:58,  3.41s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.41s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.41s/it]
Training:  84%|████████▎ | 71/85 [04:02<00:47,  3.41s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.41s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:40,  3.41s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.41s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.41s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:30,  3.41s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.41s/it]
Training:  92%|█████████▏| 78/85 [04:26<00:23,  3.41s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.41s/it]
Training:  94%|█████████▍| 80/85 [04:33<00:17,  3.41s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.41s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.41s/it]
Training:  98%|█████████▊| 83/85 [04:43<00:06,  3.41s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.41s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.42s/it]
Training: 100%|██████████| 85/85 [04:50<00:00,  3.41s/it]
2024-08-16 14:31:47.906 | INFO     | __main__:train:207 - Epoch 28 Average Loss: 7.59503
2024-08-16 14:31:48.614 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL28*****
2024-08-16 14:31:48.614 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:31:48.614 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.28it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.28it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.28it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 14:32:05.367 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.0000    0.0000       nan         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.1667    0.5000    0.2500         4
                                  AlbertModel     0.6000    0.3750    0.4615         8
                 BartForConditionalGeneration     0.0000    0.0000       nan         3
                     BartForQuestionAnswering     0.1818    0.6667    0.2857         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     1.0000    0.2500    0.4000         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.2500    0.2857    0.2667         7
                              BertForMaskedLM     0.2857    0.2500    0.2667         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.2353    0.5000    0.3200         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.2500    0.2000    0.2222         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.6000    0.9000    0.7200        10
                              BertLMHeadModel     0.0000    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.5000    1.0000    0.6667         1
                  BigBirdForQuestionAnswering     0.3333    0.1429    0.2000         7
             BigBirdForSequenceClassification     0.5000    0.2500    0.3333         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification     0.1538    0.2500    0.1905         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.6250    0.7143    0.6667         7
                           DPRQuestionEncoder     0.0000    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.5000    0.5000    0.5000         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.1667    0.2000    0.1818         5
                               DebertaV2Model     0.1667    0.5000    0.2500         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.5000    0.2000    0.2857         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel     0.3846    0.6250    0.4762         8
                                   DprEncoder     0.0833    0.2500    0.1250         4
                           ElectraForMaskedLM     0.1000    0.2500    0.1429         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering     0.0000    0.0000       nan         7
             ElectraForSequenceClassification     0.6667    0.5714    0.6154         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.4000    0.5000    0.4444         8
                               EsmForMaskedLM     0.0000    0.0000       nan         1
                 EsmForSequenceClassification     1.0000    0.3333    0.5000         3
                    EsmForTokenClassification     0.6000    1.0000    0.7500         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     0.8333    1.0000    0.9091         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1667    0.5000    0.2500         2
               LongformerForQuestionAnswering     0.4286    0.6000    0.5000         5
          LongformerForSequenceClassification        nan    0.0000       nan         3
             LongformerForTokenClassification     1.0000    0.2000    0.3333         5
                              LongformerModel     0.6667    0.5000    0.5714         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     0.6667    0.5000    0.5714         4
               MPNetForSequenceClassification     0.5556    0.8333    0.6667         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.2000    0.2000    0.2000         5
                           RobertaForCausalLM     0.0000    0.0000       nan         3
                           RobertaForMaskedLM     0.2222    0.2857    0.2500         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0769    0.1667    0.1053         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.1429    0.3333    0.2000         6
                RobertaForTokenClassification     0.0000    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.6667    0.8000    0.7273         5
                                 RobertaModel     1.0000    0.3333    0.5000         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     1.0000    0.5000    0.6667         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.5714    0.6667    0.6154         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2222    0.2857    0.2500         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.5110    0.5110    0.5110       681
                                    macro avg     0.5592    0.5143    0.6549       681
                                 weighted avg     0.5679    0.5110    0.6279       681

2024-08-16 14:32:05.367 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.511
2024-08-16 14:32:05.370 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:32:05.370 | INFO     | __main__:eval:454 - Validation loss: 9.448795383626765
2024-08-16 14:32:05.377 | INFO     | __main__:train:256 - epochs: 28
2024-08-16 14:32:05.378 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938, 7.808897540148567, 7.615400387259091, 7.5950291016522575]
2024-08-16 14:32:05.378 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075, 9.540740489959717, 9.434979590502651, 9.448795383626765]
2024-08-16 14:32:05.378 | INFO     | __main__:train:159 - ====epoch #29====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:04,  3.62s/it]
Training:   2%|▏         | 2/85 [00:07<04:51,  3.52s/it]
Training:   4%|▎         | 3/85 [00:10<04:45,  3.48s/it]
Training:   5%|▍         | 4/85 [00:13<04:39,  3.46s/it]
Training:   6%|▌         | 5/85 [00:17<04:35,  3.44s/it]
Training:   7%|▋         | 6/85 [00:20<04:31,  3.44s/it]
Training:   8%|▊         | 7/85 [00:24<04:27,  3.43s/it]
Training:   9%|▉         | 8/85 [00:27<04:23,  3.43s/it]
Training:  11%|█         | 9/85 [00:31<04:20,  3.43s/it]
Training:  12%|█▏        | 10/85 [00:34<04:16,  3.42s/it]
Training:  13%|█▎        | 11/85 [00:37<04:13,  3.42s/it]
Training:  14%|█▍        | 12/85 [00:41<04:09,  3.42s/it]
Training:  15%|█▌        | 13/85 [00:44<04:06,  3.42s/it]
Training:  16%|█▋        | 14/85 [00:48<04:02,  3.42s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.41s/it]
Training:  19%|█▉        | 16/85 [00:54<03:55,  3.41s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.42s/it]
Training:  21%|██        | 18/85 [01:01<03:48,  3.42s/it]
Training:  22%|██▏       | 19/85 [01:05<03:45,  3.42s/it]
Training:  24%|██▎       | 20/85 [01:08<03:42,  3.42s/it]
Training:  25%|██▍       | 21/85 [01:12<03:38,  3.42s/it]
Training:  26%|██▌       | 22/85 [01:15<03:35,  3.42s/it]
Training:  27%|██▋       | 23/85 [01:18<03:32,  3.42s/it]
Training:  28%|██▊       | 24/85 [01:22<03:28,  3.42s/it]
Training:  29%|██▉       | 25/85 [01:25<03:25,  3.42s/it]
Training:  31%|███       | 26/85 [01:29<03:21,  3.42s/it]
Training:  32%|███▏      | 27/85 [01:32<03:18,  3.42s/it]
Training:  33%|███▎      | 28/85 [01:35<03:14,  3.42s/it]
Training:  34%|███▍      | 29/85 [01:39<03:10,  3.41s/it]
Training:  35%|███▌      | 30/85 [01:42<03:07,  3.41s/it]
Training:  36%|███▋      | 31/85 [01:46<03:04,  3.41s/it]
Training:  38%|███▊      | 32/85 [01:49<03:00,  3.41s/it]
Training:  39%|███▉      | 33/85 [01:53<02:57,  3.41s/it]
Training:  40%|████      | 34/85 [01:56<02:53,  3.41s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.40s/it]
Training:  42%|████▏     | 36/85 [02:03<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:10<02:40,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:13<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:33,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:20<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:27<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:30<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:37<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:44<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:47<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:54<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.40s/it]
Training:  62%|██████▏   | 53/85 [03:01<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:04<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:42,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:11<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:18<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:21<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:28<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:35<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:38<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:45<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:52<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:55<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:51,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:02<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:09<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:12<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:34,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:19<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:26<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:29<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:36<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:43<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:46<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.41s/it]
2024-08-16 14:36:55.263 | INFO     | __main__:train:207 - Epoch 29 Average Loss: 7.78487
2024-08-16 14:36:55.957 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL29*****
2024-08-16 14:36:55.957 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:36:55.957 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.05it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.24it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 14:37:13.165 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.2000    0.1667    0.1818         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.2000    0.5000    0.2857         4
                                  AlbertModel     0.6000    0.3750    0.4615         8
                 BartForConditionalGeneration        nan    0.0000       nan         3
                     BartForQuestionAnswering     0.2727    1.0000    0.4286         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.6667    0.5000    0.5714         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM     0.2500    0.1250    0.1667         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1579    0.3750    0.2222         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.5000    0.2000    0.2857         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.6000    0.9000    0.7200        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.5000    1.0000    0.6667         1
                  BigBirdForQuestionAnswering     0.3333    0.1429    0.2000         7
             BigBirdForSequenceClassification     0.5000    0.2500    0.3333         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification     0.0000    0.0000       nan         8
              CamembertForTokenClassification     0.2000    0.1667    0.1818         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.7500    0.4286    0.5455         7
                           DPRQuestionEncoder     0.4000    0.5000    0.4444         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice        nan    0.0000       nan         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     0.6667    1.0000    0.8000         4
              DebertaV2ForTokenClassification     0.2500    0.2000    0.2222         5
                               DebertaV2Model     0.1429    0.5000    0.2222         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.3571    1.0000    0.5263         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.3333    0.3333    0.3333         3
               DistilBertForQuestionAnswering        nan    0.0000       nan         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.2500    0.1667    0.2000         6
                              DistilBertModel     0.5000    0.1250    0.2000         8
                                   DprEncoder     0.0435    0.2500    0.0741         4
                           ElectraForMaskedLM     0.1538    0.5000    0.2353         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5455    0.8571    0.6667         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.4000    0.2500    0.3077         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     1.0000    0.3333    0.5000         3
                    EsmForTokenClassification     0.7500    1.0000    0.8571         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    1.0000    1.0000         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel        nan    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1667    0.5000    0.2500         2
               LongformerForQuestionAnswering     0.3333    0.4000    0.3636         5
          LongformerForSequenceClassification     0.6667    0.6667    0.6667         3
             LongformerForTokenClassification     0.5000    0.2000    0.2857         5
                              LongformerModel     1.0000    0.3750    0.5455         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     1.0000    0.7500    0.8571         4
               MPNetForSequenceClassification     0.6667    1.0000    0.8000         6
                                   MPNetModel     1.0000    0.7143    0.8333         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1429    0.2000    0.1667         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.0000    0.0000       nan         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0455    0.1667    0.0714         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification        nan    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.7500    0.6000    0.6667         5
                                 RobertaModel     1.0000    0.3333    0.5000         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     0.5000    0.5000    0.5000         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.6000    0.5000    0.5455         6
                              UniSpeechForCTC     1.0000    0.2500    0.4000         4
                           UniSpeechSatForCTC     0.2000    0.5000    0.2857         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.5000    0.2500    0.3333         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification        nan    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.1818    0.2857    0.2222         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.5066    0.5066    0.5066       681
                                    macro avg     0.5848    0.5243    0.6571       681
                                 weighted avg     0.5889    0.5066    0.6275       681

2024-08-16 14:37:13.166 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.5066
2024-08-16 14:37:13.201 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:37:13.201 | INFO     | __main__:eval:454 - Validation loss: 9.478867574171586
2024-08-16 14:37:13.205 | INFO     | __main__:train:256 - epochs: 29
2024-08-16 14:37:13.205 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938, 7.808897540148567, 7.615400387259091, 7.5950291016522575, 7.784871303333956]
2024-08-16 14:37:13.205 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075, 9.540740489959717, 9.434979590502651, 9.448795383626765, 9.478867574171586]
2024-08-16 14:37:13.205 | INFO     | __main__:train:159 - ====epoch #30====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:00,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:33,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.41s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.40s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.40s/it]
Training:  18%|█▊        | 15/85 [00:51<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:23,  3.40s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.40s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:42<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:49<03:02,  3.44s/it]
Training:  39%|███▉      | 33/85 [01:52<02:58,  3.43s/it]
Training:  40%|████      | 34/85 [01:55<02:54,  3.42s/it]
Training:  41%|████      | 35/85 [01:59<02:50,  3.41s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:06<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.40s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:16<02:32,  3.40s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:23<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:26<02:22,  3.40s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:33<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:40<02:09,  3.40s/it]
Training:  56%|█████▋    | 48/85 [02:43<02:05,  3.40s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:50<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.39s/it]
Training:  61%|██████    | 52/85 [02:57<01:52,  3.39s/it]
Training:  62%|██████▏   | 53/85 [03:00<01:48,  3.40s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:45,  3.40s/it]
Training:  65%|██████▍   | 55/85 [03:07<01:41,  3.40s/it]
Training:  66%|██████▌   | 56/85 [03:10<01:38,  3.40s/it]
Training:  67%|██████▋   | 57/85 [03:14<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:17<01:31,  3.40s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:28,  3.40s/it]
Training:  71%|███████   | 60/85 [03:24<01:25,  3.40s/it]
Training:  72%|███████▏  | 61/85 [03:27<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:31<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:34<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.40s/it]
Training:  76%|███████▋  | 65/85 [03:41<01:07,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:44<01:04,  3.40s/it]
Training:  79%|███████▉  | 67/85 [03:48<01:01,  3.40s/it]
Training:  80%|████████  | 68/85 [03:51<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:54<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:58<00:50,  3.40s/it]
Training:  84%|████████▎ | 71/85 [04:01<00:47,  3.40s/it]
Training:  85%|████████▍ | 72/85 [04:05<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:08<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:11<00:37,  3.40s/it]
Training:  88%|████████▊ | 75/85 [04:15<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:18<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:22<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:25<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:28<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:32<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:35<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:39<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:42<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:45<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:49<00:00,  3.40s/it]
2024-08-16 14:42:02.504 | INFO     | __main__:train:207 - Epoch 30 Average Loss: 7.75750
2024-08-16 14:42:03.205 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL30*****
2024-08-16 14:42:03.205 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:42:03.205 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.19it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.24it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:04,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.25it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.25it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 14:42:20.453 | INFO     | __main__:eval:422 - Classification Report for arch
                                               precision    recall  f1-score   support

                    ASTForAudioClassification     1.0000    1.0000    1.0000         5
                            AlbertForMaskedLM     1.0000    0.5000    0.6667         8
                   AlbertForQuestionAnswering     0.4000    0.6667    0.5000         6
              AlbertForSequenceClassification     0.5556    0.7143    0.6250         7
                 AlbertForTokenClassification     0.1429    0.2500    0.1818         4
                                  AlbertModel     0.3333    0.1250    0.1818         8
                 BartForConditionalGeneration     0.2500    0.3333    0.2857         3
                     BartForQuestionAnswering     0.2000    0.3333    0.2500         3
                BartForSequenceClassification     1.0000    0.4286    0.6000         7
                                    BartModel     0.4000    0.5000    0.4444         4
                   BeitForImageClassification     1.0000    0.6667    0.8000         6
                                    BertForCL     0.3333    0.2857    0.3077         7
                              BertForMaskedLM     0.0000    0.0000       nan         8
      BertForMultiLabelSequenceClassification        nan    0.0000       nan         4
                        BertForMultipleChoice     0.1765    0.3750    0.2400         8
                BertForNextSentencePrediction     0.0000    0.0000       nan         2
       BertForNonlinearSequenceClassification        nan    0.0000       nan         2
                           BertForPreTraining     0.5000    0.2500    0.3333         8
                     BertForQuestionAnswering     0.2000    0.4000    0.2667         5
                BertForSequenceClassification     0.0000    0.0000       nan         4
                   BertForTokenClassification     0.0000    0.0000       nan         3
                   BertForV2QuestionAnswering     0.6000    0.9000    0.7200        10
                              BertLMHeadModel        nan    0.0000       nan         3
                                    BertModel     0.0000    0.0000       nan         4
                           BigBirdForMaskedLM     0.2000    1.0000    0.3333         1
                  BigBirdForQuestionAnswering        nan    0.0000       nan         7
             BigBirdForSequenceClassification     1.0000    0.5000    0.6667         4
       BigBirdPegasusForConditionalGeneration     1.0000    1.0000    1.0000         8
           BlenderbotForConditionalGeneration     1.0000    1.0000    1.0000         5
                                    CLIPModel     1.0000    1.0000    1.0000         4
                              CTRLLMHeadModel     1.0000    1.0000    1.0000         1
                         CamembertForMaskedLM     0.0000    0.0000       nan         8
           CamembertForSequenceClassification     0.0000    0.0000       nan         8
              CamembertForTokenClassification     0.0000    0.0000       nan         6
                               CamembertModel     0.0000    0.0000       nan         3
                 CanineForTokenClassification     1.0000    1.0000    1.0000         2
                           CodeGenForCausalLM     1.0000    1.0000    1.0000         4
               ConvNextForImageClassification     1.0000    1.0000    1.0000         7
             ConvNextV2ForImageClassification     1.0000    1.0000    1.0000         2
                            DPRContextEncoder     0.5714    0.5714    0.5714         7
                           DPRQuestionEncoder     0.0000    0.0000       nan         4
                           DebertaForMaskedLM        nan    0.0000       nan         2
                  DebertaForQuestionAnswering     0.3750    0.6000    0.4615         5
             DebertaForSequenceClassification     0.5000    0.3333    0.4000         6
                DebertaForTokenClassification     0.0000    0.0000       nan         3
                         DebertaV2ForMaskedLM     0.0000    0.0000       nan         5
                   DebertaV2ForMultipleChoice     0.5000    0.5000    0.5000         2
                DebertaV2ForQuestionAnswering     0.0000    0.0000       nan         7
           DebertaV2ForSequenceClassification     1.0000    1.0000    1.0000         4
              DebertaV2ForTokenClassification     0.2500    0.2000    0.2222         5
                               DebertaV2Model     0.1250    0.5000    0.2000         2
                       DetrForObjectDetection     1.0000    1.0000    1.0000         3
                        DistilBertForMaskedLM     0.2500    0.4000    0.3077         5
DistilBertForMultilabelSequenceClassification        nan    0.0000       nan         3
                  DistilBertForMultipleChoice     0.2500    0.3333    0.2857         3
               DistilBertForQuestionAnswering     1.0000    0.2000    0.3333         5
          DistilBertForSequenceClassification     0.2727    0.6000    0.3750         5
             DistilBertForTokenClassification     0.0000    0.0000       nan         6
                              DistilBertModel     0.2500    0.2500    0.2500         8
                                   DprEncoder     0.0455    0.2500    0.0769         4
                           ElectraForMaskedLM     0.1111    0.2500    0.1538         4
                        ElectraForPreTraining     0.0000    0.0000       nan         2
                  ElectraForQuestionAnswering        nan    0.0000       nan         7
             ElectraForSequenceClassification     0.5714    0.5714    0.5714         7
                ElectraForTokenClassification     0.0000    0.0000       nan         3
                                 ElectraModel     0.4444    0.5000    0.4706         8
                               EsmForMaskedLM     0.5000    1.0000    0.6667         1
                 EsmForSequenceClassification     0.5000    0.3333    0.4000         3
                    EsmForTokenClassification     0.6667    0.6667    0.6667         3
                FNetForSequenceClassification     1.0000    1.0000    1.0000         2
                       GLPNForDepthEstimation     1.0000    1.0000    1.0000         1
                              GPT2LMHeadModel     0.5000    1.0000    0.6667         1
                        GPTBigCodeForCausalLM        nan    0.0000       nan         1
                              GPTJForCausalLM     1.0000    0.6667    0.8000         6
                            GPTNeoForCausalLM     0.6000    1.0000    0.7500         3
                                  GPTNeoModel        nan       nan       nan         0
                           GPTNeoXForCausalLM     1.0000    1.0000    1.0000         2
                  LEDForConditionalGeneration     0.6250    1.0000    0.7692         5
              LSGBartForConditionalGeneration     1.0000    1.0000    1.0000         5
                LSTMForSequenceClassification     0.3333    1.0000    0.5000         1
               LayoutLMForTokenClassification        nan    0.0000       nan         1
             LayoutLMv3ForTokenClassification     1.0000    1.0000    1.0000         2
                                    LiltModel     0.0000    0.0000       nan         4
                             LlamaForCausalLM     0.0000    0.0000       nan         1
               LlamaForSequenceClassification     0.5000    0.5000    0.5000         2
               LongT5ForConditionalGeneration     1.0000    1.0000    1.0000         3
                        LongformerForMaskedLM     0.1667    0.5000    0.2500         2
               LongformerForQuestionAnswering     0.4000    0.4000    0.4000         5
          LongformerForSequenceClassification     0.5000    0.6667    0.5714         3
             LongformerForTokenClassification     0.5000    0.2000    0.2857         5
                              LongformerModel     1.0000    0.3750    0.5455         8
               M2M100ForConditionalGeneration     1.0000    0.7500    0.8571         4
                MBartForConditionalGeneration     1.0000    1.0000    1.0000         2
                             MPNetForMaskedLM     1.0000    0.5000    0.6667         4
               MPNetForSequenceClassification     0.6667    1.0000    0.8000         6
                                   MPNetModel     0.8333    0.7143    0.7692         7
                               MPTForCausalLM     1.0000    1.0000    1.0000         6
                  MT5ForConditionalGeneration     1.0000    1.0000    1.0000         6
                                MarianMTModel     1.0000    1.0000    1.0000         5
          Mask2FormerForUniversalSegmentation     1.0000    1.0000    1.0000         8
            MaskFormerForInstanceSegmentation     1.0000    1.0000    1.0000         5
          MobileBertForSequenceClassification     1.0000    0.8000    0.8889         5
            MobileNetV2ForImageClassification     1.0000    1.0000    1.0000         4
              MobileViTForImageClassification     1.0000    1.0000    1.0000         1
                                  NNCFNetwork        nan    0.0000       nan         4
                               OPTForCausalLM        nan       nan       nan         0
                 OPTForSequenceClassification     1.0000    1.0000    1.0000         5
               PLBartForConditionalGeneration     1.0000    1.0000    1.0000         6
              PegasusForConditionalGeneration     0.8571    0.8571    0.8571         7
             PegasusXForConditionalGeneration     1.0000    1.0000    1.0000         1
                 RegNetForImageClassification     1.0000    1.0000    1.0000         3
                 ResNetForImageClassification     1.0000    1.0000    1.0000         4
                                 RobertaForCL     0.1667    0.2000    0.1818         5
                           RobertaForCausalLM        nan    0.0000       nan         3
                           RobertaForMaskedLM     0.1250    0.1429    0.1333         7
                     RobertaForMultipleChoice     0.0000    0.0000       nan         4
    RobertaForNonlinearSequenceClassification     0.0588    0.1667    0.0870         6
                  RobertaForQuestionAnswering     0.2000    0.2500    0.2222         4
             RobertaForSequenceClassification     0.0000    0.0000       nan         6
                RobertaForTokenClassification     0.0000    0.0000       nan         6
                RobertaForV2QuestionAnswering     0.6250    1.0000    0.7692         5
                                 RobertaModel     1.0000    0.3333    0.5000         6
                              RwkvForCausalLM     1.0000    1.0000    1.0000         5
                                     SamModel     1.0000    1.0000    1.0000         2
             SegformerForSemanticSegmentation     1.0000    1.0000    1.0000         3
          Speech2TextForConditionalGeneration     1.0000    1.0000    1.0000         4
                      SpeechT5ForTextToSpeech     0.5000    0.5000    0.5000         2
                   SwinForImageClassification     1.0000    1.0000    1.0000         6
                               T5EncoderModel     0.6667    0.5000    0.5714         4
                                      T5Model     0.6000    0.7500    0.6667         4
                            T5WithLMHeadModel     0.5000    0.5000    0.5000         6
                              UniSpeechForCTC     1.0000    0.5000    0.6667         4
                           UniSpeechSatForCTC     0.2500    0.5000    0.3333         2
                    ViTForImageClassification     1.0000    1.0000    1.0000         3
                   VisionTextDualEncoderModel     0.0000    0.0000       nan         1
                               Wav2Vec2ForCTC     0.9091    0.9091    0.9091        11
                           Wav2Vec2ForCTCnCLS     1.0000    1.0000    1.0000         3
                       Wav2Vec2ForPreTraining        nan    0.0000       nan         3
            Wav2Vec2ForSequenceClassification     0.3333    0.3333    0.3333         6
              Wav2Vec2ForSpeechClassification     0.0000    0.0000       nan         5
                                Wav2Vec2Model     0.0000       nan       nan         0
                                  WavLMForCTC     0.2222    1.0000    0.3636         4
               WavLMForSequenceClassification        nan    0.0000       nan         8
              WhisperForConditionalGeneration     1.0000    1.0000    1.0000         8
                              XGLMForCausalLM     1.0000    1.0000    1.0000         4
                        XLMRobertaForMaskedLM     0.6667    0.2500    0.3636         8
               XLMRobertaForQuestionAnswering     0.4286    0.5000    0.4615         6
          XLMRobertaForSequenceClassification     0.0000    0.0000       nan         4
             XLMRobertaForTokenClassification        nan    0.0000       nan         5
                              XLMRobertaModel     0.2500    0.2857    0.2667         7
               XLNetForSequenceClassification     0.6667    0.8571    0.7500         7
                             XLNetLMHeadModel     0.5000    0.2500    0.3333         4
                      YolosForObjectDetection     0.6000    1.0000    0.7500         3

                                    micro avg     0.5022    0.5022    0.5022       681
                                    macro avg     0.5564    0.5196    0.6594       681
                                 weighted avg     0.5618    0.5022    0.6397       681

2024-08-16 14:42:20.453 | INFO     | __main__:eval:423 - Validation Accuracy for arch: 0.5022
2024-08-16 14:42:20.470 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_arch_CLCE_32_5e-05_report_1
2024-08-16 14:42:20.470 | INFO     | __main__:eval:454 - Validation loss: 9.482468843460083
2024-08-16 14:42:20.475 | INFO     | __main__:train:256 - epochs: 30
2024-08-16 14:42:20.475 | INFO     | __main__:train:257 - train_loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938, 7.808897540148567, 7.615400387259091, 7.5950291016522575, 7.784871303333956, 7.757502415600945]
2024-08-16 14:42:20.475 | INFO     | __main__:train:258 - test_loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075, 9.540740489959717, 9.434979590502651, 9.448795383626765, 9.478867574171586, 9.482468843460083]
2024-08-16 14:42:20.475 | INFO     | __main__:train:296 - Train loss: [10.775885727826287, 9.948536407246308, 8.83241247289321, 8.657672775492948, 8.55310661091524, 8.329028028600357, 8.201123383465935, 8.074267858617446, 8.13707104290233, 8.128295718922335, 7.965424436681411, 8.114990918776568, 8.093683276456945, 7.907921886444091, 8.116855918659883, 8.01875925064087, 7.869203101887423, 7.874295296388514, 7.985751926197725, 7.932831466899199, 7.632184595220229, 7.761401013767018, 7.765083498113295, 7.762967266755946, 7.740117561115938, 7.808897540148567, 7.615400387259091, 7.5950291016522575, 7.784871303333956, 7.757502415600945], Test loss: [13.717152335427024, 10.432234027168967, 10.176388263702393, 10.353548396717418, 10.357522184198553, 10.042855046012185, 9.825158032503994, 9.730173501101406, 9.70071250742132, 9.684283646670254, 9.582782875407826, 9.927315191789107, 9.7871939052235, 9.679902987046676, 9.72066965970126, 9.667257222262295, 9.618915341117166, 9.598710840398615, 9.792378468946977, 9.619529117237438, 9.537416371432217, 9.520012075250799, 9.532030539079146, 9.53451202132485, 9.530396006324075, 9.540740489959717, 9.434979590502651, 9.448795383626765, 9.478867574171586, 9.482468843460083]
