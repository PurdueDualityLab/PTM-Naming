/home/kim3118/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:1150: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
2024-08-16 11:36:59.850 | INFO     | __main__:main:747 - tau: 50
2024-08-16 11:36:59.850 | INFO     | __main__:main:758 - Single-label training mode. task
2024-08-16 11:37:02.880 | INFO     | __main__:train:144 - Training with model: longformer, lr: 5e-05, batch_size: 32, epoch: 30, loss_fn:CLCE, lambd:0.3
2024-08-16 11:37:02.880 | INFO     | __main__:train:159 - ====epoch #1====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:04<05:59,  4.28s/it]
Training:   2%|▏         | 2/85 [00:07<05:10,  3.74s/it]
Training:   4%|▎         | 3/85 [00:11<04:52,  3.57s/it]
Training:   5%|▍         | 4/85 [00:14<04:42,  3.49s/it]
Training:   6%|▌         | 5/85 [00:17<04:36,  3.45s/it]
Training:   7%|▋         | 6/85 [00:21<04:30,  3.42s/it]
Training:   8%|▊         | 7/85 [00:24<04:26,  3.41s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.40s/it]
Training:  11%|█         | 9/85 [00:31<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:34<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:41<04:05,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:44<04:01,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:48<03:58,  3.36s/it]
Training:  18%|█▊        | 15/85 [00:51<03:55,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:54<03:51,  3.36s/it]
Training:  20%|██        | 17/85 [00:58<03:52,  3.41s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:08<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:11<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:15<03:31,  3.36s/it]
Training:  27%|██▋       | 23/85 [01:18<03:27,  3.35s/it]
Training:  28%|██▊       | 24/85 [01:21<03:24,  3.36s/it]
Training:  29%|██▉       | 25/85 [01:25<03:20,  3.35s/it]
Training:  31%|███       | 26/85 [01:28<03:17,  3.36s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.36s/it]
Training:  33%|███▎      | 28/85 [01:35<03:11,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:38<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:45<03:01,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:58,  3.37s/it]
Training:  39%|███▉      | 33/85 [01:52<02:54,  3.36s/it]
Training:  40%|████      | 34/85 [01:55<02:51,  3.37s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:02<02:45,  3.37s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:12<02:34,  3.37s/it]
Training:  47%|████▋     | 40/85 [02:15<02:31,  3.37s/it]
Training:  48%|████▊     | 41/85 [02:19<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.37s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:04,  3.37s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.37s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.37s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.37s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.37s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.37s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.37s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.37s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.38s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.38s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.39s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.38s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.38s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.38s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.38s/it]
Training:  81%|████████  | 69/85 [03:53<00:54,  3.38s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.38s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.38s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.38s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.39s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.38s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.39s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:20<00:27,  3.38s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.37s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.38s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.38s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.38s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 11:41:50.507 | INFO     | __main__:train:207 - Epoch 1 Average Loss: 3.98170
2024-08-16 11:41:51.247 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL1*****
2024-08-16 11:41:51.247 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 11:41:51.247 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.02it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.14it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.19it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.21it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.26it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.27it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 11:42:08.340 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6667    0.3810    0.4848        21
  automatic-speech-recognition     0.6053    0.6765    0.6389        34
              depth-estimation        nan    0.0000       nan         1
            feature-extraction        nan    0.0000       nan        42
                     fill-mask     0.2333    0.2333    0.2333        60
          image-classification     0.7000    0.9722    0.8140        36
            image-segmentation     0.6667    0.5000    0.5714        12
               mask-generation        nan    0.0000       nan         2
               multiple-choice        nan    0.0000       nan        17
              object-detection        nan    0.0000       nan         6
                   pretraining        nan    0.0000       nan        17
            question-answering     0.2143    0.0508    0.0822        59
           sentence-similarity     0.5556    0.2941    0.3846        34
                 summarization        nan    0.0000       nan         3
           text-classification     0.3133    0.5417    0.3969        96
               text-generation     0.5147    0.7955    0.6250        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.6471    0.7586    0.6984        58
          token-classification     0.1667    0.2778    0.2083        54
                   translation     0.8000    0.4000    0.5333        10
                       unknown     0.2911    0.3770    0.3286        61
      zero-shot-classification        nan    0.0000       nan         8
zero-shot-image-classification     0.0000    0.0000       nan         4

                      accuracy                         0.3994       681
                     macro avg     0.4553    0.2721    0.4615       681
                  weighted avg     0.4088    0.3994    0.4192       681

2024-08-16 11:42:08.340 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.3994
2024-08-16 11:42:08.342 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 11:42:08.342 | INFO     | __main__:eval:454 - Validation loss: 4.633326801386747
2024-08-16 11:42:08.349 | INFO     | __main__:train:256 - epochs: 1
2024-08-16 11:42:08.349 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376]
2024-08-16 11:42:08.349 | INFO     | __main__:train:258 - test_loss: [4.633326801386747]
2024-08-16 11:42:08.349 | INFO     | __main__:train:159 - ====epoch #2====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.54s/it]
Training:   2%|▏         | 2/85 [00:06<04:46,  3.45s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.41s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:24,  3.39s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.38s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.37s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.37s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.37s/it]
Training:  27%|██▋       | 23/85 [01:17<03:28,  3.37s/it]
Training:  28%|██▊       | 24/85 [01:21<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.37s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:37<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:58,  3.37s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.37s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.37s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:44,  3.36s/it]
Training:  44%|████▎     | 37/85 [02:04<02:41,  3.36s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.36s/it]
Training:  47%|████▋     | 40/85 [02:14<02:31,  3.37s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:21<02:25,  3.37s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.38s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.38s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:08,  3.38s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.36s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.37s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.36s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.36s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.36s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.36s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.36s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:33,  3.35s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.36s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.36s/it]
Training:  71%|███████   | 60/85 [03:22<01:23,  3.34s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:17,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:13,  3.36s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.36s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.36s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.36s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.37s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.37s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.38s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.37s/it]
Training:  91%|█████████ | 77/85 [04:19<00:27,  3.38s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.37s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.36s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.35s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.37s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.38s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.37s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.37s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.36s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
2024-08-16 11:46:54.830 | INFO     | __main__:train:207 - Epoch 2 Average Loss: 3.45822
2024-08-16 11:46:55.545 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL2*****
2024-08-16 11:46:55.545 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 11:46:55.545 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.27it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.25it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 11:47:12.563 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.5862    0.8095    0.6800        21
  automatic-speech-recognition     0.9231    0.7059    0.8000        34
              depth-estimation        nan    0.0000       nan         1
            feature-extraction     0.0000    0.0000       nan        42
                     fill-mask        nan    0.0000       nan        60
          image-classification     0.8140    0.9722    0.8861        36
            image-segmentation     0.6429    0.7500    0.6923        12
               mask-generation        nan    0.0000       nan         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    0.8333    0.9091         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering        nan    0.0000       nan        59
           sentence-similarity     1.0000    0.0294    0.0571        34
                 summarization     0.0000    0.0000       nan         3
           text-classification     0.2621    0.6771    0.3779        96
               text-generation     0.7391    0.7727    0.7556        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.7000    0.7241    0.7119        58
          token-classification     0.2881    0.3148    0.3009        54
                   translation     0.4667    0.7000    0.5600        10
                       unknown     0.2869    0.5738    0.3825        61
      zero-shot-classification        nan    0.0000       nan         8
zero-shot-image-classification     1.0000    0.2500    0.4000         4

                      accuracy                         0.4288       681
                     macro avg     0.5443    0.3527    0.5779       681
                  weighted avg     0.4901    0.4288    0.5248       681

2024-08-16 11:47:12.563 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4288
2024-08-16 11:47:12.575 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 11:47:12.576 | INFO     | __main__:eval:454 - Validation loss: 4.3744566440582275
2024-08-16 11:47:12.584 | INFO     | __main__:train:256 - epochs: 2
2024-08-16 11:47:12.584 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936]
2024-08-16 11:47:12.585 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275]
2024-08-16 11:47:12.585 | INFO     | __main__:train:159 - ====epoch #3====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:39,  3.41s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:16<04:29,  3.37s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:19,  3.38s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.37s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.37s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.37s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.36s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:46,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.37s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.37s/it]
Training:  28%|██▊       | 24/85 [01:21<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.37s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:11,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:37<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.37s/it]
Training:  40%|████      | 34/85 [01:54<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:44,  3.37s/it]
Training:  44%|████▎     | 37/85 [02:04<02:41,  3.37s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:11<02:35,  3.37s/it]
Training:  47%|████▋     | 40/85 [02:14<02:31,  3.37s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:21<02:24,  3.36s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.37s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:08,  3.38s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.38s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.37s/it]
Training:  61%|██████    | 52/85 [02:55<01:51,  3.37s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:41,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.37s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.37s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:31,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.37s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.36s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.36s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.36s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.37s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.38s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.38s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.38s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.38s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.47s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.44s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.42s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.39s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 11:51:59.668 | INFO     | __main__:train:207 - Epoch 3 Average Loss: 3.12343
2024-08-16 11:52:00.379 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL3*****
2024-08-16 11:52:00.380 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 11:52:00.380 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 11:52:17.514 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.4615    0.8571    0.6000        21
  automatic-speech-recognition     0.8636    0.5588    0.6786        34
              depth-estimation        nan    0.0000       nan         1
            feature-extraction        nan    0.0000       nan        42
                     fill-mask     0.2414    0.1167    0.1573        60
          image-classification     0.9118    0.8611    0.8857        36
            image-segmentation     0.6250    0.8333    0.7143        12
               mask-generation        nan    0.0000       nan         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining        nan    0.0000       nan        17
            question-answering     0.3235    0.1864    0.2366        59
           sentence-similarity     0.5385    0.2059    0.2979        34
                 summarization     0.2500    0.6667    0.3636         3
           text-classification     0.3559    0.2188    0.2710        96
               text-generation     0.8421    0.7273    0.7805        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.7656    0.8448    0.8033        58
          token-classification     0.1658    0.6111    0.2609        54
                   translation     1.0000    0.2000    0.3333        10
                       unknown     0.2793    0.5082    0.3605        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.7500    0.7500    0.7500         4

                      accuracy                         0.4170       681
                     macro avg     0.5906    0.4085    0.5210       681
                  weighted avg     0.4966    0.4170    0.4483       681

2024-08-16 11:52:17.514 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.417
2024-08-16 11:52:17.517 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 11:52:17.517 | INFO     | __main__:eval:454 - Validation loss: 4.136557448994029
2024-08-16 11:52:17.523 | INFO     | __main__:train:256 - epochs: 3
2024-08-16 11:52:17.523 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203]
2024-08-16 11:52:17.523 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029]
2024-08-16 11:52:17.523 | INFO     | __main__:train:159 - ====epoch #4====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:56,  3.53s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.42s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.40s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.38s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.38s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.38s/it]
Training:  15%|█▌        | 13/85 [00:44<04:03,  3.38s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.38s/it]
Training:  21%|██        | 18/85 [01:00<03:46,  3.38s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:11<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.36s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:11,  3.36s/it]
Training:  34%|███▍      | 29/85 [01:37<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.38s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.38s/it]
Training:  40%|████      | 34/85 [01:54<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.37s/it]
Training:  44%|████▎     | 37/85 [02:05<02:41,  3.37s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.38s/it]
Training:  46%|████▌     | 39/85 [02:11<02:35,  3.37s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.38s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.38s/it]
Training:  49%|████▉     | 42/85 [02:21<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.38s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:08,  3.37s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:04,  3.38s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.37s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.38s/it]
Training:  61%|██████    | 52/85 [02:55<01:51,  3.37s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:41,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.39s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:31,  3.39s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.38s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.39s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.39s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:11,  3.39s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.39s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:01,  3.39s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.38s/it]
Training:  81%|████████  | 69/85 [03:53<00:54,  3.39s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.39s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.38s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.38s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.38s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.37s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:20<00:27,  3.38s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.38s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.38s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.38s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.38s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.37s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.38s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.37s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.37s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 11:57:04.763 | INFO     | __main__:train:207 - Epoch 4 Average Loss: 3.14440
2024-08-16 11:57:05.470 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL4*****
2024-08-16 11:57:05.471 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 11:57:05.471 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:01<00:21,  1.03s/it]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.13it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.26it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.27it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.27it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.27it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.27it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.28it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.28it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 11:57:22.300 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.5862    0.8095    0.6800        21
  automatic-speech-recognition     0.8750    0.8235    0.8485        34
              depth-estimation        nan    0.0000       nan         1
            feature-extraction     0.0000    0.0000       nan        42
                     fill-mask     0.2917    0.2333    0.2593        60
          image-classification     0.8750    0.9722    0.9211        36
            image-segmentation     0.7143    0.8333    0.7692        12
               mask-generation        nan    0.0000       nan         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.0556    0.1176    0.0755        17
            question-answering     0.2143    0.0508    0.0822        59
           sentence-similarity     1.0000    0.1471    0.2564        34
                 summarization     0.3000    1.0000    0.4615         3
           text-classification     0.4194    0.2708    0.3291        96
               text-generation     0.6964    0.8864    0.7800        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.9074    0.8448    0.8750        58
          token-classification     0.2679    0.2778    0.2727        54
                   translation     0.8571    0.6000    0.7059        10
                       unknown     0.2427    0.8197    0.3745        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    0.2500    0.4000         4

                      accuracy                         0.4567       681
                     macro avg     0.5773    0.4429    0.5253       681
                  weighted avg     0.4929    0.4567    0.4686       681

2024-08-16 11:57:22.301 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4567
2024-08-16 11:57:22.306 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 11:57:22.306 | INFO     | __main__:eval:454 - Validation loss: 4.07809532772411
2024-08-16 11:57:22.315 | INFO     | __main__:train:256 - epochs: 4
2024-08-16 11:57:22.316 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417]
2024-08-16 11:57:22.316 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411]
2024-08-16 11:57:22.316 | INFO     | __main__:train:159 - ====epoch #5====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:54,  3.51s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.43s/it]
Training:   4%|▎         | 3/85 [00:10<04:39,  3.41s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.36s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.36s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.38s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.37s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.37s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.38s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:27<03:19,  3.39s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:58,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.39s/it]
Training:  40%|████      | 34/85 [01:54<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.36s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.38s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.38s/it]
Training:  46%|████▌     | 39/85 [02:11<02:35,  3.38s/it]
Training:  47%|████▋     | 40/85 [02:15<02:31,  3.38s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:21<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.37s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.38s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:10,  3.36s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.36s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:04,  3.37s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.37s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.36s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.36s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.36s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:41,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.37s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.37s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:31,  3.38s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:21,  3.38s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.37s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.37s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.38s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.37s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.37s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.36s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.36s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.36s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.37s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.37s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.37s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.38s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.38s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.38s/it]
2024-08-16 12:02:09.202 | INFO     | __main__:train:207 - Epoch 5 Average Loss: 3.08573
2024-08-16 12:02:09.905 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL5*****
2024-08-16 12:02:09.905 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:02:09.906 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 12:02:27.013 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.4324    0.7619    0.5517        21
  automatic-speech-recognition     0.9048    0.5588    0.6909        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.0000    0.0000       nan        42
                     fill-mask     0.2162    0.1333    0.1649        60
          image-classification     1.0000    0.7222    0.8387        36
            image-segmentation     0.6316    1.0000    0.7742        12
               mask-generation     1.0000    0.5000    0.6667         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     0.7500    1.0000    0.8571         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering     0.2162    0.1356    0.1667        59
           sentence-similarity     0.8750    0.2059    0.3333        34
                 summarization     1.0000    0.3333    0.5000         3
           text-classification     0.4459    0.3438    0.3882        96
               text-generation     0.8919    0.7500    0.8148        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.7089    0.9655    0.8175        58
          token-classification     0.2333    0.7778    0.3590        54
                   translation     1.0000    0.3000    0.4615        10
                       unknown     0.3069    0.5082    0.3827        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.4537       681
                     macro avg     0.6228    0.4890    0.5800       681
                  weighted avg     0.4870    0.4537    0.4792       681

2024-08-16 12:02:27.014 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4537
2024-08-16 12:02:27.016 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:02:27.017 | INFO     | __main__:eval:454 - Validation loss: 3.9312113523483276
2024-08-16 12:02:27.024 | INFO     | __main__:train:256 - epochs: 5
2024-08-16 12:02:27.025 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138]
2024-08-16 12:02:27.025 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276]
2024-08-16 12:02:27.025 | INFO     | __main__:train:159 - ====epoch #6====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:55,  3.52s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.41s/it]
Training:   6%|▌         | 5/85 [00:17<04:30,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:26,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.38s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.38s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.39s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.38s/it]
Training:  15%|█▌        | 13/85 [00:44<04:03,  3.38s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.38s/it]
Training:  18%|█▊        | 15/85 [00:50<03:57,  3.39s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.39s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.39s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.39s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.39s/it]
Training:  24%|██▎       | 20/85 [01:07<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.40s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.39s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.38s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.38s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.38s/it]
Training:  36%|███▋      | 31/85 [01:45<03:02,  3.38s/it]
Training:  38%|███▊      | 32/85 [01:48<02:58,  3.37s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.38s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.39s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.39s/it]
Training:  45%|████▍     | 38/85 [02:08<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.40s/it]
Training:  47%|████▋     | 40/85 [02:15<02:33,  3.41s/it]
Training:  48%|████▊     | 41/85 [02:18<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.41s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.39s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.39s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:01,  3.39s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.38s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:44,  3.38s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.38s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.38s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:34,  3.38s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.38s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.39s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.40s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.39s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:11,  3.39s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.38s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.38s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.37s/it]
Training:  81%|████████  | 69/85 [03:53<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:57<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.38s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.37s/it]
Training:  91%|█████████ | 77/85 [04:20<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.37s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.36s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.35s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.36s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.35s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.36s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.36s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 12:07:14.599 | INFO     | __main__:train:207 - Epoch 6 Average Loss: 2.99096
2024-08-16 12:07:15.323 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL6*****
2024-08-16 12:07:15.323 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:07:15.323 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 12:07:32.438 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.4474    0.8095    0.5763        21
  automatic-speech-recognition     0.9048    0.5588    0.6909        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.3333    0.0238    0.0444        42
                     fill-mask     0.2353    0.0667    0.1039        60
          image-classification     0.9231    1.0000    0.9600        36
            image-segmentation     0.8333    0.8333    0.8333        12
               mask-generation        nan    0.0000       nan         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering     0.2632    0.3390    0.2963        59
           sentence-similarity     0.5000    0.3529    0.4138        34
                 summarization     1.0000    0.3333    0.5000         3
           text-classification     0.2976    0.6354    0.4053        96
               text-generation     0.7292    0.7955    0.7609        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.7971    0.9483    0.8661        58
          token-classification     0.3846    0.0926    0.1493        54
                   translation     1.0000    0.5000    0.6667        10
                       unknown     0.3793    0.5410    0.4459        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    0.7500    0.8571         4

                      accuracy                         0.4787       681
                     macro avg     0.6347    0.4709    0.5755       681
                  weighted avg     0.4911    0.4787    0.4653       681

2024-08-16 12:07:32.438 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4787
2024-08-16 12:07:32.441 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:07:32.441 | INFO     | __main__:eval:454 - Validation loss: 3.9003078070553867
2024-08-16 12:07:32.447 | INFO     | __main__:train:256 - epochs: 6
2024-08-16 12:07:32.448 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844]
2024-08-16 12:07:32.448 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867]
2024-08-16 12:07:32.448 | INFO     | __main__:train:159 - ====epoch #7====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:54,  3.51s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.43s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.42s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.41s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:33<04:14,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:44<04:01,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.36s/it]
Training:  18%|█▊        | 15/85 [00:50<03:54,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:54<03:51,  3.35s/it]
Training:  20%|██        | 17/85 [00:57<03:47,  3.35s/it]
Training:  21%|██        | 18/85 [01:00<03:44,  3.35s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.36s/it]
Training:  26%|██▌       | 22/85 [01:14<03:31,  3.36s/it]
Training:  27%|██▋       | 23/85 [01:17<03:28,  3.36s/it]
Training:  28%|██▊       | 24/85 [01:20<03:25,  3.36s/it]
Training:  29%|██▉       | 25/85 [01:24<03:21,  3.36s/it]
Training:  31%|███       | 26/85 [01:27<03:17,  3.35s/it]
Training:  32%|███▏      | 27/85 [01:31<03:14,  3.35s/it]
Training:  33%|███▎      | 28/85 [01:34<03:10,  3.35s/it]
Training:  34%|███▍      | 29/85 [01:37<03:07,  3.35s/it]
Training:  35%|███▌      | 30/85 [01:41<03:04,  3.35s/it]
Training:  36%|███▋      | 31/85 [01:44<03:00,  3.35s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.35s/it]
Training:  39%|███▉      | 33/85 [01:51<02:54,  3.36s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.36s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.36s/it]
Training:  42%|████▏     | 36/85 [02:01<02:44,  3.36s/it]
Training:  44%|████▎     | 37/85 [02:04<02:41,  3.36s/it]
Training:  45%|████▍     | 38/85 [02:07<02:38,  3.36s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.36s/it]
Training:  47%|████▋     | 40/85 [02:14<02:31,  3.36s/it]
Training:  48%|████▊     | 41/85 [02:18<02:27,  3.36s/it]
Training:  49%|████▉     | 42/85 [02:21<02:27,  3.44s/it]
Training:  51%|█████     | 43/85 [02:24<02:23,  3.41s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.37s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.36s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:00,  3.35s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.35s/it]
Training:  60%|██████    | 51/85 [02:51<01:54,  3.35s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.36s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.36s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:44,  3.36s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.36s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.36s/it]
Training:  67%|██████▋   | 57/85 [03:11<01:34,  3.36s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.36s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.36s/it]
Training:  71%|███████   | 60/85 [03:22<01:23,  3.35s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:17,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:13,  3.35s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.36s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:07,  3.35s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.35s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.36s/it]
Training:  80%|████████  | 68/85 [03:48<00:57,  3.35s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.35s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.35s/it]
Training:  84%|████████▎ | 71/85 [03:58<00:46,  3.35s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.35s/it]
Training:  86%|████████▌ | 73/85 [04:05<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:08<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.36s/it]
Training:  89%|████████▉ | 76/85 [04:15<00:30,  3.35s/it]
Training:  91%|█████████ | 77/85 [04:18<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.35s/it]
Training:  93%|█████████▎| 79/85 [04:25<00:20,  3.35s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.35s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.35s/it]
Training:  96%|█████████▋| 82/85 [04:35<00:10,  3.35s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:42<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.36s/it]
2024-08-16 12:12:18.303 | INFO     | __main__:train:207 - Epoch 7 Average Loss: 3.02794
2024-08-16 12:12:19.013 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL7*****
2024-08-16 12:12:19.014 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:12:19.014 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.24it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.28it/s]
2024-08-16 12:12:36.238 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7143    0.2381    0.3571        21
  automatic-speech-recognition     0.8261    0.5588    0.6667        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     1.0000    0.0476    0.0909        42
                     fill-mask     0.4286    0.1000    0.1622        60
          image-classification     0.9697    0.8889    0.9275        36
            image-segmentation     0.8462    0.9167    0.8800        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     0.7500    1.0000    0.8571         6
                   pretraining     0.0694    0.2941    0.1124        17
            question-answering     0.2632    0.0847    0.1282        59
           sentence-similarity     0.5882    0.2941    0.3922        34
                 summarization     1.0000    0.6667    0.8000         3
           text-classification     0.4706    0.2500    0.3265        96
               text-generation     0.8163    0.9091    0.8602        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8571    0.9310    0.8926        58
          token-classification     0.2171    0.5185    0.3060        54
                   translation     0.8750    0.7000    0.7778        10
                       unknown     0.3043    0.8033    0.4414        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.4611       681
                     macro avg     0.6982    0.5414    0.5877       681
                  weighted avg     0.5774    0.4611    0.4534       681

2024-08-16 12:12:36.239 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4611
2024-08-16 12:12:36.242 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:12:36.242 | INFO     | __main__:eval:454 - Validation loss: 3.9666170423681084
2024-08-16 12:12:36.250 | INFO     | __main__:train:256 - epochs: 7
2024-08-16 12:12:36.251 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873]
2024-08-16 12:12:36.251 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084]
2024-08-16 12:12:36.251 | INFO     | __main__:train:159 - ====epoch #8====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:56,  3.53s/it]
Training:   2%|▏         | 2/85 [00:06<04:46,  3.45s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.42s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.41s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.40s/it]
Training:   7%|▋         | 6/85 [00:20<04:28,  3.40s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.40s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:34<04:14,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.39s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.38s/it]
Training:  15%|█▌        | 13/85 [00:44<04:03,  3.38s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.38s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.39s/it]
Training:  19%|█▉        | 16/85 [00:54<03:53,  3.39s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.38s/it]
Training:  21%|██        | 18/85 [01:01<03:46,  3.39s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.39s/it]
Training:  24%|██▎       | 20/85 [01:07<03:40,  3.39s/it]
Training:  25%|██▍       | 21/85 [01:11<03:36,  3.39s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.39s/it]
Training:  27%|██▋       | 23/85 [01:18<03:29,  3.39s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.38s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:20,  3.39s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.39s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.39s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:06,  3.39s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.39s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.39s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.38s/it]
Training:  42%|████▏     | 36/85 [02:02<02:45,  3.38s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.39s/it]
Training:  45%|████▍     | 38/85 [02:08<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.39s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.39s/it]
Training:  48%|████▊     | 41/85 [02:19<02:28,  3.39s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.39s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:18,  3.39s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.38s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.38s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.39s/it]
Training:  60%|██████    | 51/85 [02:52<01:55,  3.39s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.39s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:44,  3.38s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.39s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.39s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:34,  3.38s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.38s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:28,  3.38s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.39s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:17,  3.38s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.38s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.38s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.38s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.38s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.38s/it]
Training:  81%|████████  | 69/85 [03:53<00:54,  3.38s/it]
Training:  82%|████████▏ | 70/85 [03:57<00:50,  3.38s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.38s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.37s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.37s/it]
Training:  91%|█████████ | 77/85 [04:20<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.36s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.37s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.38s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.37s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.37s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.37s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 12:17:23.948 | INFO     | __main__:train:207 - Epoch 8 Average Loss: 2.93907
2024-08-16 12:17:24.661 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL8*****
2024-08-16 12:17:24.661 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:17:24.661 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 12:17:41.722 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.8333    0.2381    0.3704        21
  automatic-speech-recognition     0.6739    0.9118    0.7750        34
              depth-estimation     0.5000    1.0000    0.6667         1
            feature-extraction     0.4000    0.0952    0.1538        42
                     fill-mask     0.3333    0.1667    0.2222        60
          image-classification     0.9211    0.9722    0.9459        36
            image-segmentation     0.9000    0.7500    0.8182        12
               mask-generation     1.0000    0.5000    0.6667         2
               multiple-choice     0.3333    0.0588    0.1000        17
              object-detection     0.8571    1.0000    0.9231         6
                   pretraining     0.1667    0.0588    0.0870        17
            question-answering     0.3231    0.3559    0.3387        59
           sentence-similarity     0.5333    0.2353    0.3265        34
                 summarization     1.0000    0.3333    0.5000         3
           text-classification     0.4151    0.2292    0.2953        96
               text-generation     0.7358    0.8864    0.8041        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.6829    0.9655    0.8000        58
          token-classification     0.2292    0.6111    0.3333        54
                   translation     1.0000    0.5000    0.6667        10
                       unknown     0.3100    0.5082    0.3851        61
      zero-shot-classification     0.0000    0.0000       nan         8
zero-shot-image-classification     1.0000    0.7500    0.8571         4

                      accuracy                         0.4743       681
                     macro avg     0.5976    0.4838    0.5255       681
                  weighted avg     0.4928    0.4743    0.4513       681

2024-08-16 12:17:41.722 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4743
2024-08-16 12:17:41.725 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:17:41.725 | INFO     | __main__:eval:454 - Validation loss: 4.068221514875239
2024-08-16 12:17:41.730 | INFO     | __main__:train:256 - epochs: 8
2024-08-16 12:17:41.731 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054]
2024-08-16 12:17:41.731 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239]
2024-08-16 12:17:41.731 | INFO     | __main__:train:159 - ====epoch #9====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.54s/it]
Training:   2%|▏         | 2/85 [00:06<04:44,  3.43s/it]
Training:   4%|▎         | 3/85 [00:10<04:38,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.38s/it]
Training:   6%|▌         | 5/85 [00:16<04:29,  3.37s/it]
Training:   7%|▋         | 6/85 [00:20<04:26,  3.37s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:19,  3.37s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.38s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:08,  3.36s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.37s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:53<03:51,  3.36s/it]
Training:  20%|██        | 17/85 [00:57<03:47,  3.35s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.36s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.36s/it]
Training:  24%|██▎       | 20/85 [01:07<03:38,  3.36s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:31,  3.36s/it]
Training:  27%|██▋       | 23/85 [01:17<03:28,  3.36s/it]
Training:  28%|██▊       | 24/85 [01:20<03:25,  3.36s/it]
Training:  29%|██▉       | 25/85 [01:24<03:21,  3.36s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.36s/it]
Training:  32%|███▏      | 27/85 [01:30<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:11,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:37<03:08,  3.36s/it]
Training:  35%|███▌      | 30/85 [01:41<03:04,  3.35s/it]
Training:  36%|███▋      | 31/85 [01:44<03:01,  3.36s/it]
Training:  38%|███▊      | 32/85 [01:47<02:58,  3.36s/it]
Training:  39%|███▉      | 33/85 [01:51<02:54,  3.35s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.36s/it]
Training:  41%|████      | 35/85 [01:57<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.37s/it]
Training:  44%|████▎     | 37/85 [02:04<02:41,  3.37s/it]
Training:  45%|████▍     | 38/85 [02:07<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.37s/it]
Training:  47%|████▋     | 40/85 [02:14<02:31,  3.36s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:21<02:24,  3.36s/it]
Training:  51%|█████     | 43/85 [02:24<02:21,  3.37s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.36s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.36s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:01,  3.36s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.36s/it]
Training:  60%|██████    | 51/85 [02:51<01:54,  3.36s/it]
Training:  61%|██████    | 52/85 [02:55<01:51,  3.37s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.37s/it]
Training:  67%|██████▋   | 57/85 [03:11<01:34,  3.37s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.36s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.36s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.36s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.37s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:04,  3.37s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.37s/it]
Training:  80%|████████  | 68/85 [03:48<00:57,  3.37s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.38s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:05<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.36s/it]
Training:  89%|████████▉ | 76/85 [04:15<00:30,  3.37s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.36s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.36s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.37s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.36s/it]
Training:  99%|█████████▉| 84/85 [04:42<00:03,  3.37s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
2024-08-16 12:22:27.985 | INFO     | __main__:train:207 - Epoch 9 Average Loss: 2.90287
2024-08-16 12:22:28.686 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL9*****
2024-08-16 12:22:28.686 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:22:28.686 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.05it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.25it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.25it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.27it/s]
2024-08-16 12:22:45.981 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.5862    0.8095    0.6800        21
  automatic-speech-recognition     0.9000    0.7941    0.8438        34
              depth-estimation     0.5000    1.0000    0.6667         1
            feature-extraction     0.6000    0.1429    0.2308        42
                     fill-mask     0.2927    0.2000    0.2376        60
          image-classification     1.0000    0.9722    0.9859        36
            image-segmentation     0.7857    0.9167    0.8462        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining        nan    0.0000       nan        17
            question-answering     0.3051    0.3051    0.3051        59
           sentence-similarity     0.4643    0.3824    0.4194        34
                 summarization     0.3750    1.0000    0.5455         3
           text-classification     0.5167    0.3229    0.3974        96
               text-generation     0.9048    0.8636    0.8837        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8704    0.8103    0.8393        58
          token-classification     0.2687    0.3333    0.2975        54
                   translation     0.5833    0.7000    0.6364        10
                       unknown     0.2914    0.8361    0.4322        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5125       681
                     macro avg     0.6455    0.5930    0.6305       681
                  weighted avg     0.5610    0.5125    0.5218       681

2024-08-16 12:22:45.981 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5125
2024-08-16 12:22:46.017 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:22:46.018 | INFO     | __main__:eval:454 - Validation loss: 3.879074226726185
2024-08-16 12:22:46.023 | INFO     | __main__:train:256 - epochs: 9
2024-08-16 12:22:46.023 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654]
2024-08-16 12:22:46.023 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185]
2024-08-16 12:22:46.023 | INFO     | __main__:train:159 - ====epoch #10====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:39,  3.41s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:17<04:30,  3.38s/it]
Training:   7%|▋         | 6/85 [00:20<04:26,  3.37s/it]
Training:   8%|▊         | 7/85 [00:23<04:22,  3.36s/it]
Training:   9%|▉         | 8/85 [00:27<04:19,  3.37s/it]
Training:  11%|█         | 9/85 [00:30<04:15,  3.37s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:08,  3.36s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.36s/it]
Training:  15%|█▌        | 13/85 [00:43<04:01,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.35s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.37s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.36s/it]
Training:  26%|██▌       | 22/85 [01:14<03:31,  3.35s/it]
Training:  27%|██▋       | 23/85 [01:17<03:28,  3.36s/it]
Training:  28%|██▊       | 24/85 [01:20<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:21,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.37s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:37<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:01,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.35s/it]
Training:  39%|███▉      | 33/85 [01:51<02:54,  3.36s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.36s/it]
Training:  41%|████      | 35/85 [01:57<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.37s/it]
Training:  44%|████▎     | 37/85 [02:04<02:41,  3.37s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.36s/it]
Training:  46%|████▌     | 39/85 [02:11<02:38,  3.45s/it]
Training:  47%|████▋     | 40/85 [02:15<02:34,  3.43s/it]
Training:  48%|████▊     | 41/85 [02:18<02:29,  3.41s/it]
Training:  49%|████▉     | 42/85 [02:21<02:25,  3.39s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.36s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.37s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.36s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.36s/it]
Training:  60%|██████    | 51/85 [02:51<01:54,  3.36s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.36s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.36s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.36s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.37s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.37s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.37s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.37s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.36s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.36s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.36s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:36,  3.36s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.36s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.36s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.36s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.37s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.36s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.36s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.37s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.36s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.36s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.36s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
2024-08-16 12:27:32.494 | INFO     | __main__:train:207 - Epoch 10 Average Loss: 2.89146
2024-08-16 12:27:33.220 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL10*****
2024-08-16 12:27:33.220 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:27:33.221 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.27it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.27it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.27it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.27it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.27it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.30it/s]
2024-08-16 12:27:50.151 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.5862    0.8095    0.6800        21
  automatic-speech-recognition     0.9032    0.8235    0.8615        34
              depth-estimation     0.5000    1.0000    0.6667         1
            feature-extraction     0.5217    0.2857    0.3692        42
                     fill-mask     0.2174    0.2500    0.2326        60
          image-classification     0.9722    0.9722    0.9722        36
            image-segmentation     0.7857    0.9167    0.8462        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining        nan    0.0000       nan        17
            question-answering     0.2917    0.4746    0.3613        59
           sentence-similarity     0.4211    0.2353    0.3019        34
                 summarization     1.0000    0.3333    0.5000         3
           text-classification     0.4306    0.3229    0.3690        96
               text-generation     0.9286    0.8864    0.9070        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.7778    0.9655    0.8615        58
          token-classification     0.2255    0.4259    0.2949        54
                   translation     1.0000    0.6000    0.7500        10
                       unknown     0.2549    0.2131    0.2321        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.4963       681
                     macro avg     0.6642    0.5550    0.6229       681
                  weighted avg     0.5256    0.4963    0.5105       681

2024-08-16 12:27:50.152 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4963
2024-08-16 12:27:50.155 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:27:50.155 | INFO     | __main__:eval:454 - Validation loss: 3.916156129403548
2024-08-16 12:27:50.160 | INFO     | __main__:train:256 - epochs: 10
2024-08-16 12:27:50.161 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626]
2024-08-16 12:27:50.161 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548]
2024-08-16 12:27:50.161 | INFO     | __main__:train:159 - ====epoch #11====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:52,  3.48s/it]
Training:   2%|▏         | 2/85 [00:06<04:43,  3.41s/it]
Training:   4%|▎         | 3/85 [00:10<04:38,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:16<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.38s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.38s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.37s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:53,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.38s/it]
Training:  21%|██        | 18/85 [01:00<03:46,  3.38s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:11<03:36,  3.38s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.39s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.38s/it]
Training:  31%|███       | 26/85 [01:27<03:19,  3.39s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.39s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:06,  3.39s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.39s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.39s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.38s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.38s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.35s/it]
Training:  47%|████▋     | 40/85 [02:15<02:31,  3.36s/it]
Training:  48%|████▊     | 41/85 [02:18<02:27,  3.36s/it]
Training:  49%|████▉     | 42/85 [02:21<02:24,  3.36s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.36s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:08,  3.38s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:04,  3.37s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.38s/it]
Training:  61%|██████    | 52/85 [02:55<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:47,  3.37s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:41,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.37s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.37s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.37s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.37s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:20,  3.37s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:04,  3.37s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.38s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.38s/it]
Training:  81%|████████  | 69/85 [03:53<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.37s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.37s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:20<00:27,  3.38s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.38s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.36s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.36s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.36s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
2024-08-16 12:32:37.017 | INFO     | __main__:train:207 - Epoch 11 Average Loss: 2.86670
2024-08-16 12:32:37.728 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL11*****
2024-08-16 12:32:37.728 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:32:37.728 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.19it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.26it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.30it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.69it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.32it/s]
2024-08-16 12:32:54.384 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6364    0.3333    0.4375        21
  automatic-speech-recognition     0.6735    0.9706    0.7952        34
              depth-estimation     0.5000    1.0000    0.6667         1
            feature-extraction     0.6250    0.3571    0.4545        42
                     fill-mask     0.3784    0.2333    0.2887        60
          image-classification     1.0000    0.9167    0.9565        36
            image-segmentation     0.8462    0.9167    0.8800        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     0.7500    1.0000    0.8571         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering     0.2955    0.2203    0.2524        59
           sentence-similarity     0.5714    0.2353    0.3333        34
                 summarization     1.0000    0.3333    0.5000         3
           text-classification     0.5000    0.2708    0.3514        96
               text-generation     0.8200    0.9318    0.8723        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8088    0.9483    0.8730        58
          token-classification     0.2469    0.3704    0.2963        54
                   translation     1.0000    0.5000    0.6667        10
                       unknown     0.2754    0.7541    0.4035        61
      zero-shot-classification     0.6000    0.3750    0.4615         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5051       681
                     macro avg     0.6346    0.5507    0.6118       681
                  weighted avg     0.5398    0.5051    0.5123       681

2024-08-16 12:32:54.384 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5051
2024-08-16 12:32:54.388 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:32:54.388 | INFO     | __main__:eval:454 - Validation loss: 3.808758995749734
2024-08-16 12:32:54.397 | INFO     | __main__:train:256 - epochs: 11
2024-08-16 12:32:54.397 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079]
2024-08-16 12:32:54.397 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734]
2024-08-16 12:32:54.397 | INFO     | __main__:train:159 - ====epoch #12====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.40s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:19,  3.37s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.37s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.37s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:48,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.36s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.37s/it]
Training:  24%|██▎       | 20/85 [01:07<03:38,  3.36s/it]
Training:  25%|██▍       | 21/85 [01:10<03:36,  3.38s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.37s/it]
Training:  27%|██▋       | 23/85 [01:17<03:28,  3.37s/it]
Training:  28%|██▊       | 24/85 [01:21<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.36s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:37<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:04,  3.36s/it]
Training:  36%|███▋      | 31/85 [01:44<03:01,  3.36s/it]
Training:  38%|███▊      | 32/85 [01:47<02:58,  3.37s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.37s/it]
Training:  40%|████      | 34/85 [01:54<02:52,  3.37s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.38s/it]
Training:  44%|████▎     | 37/85 [02:04<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:11<02:35,  3.38s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.38s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.38s/it]
Training:  49%|████▉     | 42/85 [02:21<02:24,  3.37s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.37s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:14,  3.36s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.35s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.36s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:00,  3.35s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.35s/it]
Training:  60%|██████    | 51/85 [02:51<01:53,  3.35s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.35s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.35s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:43,  3.35s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.35s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.35s/it]
Training:  67%|██████▋   | 57/85 [03:11<01:33,  3.35s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.35s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:26,  3.34s/it]
Training:  71%|███████   | 60/85 [03:22<01:23,  3.35s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:17,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:13,  3.35s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.35s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:06,  3.35s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.34s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:48<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.34s/it]
Training:  84%|████████▎ | 71/85 [03:58<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.35s/it]
Training:  86%|████████▌ | 73/85 [04:05<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:08<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.35s/it]
Training:  89%|████████▉ | 76/85 [04:15<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:18<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.35s/it]
Training:  93%|█████████▎| 79/85 [04:25<00:20,  3.34s/it]
Training:  94%|█████████▍| 80/85 [04:28<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.35s/it]
Training:  96%|█████████▋| 82/85 [04:35<00:10,  3.35s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:42<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.36s/it]
2024-08-16 12:37:40.175 | INFO     | __main__:train:207 - Epoch 12 Average Loss: 2.83284
2024-08-16 12:37:40.883 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL12*****
2024-08-16 12:37:40.883 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:37:40.883 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.05it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.27it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.27it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.27it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.27it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.26it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.27it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.27it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.27it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.30it/s]
2024-08-16 12:37:57.851 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6667    0.3810    0.4848        21
  automatic-speech-recognition     0.6600    0.9706    0.7857        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.4103    0.3810    0.3951        42
                     fill-mask     0.4706    0.1333    0.2078        60
          image-classification     1.0000    0.9167    0.9565        36
            image-segmentation     0.8462    0.9167    0.8800        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.0667    0.0588    0.0625        17
              object-detection     0.7500    1.0000    0.8571         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering     0.2000    0.0339    0.0580        59
           sentence-similarity     0.4167    0.2941    0.3448        34
                 summarization     0.3750    1.0000    0.5455         3
           text-classification     0.6286    0.2292    0.3359        96
               text-generation     0.9250    0.8409    0.8810        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.9245    0.8448    0.8829        58
          token-classification     0.2409    0.6111    0.3455        54
                   translation     0.8333    0.5000    0.6250        10
                       unknown     0.2722    0.7541    0.4000        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.4875       681
                     macro avg     0.5979    0.5703    0.5857       681
                  weighted avg     0.5374    0.4875    0.4757       681

2024-08-16 12:37:57.852 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4875
2024-08-16 12:37:57.857 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:37:57.857 | INFO     | __main__:eval:454 - Validation loss: 3.879854126410051
2024-08-16 12:37:57.863 | INFO     | __main__:train:256 - epochs: 12
2024-08-16 12:37:57.863 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932]
2024-08-16 12:37:57.863 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051]
2024-08-16 12:37:57.863 | INFO     | __main__:train:159 - ====epoch #13====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:54,  3.50s/it]
Training:   2%|▏         | 2/85 [00:06<04:43,  3.42s/it]
Training:   4%|▎         | 3/85 [00:10<04:37,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:16<04:30,  3.38s/it]
Training:   7%|▋         | 6/85 [00:20<04:26,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:22,  3.37s/it]
Training:   9%|▉         | 8/85 [00:27<04:18,  3.36s/it]
Training:  11%|█         | 9/85 [00:30<04:15,  3.36s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.36s/it]
Training:  13%|█▎        | 11/85 [00:37<04:08,  3.36s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.36s/it]
Training:  15%|█▌        | 13/85 [00:43<04:01,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:57,  3.35s/it]
Training:  18%|█▊        | 15/85 [00:50<03:54,  3.35s/it]
Training:  19%|█▉        | 16/85 [00:53<03:50,  3.34s/it]
Training:  20%|██        | 17/85 [00:57<03:47,  3.34s/it]
Training:  21%|██        | 18/85 [01:00<03:44,  3.35s/it]
Training:  22%|██▏       | 19/85 [01:03<03:40,  3.34s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.35s/it]
Training:  25%|██▍       | 21/85 [01:10<03:34,  3.35s/it]
Training:  26%|██▌       | 22/85 [01:13<03:30,  3.35s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.35s/it]
Training:  28%|██▊       | 24/85 [01:20<03:24,  3.35s/it]
Training:  29%|██▉       | 25/85 [01:23<03:20,  3.35s/it]
Training:  31%|███       | 26/85 [01:27<03:17,  3.34s/it]
Training:  32%|███▏      | 27/85 [01:30<03:13,  3.34s/it]
Training:  33%|███▎      | 28/85 [01:34<03:10,  3.35s/it]
Training:  34%|███▍      | 29/85 [01:37<03:06,  3.33s/it]
Training:  35%|███▌      | 30/85 [01:40<03:03,  3.34s/it]
Training:  36%|███▋      | 31/85 [01:44<03:00,  3.34s/it]
Training:  38%|███▊      | 32/85 [01:47<02:56,  3.33s/it]
Training:  39%|███▉      | 33/85 [01:50<02:53,  3.33s/it]
Training:  40%|████      | 34/85 [01:54<02:50,  3.34s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.34s/it]
Training:  42%|████▏     | 36/85 [02:00<02:43,  3.33s/it]
Training:  44%|████▎     | 37/85 [02:04<02:39,  3.33s/it]
Training:  45%|████▍     | 38/85 [02:07<02:36,  3.34s/it]
Training:  46%|████▌     | 39/85 [02:10<02:33,  3.34s/it]
Training:  47%|████▋     | 40/85 [02:14<02:30,  3.34s/it]
Training:  48%|████▊     | 41/85 [02:17<02:26,  3.32s/it]
Training:  49%|████▉     | 42/85 [02:20<02:23,  3.33s/it]
Training:  51%|█████     | 43/85 [02:24<02:19,  3.33s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:16,  3.34s/it]
Training:  53%|█████▎    | 45/85 [02:30<02:13,  3.33s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:10,  3.34s/it]
Training:  55%|█████▌    | 47/85 [02:37<02:06,  3.34s/it]
Training:  56%|█████▋    | 48/85 [02:40<02:03,  3.35s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:00,  3.35s/it]
Training:  59%|█████▉    | 50/85 [02:47<01:57,  3.34s/it]
Training:  60%|██████    | 51/85 [02:50<01:53,  3.34s/it]
Training:  61%|██████    | 52/85 [02:54<01:49,  3.33s/it]
Training:  62%|██████▏   | 53/85 [02:57<01:46,  3.33s/it]
Training:  64%|██████▎   | 54/85 [03:00<01:43,  3.33s/it]
Training:  65%|██████▍   | 55/85 [03:04<01:40,  3.34s/it]
Training:  66%|██████▌   | 56/85 [03:07<01:36,  3.34s/it]
Training:  67%|██████▋   | 57/85 [03:10<01:33,  3.34s/it]
Training:  68%|██████▊   | 58/85 [03:14<01:30,  3.34s/it]
Training:  69%|██████▉   | 59/85 [03:17<01:26,  3.34s/it]
Training:  71%|███████   | 60/85 [03:20<01:23,  3.34s/it]
Training:  72%|███████▏  | 61/85 [03:24<01:20,  3.34s/it]
Training:  73%|███████▎  | 62/85 [03:27<01:16,  3.34s/it]
Training:  74%|███████▍  | 63/85 [03:30<01:13,  3.34s/it]
Training:  75%|███████▌  | 64/85 [03:34<01:12,  3.43s/it]
Training:  76%|███████▋  | 65/85 [03:37<01:08,  3.40s/it]
Training:  78%|███████▊  | 66/85 [03:41<01:04,  3.39s/it]
Training:  79%|███████▉  | 67/85 [03:44<01:00,  3.37s/it]
Training:  80%|████████  | 68/85 [03:47<00:57,  3.36s/it]
Training:  81%|████████  | 69/85 [03:51<00:53,  3.35s/it]
Training:  82%|████████▏ | 70/85 [03:54<00:50,  3.35s/it]
Training:  84%|████████▎ | 71/85 [03:57<00:46,  3.35s/it]
Training:  85%|████████▍ | 72/85 [04:01<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:04<00:40,  3.34s/it]
Training:  87%|████████▋ | 74/85 [04:07<00:36,  3.34s/it]
Training:  88%|████████▊ | 75/85 [04:11<00:33,  3.34s/it]
Training:  89%|████████▉ | 76/85 [04:14<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:17<00:26,  3.34s/it]
Training:  92%|█████████▏| 78/85 [04:21<00:23,  3.34s/it]
Training:  93%|█████████▎| 79/85 [04:24<00:20,  3.34s/it]
Training:  94%|█████████▍| 80/85 [04:27<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:31<00:13,  3.34s/it]
Training:  96%|█████████▋| 82/85 [04:34<00:10,  3.33s/it]
Training:  98%|█████████▊| 83/85 [04:37<00:06,  3.33s/it]
Training:  99%|█████████▉| 84/85 [04:41<00:03,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.35s/it]
2024-08-16 12:42:42.472 | INFO     | __main__:train:207 - Epoch 13 Average Loss: 2.79740
2024-08-16 12:42:43.177 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL13*****
2024-08-16 12:42:43.177 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:42:43.178 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.10it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.26it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.27it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.27it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.30it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.69it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 12:42:59.973 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6667    0.3810    0.4848        21
  automatic-speech-recognition     0.6735    0.9706    0.7952        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5385    0.1667    0.2545        42
                     fill-mask     0.2593    0.2333    0.2456        60
          image-classification     1.0000    0.9722    0.9859        36
            image-segmentation     0.8000    1.0000    0.8889        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2174    0.2941    0.2500        17
            question-answering     0.3095    0.2203    0.2574        59
           sentence-similarity     0.7778    0.2059    0.3256        34
                 summarization     0.4286    1.0000    0.6000         3
           text-classification     0.4921    0.3229    0.3899        96
               text-generation     0.8864    0.8864    0.8864        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.9091    0.8621    0.8850        58
          token-classification     0.2177    0.5926    0.3184        54
                   translation     1.0000    0.5000    0.6667        10
                       unknown     0.3696    0.5574    0.4444        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5037       681
                     macro avg     0.6768    0.5833    0.6211       681
                  weighted avg     0.5619    0.5037    0.5072       681

2024-08-16 12:42:59.973 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5037
2024-08-16 12:42:59.976 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:42:59.976 | INFO     | __main__:eval:454 - Validation loss: 3.745134180242365
2024-08-16 12:42:59.985 | INFO     | __main__:train:256 - epochs: 13
2024-08-16 12:42:59.985 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282]
2024-08-16 12:42:59.985 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365]
2024-08-16 12:42:59.985 | INFO     | __main__:train:159 - ====epoch #14====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:08,  3.67s/it]
Training:   2%|▏         | 2/85 [00:07<04:51,  3.51s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.45s/it]
Training:   5%|▍         | 4/85 [00:13<04:37,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:28,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:24,  3.39s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.38s/it]
Training:  12%|█▏        | 10/85 [00:34<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.36s/it]
Training:  15%|█▌        | 13/85 [00:44<04:02,  3.37s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:54<03:51,  3.36s/it]
Training:  20%|██        | 17/85 [00:57<03:48,  3.36s/it]
Training:  21%|██        | 18/85 [01:00<03:44,  3.36s/it]
Training:  22%|██▏       | 19/85 [01:04<03:41,  3.35s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.35s/it]
Training:  25%|██▍       | 21/85 [01:10<03:33,  3.34s/it]
Training:  26%|██▌       | 22/85 [01:14<03:30,  3.34s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.34s/it]
Training:  28%|██▊       | 24/85 [01:20<03:24,  3.35s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.37s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:34<03:11,  3.36s/it]
Training:  34%|███▍      | 29/85 [01:37<03:07,  3.35s/it]
Training:  35%|███▌      | 30/85 [01:41<03:04,  3.36s/it]
Training:  36%|███▋      | 31/85 [01:44<03:00,  3.35s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.35s/it]
Training:  39%|███▉      | 33/85 [01:51<02:53,  3.34s/it]
Training:  40%|████      | 34/85 [01:54<02:50,  3.35s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.34s/it]
Training:  42%|████▏     | 36/85 [02:01<02:43,  3.34s/it]
Training:  44%|████▎     | 37/85 [02:04<02:40,  3.35s/it]
Training:  45%|████▍     | 38/85 [02:07<02:37,  3.34s/it]
Training:  46%|████▌     | 39/85 [02:11<02:33,  3.35s/it]
Training:  47%|████▋     | 40/85 [02:14<02:30,  3.34s/it]
Training:  48%|████▊     | 41/85 [02:17<02:27,  3.35s/it]
Training:  49%|████▉     | 42/85 [02:21<02:23,  3.34s/it]
Training:  51%|█████     | 43/85 [02:24<02:20,  3.35s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:17,  3.35s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:13,  3.35s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:10,  3.35s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.34s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:03,  3.34s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:00,  3.35s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:56,  3.34s/it]
Training:  60%|██████    | 51/85 [02:51<01:53,  3.34s/it]
Training:  61%|██████    | 52/85 [02:54<01:50,  3.35s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:46,  3.34s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:43,  3.34s/it]
Training:  65%|██████▍   | 55/85 [03:04<01:40,  3.34s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:36,  3.34s/it]
Training:  67%|██████▋   | 57/85 [03:11<01:33,  3.33s/it]
Training:  68%|██████▊   | 58/85 [03:14<01:30,  3.34s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:26,  3.34s/it]
Training:  71%|███████   | 60/85 [03:21<01:23,  3.34s/it]
Training:  72%|███████▏  | 61/85 [03:24<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:16,  3.34s/it]
Training:  74%|███████▍  | 63/85 [03:31<01:13,  3.34s/it]
Training:  75%|███████▌  | 64/85 [03:34<01:10,  3.34s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:41<01:03,  3.34s/it]
Training:  79%|███████▉  | 67/85 [03:44<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:48<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:51<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:54<00:50,  3.34s/it]
Training:  84%|████████▎ | 71/85 [03:58<00:46,  3.35s/it]
Training:  85%|████████▍ | 72/85 [04:01<00:43,  3.35s/it]
Training:  86%|████████▌ | 73/85 [04:04<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:08<00:36,  3.34s/it]
Training:  88%|████████▊ | 75/85 [04:11<00:33,  3.33s/it]
Training:  89%|████████▉ | 76/85 [04:14<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:18<00:26,  3.34s/it]
Training:  92%|█████████▏| 78/85 [04:21<00:23,  3.34s/it]
Training:  93%|█████████▎| 79/85 [04:24<00:19,  3.33s/it]
Training:  94%|█████████▍| 80/85 [04:28<00:16,  3.33s/it]
Training:  95%|█████████▌| 81/85 [04:31<00:13,  3.34s/it]
Training:  96%|█████████▋| 82/85 [04:34<00:10,  3.34s/it]
Training:  98%|█████████▊| 83/85 [04:38<00:06,  3.34s/it]
Training:  99%|█████████▉| 84/85 [04:41<00:03,  3.34s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.35s/it]
2024-08-16 12:47:45.048 | INFO     | __main__:train:207 - Epoch 14 Average Loss: 2.82218
2024-08-16 12:47:45.754 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL14*****
2024-08-16 12:47:45.754 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:47:45.754 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.09it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.29it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.29it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.30it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.30it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.69it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.32it/s]
2024-08-16 12:48:02.388 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6667    0.3810    0.4848        21
  automatic-speech-recognition     0.6957    0.9412    0.8000        34
              depth-estimation        nan    0.0000       nan         1
            feature-extraction     0.5000    0.0238    0.0455        42
                     fill-mask     0.2987    0.3833    0.3358        60
          image-classification     1.0000    0.9722    0.9859        36
            image-segmentation     0.7500    1.0000    0.8571        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering     0.2174    0.0847    0.1220        59
           sentence-similarity     0.7273    0.2353    0.3556        34
                 summarization     0.3750    1.0000    0.5455         3
           text-classification     0.5556    0.3125    0.4000        96
               text-generation     0.9268    0.8636    0.8941        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8197    0.8621    0.8403        58
          token-classification     0.2313    0.6296    0.3383        54
                   translation     1.0000    0.4000    0.5714        10
                       unknown     0.3362    0.6393    0.4407        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.4934       681
                     macro avg     0.6283    0.5208    0.5931       681
                  weighted avg     0.5468    0.4934    0.4937       681

2024-08-16 12:48:02.388 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4934
2024-08-16 12:48:02.391 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:48:02.391 | INFO     | __main__:eval:454 - Validation loss: 3.777950731190768
2024-08-16 12:48:02.399 | INFO     | __main__:train:256 - epochs: 14
2024-08-16 12:48:02.400 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146]
2024-08-16 12:48:02.400 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768]
2024-08-16 12:48:02.400 | INFO     | __main__:train:159 - ====epoch #15====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:56,  3.53s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.46s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.42s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.40s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.40s/it]
Training:   7%|▋         | 6/85 [00:20<04:28,  3.40s/it]
Training:   8%|▊         | 7/85 [00:23<04:24,  3.39s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.37s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.36s/it]
Training:  15%|█▌        | 13/85 [00:44<04:02,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.38s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:48,  3.36s/it]
Training:  21%|██        | 18/85 [01:00<03:44,  3.36s/it]
Training:  22%|██▏       | 19/85 [01:04<03:40,  3.35s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.34s/it]
Training:  25%|██▍       | 21/85 [01:10<03:33,  3.33s/it]
Training:  26%|██▌       | 22/85 [01:14<03:30,  3.34s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.34s/it]
Training:  28%|██▊       | 24/85 [01:20<03:23,  3.34s/it]
Training:  29%|██▉       | 25/85 [01:24<03:20,  3.34s/it]
Training:  31%|███       | 26/85 [01:27<03:16,  3.34s/it]
Training:  32%|███▏      | 27/85 [01:30<03:13,  3.34s/it]
Training:  33%|███▎      | 28/85 [01:34<03:10,  3.34s/it]
Training:  34%|███▍      | 29/85 [01:37<03:07,  3.34s/it]
Training:  35%|███▌      | 30/85 [01:40<03:04,  3.35s/it]
Training:  36%|███▋      | 31/85 [01:44<03:00,  3.35s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.35s/it]
Training:  39%|███▉      | 33/85 [01:50<02:53,  3.34s/it]
Training:  40%|████      | 34/85 [01:54<02:50,  3.34s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.34s/it]
Training:  42%|████▏     | 36/85 [02:01<02:43,  3.34s/it]
Training:  44%|████▎     | 37/85 [02:04<02:40,  3.34s/it]
Training:  45%|████▍     | 38/85 [02:07<02:37,  3.34s/it]
Training:  46%|████▌     | 39/85 [02:11<02:33,  3.34s/it]
Training:  47%|████▋     | 40/85 [02:14<02:30,  3.34s/it]
Training:  48%|████▊     | 41/85 [02:17<02:26,  3.34s/it]
Training:  49%|████▉     | 42/85 [02:21<02:23,  3.34s/it]
Training:  51%|█████     | 43/85 [02:24<02:20,  3.34s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:16,  3.34s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:13,  3.35s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:10,  3.35s/it]
Training:  55%|█████▌    | 47/85 [02:37<02:07,  3.35s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:03,  3.34s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:00,  3.35s/it]
Training:  59%|█████▉    | 50/85 [02:47<01:57,  3.34s/it]
Training:  60%|██████    | 51/85 [02:51<01:53,  3.33s/it]
Training:  61%|██████    | 52/85 [02:54<01:49,  3.33s/it]
Training:  62%|██████▏   | 53/85 [02:57<01:46,  3.34s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:43,  3.35s/it]
Training:  65%|██████▍   | 55/85 [03:04<01:40,  3.35s/it]
Training:  66%|██████▌   | 56/85 [03:07<01:37,  3.35s/it]
Training:  67%|██████▋   | 57/85 [03:11<01:33,  3.35s/it]
Training:  68%|██████▊   | 58/85 [03:14<01:30,  3.35s/it]
Training:  69%|██████▉   | 59/85 [03:17<01:27,  3.35s/it]
Training:  71%|███████   | 60/85 [03:21<01:23,  3.35s/it]
Training:  72%|███████▏  | 61/85 [03:24<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:27<01:17,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:31<01:13,  3.35s/it]
Training:  75%|███████▌  | 64/85 [03:34<01:10,  3.35s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:41<01:03,  3.35s/it]
Training:  79%|███████▉  | 67/85 [03:44<01:00,  3.35s/it]
Training:  80%|████████  | 68/85 [03:48<00:56,  3.35s/it]
Training:  81%|████████  | 69/85 [03:51<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:54<00:50,  3.35s/it]
Training:  84%|████████▎ | 71/85 [03:58<00:46,  3.35s/it]
Training:  85%|████████▍ | 72/85 [04:01<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:04<00:40,  3.34s/it]
Training:  87%|████████▋ | 74/85 [04:08<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:11<00:33,  3.35s/it]
Training:  89%|████████▉ | 76/85 [04:14<00:30,  3.35s/it]
Training:  91%|█████████ | 77/85 [04:18<00:26,  3.34s/it]
Training:  92%|█████████▏| 78/85 [04:21<00:23,  3.34s/it]
Training:  93%|█████████▎| 79/85 [04:24<00:20,  3.34s/it]
Training:  94%|█████████▍| 80/85 [04:28<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:31<00:13,  3.34s/it]
Training:  96%|█████████▋| 82/85 [04:34<00:10,  3.34s/it]
Training:  98%|█████████▊| 83/85 [04:38<00:06,  3.34s/it]
Training:  99%|█████████▉| 84/85 [04:41<00:03,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.35s/it]
2024-08-16 12:52:47.303 | INFO     | __main__:train:207 - Epoch 15 Average Loss: 2.80043
2024-08-16 12:52:48.021 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL15*****
2024-08-16 12:52:48.021 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:52:48.021 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.26it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.26it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.26it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 12:53:05.096 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6923    0.4286    0.5294        21
  automatic-speech-recognition     0.6875    0.9706    0.8049        34
              depth-estimation        nan    0.0000       nan         1
            feature-extraction     0.5714    0.0952    0.1633        42
                     fill-mask     0.2683    0.3667    0.3099        60
          image-classification     1.0000    0.9444    0.9714        36
            image-segmentation     0.8333    0.8333    0.8333        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.2000    0.1176    0.1481        17
              object-detection     0.8571    1.0000    0.9231         6
                   pretraining        nan    0.0000       nan        17
            question-answering     0.3000    0.2034    0.2424        59
           sentence-similarity     0.4706    0.2353    0.3137        34
                 summarization     0.5000    0.3333    0.4000         3
           text-classification     0.5205    0.3958    0.4497        96
               text-generation     0.9286    0.8864    0.9070        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.9107    0.8793    0.8947        58
          token-classification     0.2375    0.3519    0.2836        54
                   translation     1.0000    0.6000    0.7500        10
                       unknown     0.3357    0.7869    0.4706        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5140       681
                     macro avg     0.6490    0.5078    0.5879       681
                  weighted avg     0.5538    0.5140    0.5122       681

2024-08-16 12:53:05.096 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.514
2024-08-16 12:53:05.101 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:53:05.102 | INFO     | __main__:eval:454 - Validation loss: 3.779793771830472
2024-08-16 12:53:05.114 | INFO     | __main__:train:256 - epochs: 15
2024-08-16 12:53:05.115 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253]
2024-08-16 12:53:05.115 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472]
2024-08-16 12:53:05.115 | INFO     | __main__:train:159 - ====epoch #16====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<05:00,  3.57s/it]
Training:   2%|▏         | 2/85 [00:06<04:48,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.40s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.40s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:14,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.39s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.39s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.38s/it]
Training:  21%|██        | 18/85 [01:01<03:46,  3.38s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.37s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:11<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.39s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.39s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.38s/it]
Training:  36%|███▋      | 31/85 [01:45<03:02,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.38s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.38s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.38s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.39s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.38s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.38s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.39s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.39s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:18,  3.38s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.38s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.39s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.39s/it]
Training:  60%|██████    | 51/85 [02:52<01:55,  3.39s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.39s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.38s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.38s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.38s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.38s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.38s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.38s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.38s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.39s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.38s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.38s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.39s/it]
Training:  80%|████████  | 68/85 [03:50<00:58,  3.47s/it]
Training:  81%|████████  | 69/85 [03:53<00:55,  3.44s/it]
Training:  82%|████████▏ | 70/85 [03:57<00:51,  3.42s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.41s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:44,  3.40s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.39s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.39s/it]
Training:  88%|████████▊ | 75/85 [04:14<00:33,  3.39s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:20<00:27,  3.38s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.38s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.38s/it]
Training:  94%|█████████▍| 80/85 [04:31<00:16,  3.38s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.38s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.38s/it]
Training:  98%|█████████▊| 83/85 [04:41<00:06,  3.38s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.39s/it]
2024-08-16 12:57:53.078 | INFO     | __main__:train:207 - Epoch 16 Average Loss: 2.72868
2024-08-16 12:57:53.791 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL16*****
2024-08-16 12:57:53.791 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 12:57:53.791 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.22it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.28it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.27it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.28it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.30it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.28it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.28it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.29it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.68it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.32it/s]
2024-08-16 12:58:10.506 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6923    0.4286    0.5294        21
  automatic-speech-recognition     0.6875    0.9706    0.8049        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5000    0.2381    0.3226        42
                     fill-mask     0.2500    0.4000    0.3077        60
          image-classification     1.0000    0.9722    0.9859        36
            image-segmentation     0.9231    1.0000    0.9600        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.0000    0.0000       nan        17
              object-detection     0.8571    1.0000    0.9231         6
                   pretraining     0.6667    0.1176    0.2000        17
            question-answering     0.3651    0.3898    0.3770        59
           sentence-similarity     0.7500    0.1765    0.2857        34
                 summarization     0.3333    0.3333    0.3333         3
           text-classification     0.4659    0.4271    0.4457        96
               text-generation     0.9070    0.8864    0.8966        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8254    0.8966    0.8595        58
          token-classification     0.2727    0.2778    0.2752        54
                   translation     1.0000    0.4000    0.5714        10
                       unknown     0.2736    0.4754    0.3473        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5140       681
                     macro avg     0.6562    0.5496    0.6090       681
                  weighted avg     0.5475    0.5140    0.5184       681

2024-08-16 12:58:10.507 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.514
2024-08-16 12:58:10.510 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 12:58:10.510 | INFO     | __main__:eval:454 - Validation loss: 3.7634851282293145
2024-08-16 12:58:10.516 | INFO     | __main__:train:256 - epochs: 16
2024-08-16 12:58:10.517 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266]
2024-08-16 12:58:10.517 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145]
2024-08-16 12:58:10.517 | INFO     | __main__:train:159 - ====epoch #17====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:53,  3.50s/it]
Training:   2%|▏         | 2/85 [00:06<04:44,  3.42s/it]
Training:   4%|▎         | 3/85 [00:10<04:37,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:33,  3.38s/it]
Training:   6%|▌         | 5/85 [00:16<04:29,  3.37s/it]
Training:   7%|▋         | 6/85 [00:20<04:26,  3.37s/it]
Training:   8%|▊         | 7/85 [00:23<04:22,  3.37s/it]
Training:   9%|▉         | 8/85 [00:27<04:19,  3.37s/it]
Training:  11%|█         | 9/85 [00:30<04:15,  3.37s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.37s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:43<04:02,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:41,  3.35s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.34s/it]
Training:  25%|██▍       | 21/85 [01:10<03:34,  3.35s/it]
Training:  26%|██▌       | 22/85 [01:14<03:30,  3.35s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.35s/it]
Training:  28%|██▊       | 24/85 [01:20<03:24,  3.36s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:30<03:15,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.37s/it]
Training:  34%|███▍      | 29/85 [01:37<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:06,  3.38s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.38s/it]
Training:  38%|███▊      | 32/85 [01:47<02:58,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.37s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.36s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.36s/it]
Training:  42%|████▏     | 36/85 [02:01<02:44,  3.35s/it]
Training:  44%|████▎     | 37/85 [02:04<02:40,  3.35s/it]
Training:  45%|████▍     | 38/85 [02:07<02:37,  3.34s/it]
Training:  46%|████▌     | 39/85 [02:11<02:33,  3.34s/it]
Training:  47%|████▋     | 40/85 [02:14<02:30,  3.34s/it]
Training:  48%|████▊     | 41/85 [02:17<02:26,  3.34s/it]
Training:  49%|████▉     | 42/85 [02:21<02:23,  3.34s/it]
Training:  51%|█████     | 43/85 [02:24<02:20,  3.33s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:16,  3.34s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:13,  3.33s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:09,  3.33s/it]
Training:  55%|█████▌    | 47/85 [02:37<02:06,  3.34s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:03,  3.34s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:00,  3.34s/it]
Training:  59%|█████▉    | 50/85 [02:47<01:56,  3.34s/it]
Training:  60%|██████    | 51/85 [02:51<01:53,  3.34s/it]
Training:  61%|██████    | 52/85 [02:54<01:50,  3.35s/it]
Training:  62%|██████▏   | 53/85 [02:57<01:46,  3.34s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:43,  3.33s/it]
Training:  65%|██████▍   | 55/85 [03:04<01:40,  3.34s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:36,  3.34s/it]
Training:  67%|██████▋   | 57/85 [03:11<01:33,  3.33s/it]
Training:  68%|██████▊   | 58/85 [03:14<01:29,  3.33s/it]
Training:  69%|██████▉   | 59/85 [03:17<01:26,  3.33s/it]
Training:  71%|███████   | 60/85 [03:21<01:23,  3.33s/it]
Training:  72%|███████▏  | 61/85 [03:24<01:20,  3.33s/it]
Training:  73%|███████▎  | 62/85 [03:27<01:16,  3.33s/it]
Training:  74%|███████▍  | 63/85 [03:31<01:13,  3.33s/it]
Training:  75%|███████▌  | 64/85 [03:34<01:09,  3.33s/it]
Training:  76%|███████▋  | 65/85 [03:37<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:41<01:03,  3.34s/it]
Training:  79%|███████▉  | 67/85 [03:44<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:48<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:51<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:54<00:50,  3.35s/it]
Training:  84%|████████▎ | 71/85 [03:58<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:01<00:43,  3.35s/it]
Training:  86%|████████▌ | 73/85 [04:04<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:08<00:36,  3.34s/it]
Training:  88%|████████▊ | 75/85 [04:11<00:33,  3.34s/it]
Training:  89%|████████▉ | 76/85 [04:14<00:29,  3.33s/it]
Training:  91%|█████████ | 77/85 [04:18<00:26,  3.33s/it]
Training:  92%|█████████▏| 78/85 [04:21<00:23,  3.33s/it]
Training:  93%|█████████▎| 79/85 [04:24<00:19,  3.33s/it]
Training:  94%|█████████▍| 80/85 [04:28<00:16,  3.33s/it]
Training:  95%|█████████▌| 81/85 [04:31<00:13,  3.33s/it]
Training:  96%|█████████▋| 82/85 [04:34<00:09,  3.33s/it]
Training:  98%|█████████▊| 83/85 [04:38<00:06,  3.34s/it]
Training:  99%|█████████▉| 84/85 [04:41<00:03,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.35s/it]
2024-08-16 13:02:55.321 | INFO     | __main__:train:207 - Epoch 17 Average Loss: 2.79118
2024-08-16 13:02:56.034 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL17*****
2024-08-16 13:02:56.034 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:02:56.034 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.09it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.28it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.29it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.30it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.69it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.33it/s]
2024-08-16 13:03:12.646 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.5714    0.7619    0.6531        21
  automatic-speech-recognition     0.8485    0.8235    0.8358        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5000    0.2857    0.3636        42
                     fill-mask     0.2979    0.2333    0.2617        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     0.8571    1.0000    0.9231        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.0000    0.0000       nan        17
            question-answering     0.3542    0.2881    0.3178        59
           sentence-similarity     0.6429    0.2647    0.3750        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.5000    0.3750    0.4286        96
               text-generation     0.8864    0.8864    0.8864        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8644    0.8793    0.8718        58
          token-classification     0.2436    0.3519    0.2879        54
                   translation     1.0000    0.5000    0.6667        10
                       unknown     0.3057    0.7869    0.4404        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5272       681
                     macro avg     0.6590    0.5806    0.6568       681
                  weighted avg     0.5540    0.5272    0.5405       681

2024-08-16 13:03:12.647 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5272
2024-08-16 13:03:12.650 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:03:12.650 | INFO     | __main__:eval:454 - Validation loss: 3.8972615762190386
2024-08-16 13:03:12.654 | INFO     | __main__:train:256 - epochs: 17
2024-08-16 13:03:12.654 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715]
2024-08-16 13:03:12.654 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386]
2024-08-16 13:03:12.654 | INFO     | __main__:train:159 - ====epoch #18====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:55,  3.52s/it]
Training:   2%|▏         | 2/85 [00:06<04:44,  3.43s/it]
Training:   4%|▎         | 3/85 [00:10<04:38,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:32,  3.37s/it]
Training:   6%|▌         | 5/85 [00:16<04:28,  3.36s/it]
Training:   7%|▋         | 6/85 [00:20<04:24,  3.35s/it]
Training:   8%|▊         | 7/85 [00:23<04:20,  3.35s/it]
Training:   9%|▉         | 8/85 [00:26<04:17,  3.34s/it]
Training:  11%|█         | 9/85 [00:30<04:14,  3.34s/it]
Training:  12%|█▏        | 10/85 [00:33<04:10,  3.35s/it]
Training:  13%|█▎        | 11/85 [00:36<04:07,  3.34s/it]
Training:  14%|█▍        | 12/85 [00:40<04:03,  3.34s/it]
Training:  15%|█▌        | 13/85 [00:43<04:00,  3.34s/it]
Training:  16%|█▋        | 14/85 [00:46<03:56,  3.34s/it]
Training:  18%|█▊        | 15/85 [00:50<03:53,  3.33s/it]
Training:  19%|█▉        | 16/85 [00:53<03:49,  3.33s/it]
Training:  20%|██        | 17/85 [00:56<03:46,  3.33s/it]
Training:  21%|██        | 18/85 [01:00<03:43,  3.33s/it]
Training:  22%|██▏       | 19/85 [01:03<03:40,  3.34s/it]
Training:  24%|██▎       | 20/85 [01:06<03:37,  3.34s/it]
Training:  25%|██▍       | 21/85 [01:10<03:33,  3.34s/it]
Training:  26%|██▌       | 22/85 [01:13<03:30,  3.34s/it]
Training:  27%|██▋       | 23/85 [01:16<03:27,  3.34s/it]
Training:  28%|██▊       | 24/85 [01:20<03:23,  3.34s/it]
Training:  29%|██▉       | 25/85 [01:23<03:20,  3.34s/it]
Training:  31%|███       | 26/85 [01:26<03:16,  3.33s/it]
Training:  32%|███▏      | 27/85 [01:30<03:13,  3.34s/it]
Training:  33%|███▎      | 28/85 [01:33<03:10,  3.34s/it]
Training:  34%|███▍      | 29/85 [01:37<03:07,  3.34s/it]
Training:  35%|███▌      | 30/85 [01:40<03:03,  3.34s/it]
Training:  36%|███▋      | 31/85 [01:43<03:00,  3.34s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.34s/it]
Training:  39%|███▉      | 33/85 [01:50<02:54,  3.35s/it]
Training:  40%|████      | 34/85 [01:53<02:50,  3.34s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.34s/it]
Training:  42%|████▏     | 36/85 [02:00<02:43,  3.34s/it]
Training:  44%|████▎     | 37/85 [02:03<02:40,  3.35s/it]
Training:  45%|████▍     | 38/85 [02:07<02:37,  3.35s/it]
Training:  46%|████▌     | 39/85 [02:10<02:33,  3.34s/it]
Training:  47%|████▋     | 40/85 [02:13<02:30,  3.34s/it]
Training:  48%|████▊     | 41/85 [02:17<02:26,  3.33s/it]
Training:  49%|████▉     | 42/85 [02:20<02:22,  3.31s/it]
Training:  51%|█████     | 43/85 [02:23<02:19,  3.32s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:16,  3.32s/it]
Training:  53%|█████▎    | 45/85 [02:30<02:13,  3.33s/it]
Training:  54%|█████▍    | 46/85 [02:33<02:10,  3.33s/it]
Training:  55%|█████▌    | 47/85 [02:37<02:06,  3.34s/it]
Training:  56%|█████▋    | 48/85 [02:40<02:03,  3.34s/it]
Training:  58%|█████▊    | 49/85 [02:43<02:00,  3.34s/it]
Training:  59%|█████▉    | 50/85 [02:47<01:56,  3.33s/it]
Training:  60%|██████    | 51/85 [02:50<01:53,  3.33s/it]
Training:  61%|██████    | 52/85 [02:53<01:50,  3.34s/it]
Training:  62%|██████▏   | 53/85 [02:57<01:47,  3.35s/it]
Training:  64%|██████▎   | 54/85 [03:00<01:43,  3.34s/it]
Training:  65%|██████▍   | 55/85 [03:03<01:40,  3.34s/it]
Training:  66%|██████▌   | 56/85 [03:07<01:36,  3.34s/it]
Training:  67%|██████▋   | 57/85 [03:10<01:33,  3.34s/it]
Training:  68%|██████▊   | 58/85 [03:13<01:30,  3.34s/it]
Training:  69%|██████▉   | 59/85 [03:17<01:26,  3.34s/it]
Training:  71%|███████   | 60/85 [03:20<01:23,  3.34s/it]
Training:  72%|███████▏  | 61/85 [03:23<01:20,  3.34s/it]
Training:  73%|███████▎  | 62/85 [03:27<01:16,  3.34s/it]
Training:  74%|███████▍  | 63/85 [03:30<01:13,  3.34s/it]
Training:  75%|███████▌  | 64/85 [03:33<01:10,  3.34s/it]
Training:  76%|███████▋  | 65/85 [03:37<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:40<01:03,  3.33s/it]
Training:  79%|███████▉  | 67/85 [03:43<00:59,  3.33s/it]
Training:  80%|████████  | 68/85 [03:47<00:56,  3.33s/it]
Training:  81%|████████  | 69/85 [03:50<00:53,  3.33s/it]
Training:  82%|████████▏ | 70/85 [03:53<00:50,  3.33s/it]
Training:  84%|████████▎ | 71/85 [03:57<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:00<00:43,  3.33s/it]
Training:  86%|████████▌ | 73/85 [04:03<00:39,  3.33s/it]
Training:  87%|████████▋ | 74/85 [04:07<00:36,  3.34s/it]
Training:  88%|████████▊ | 75/85 [04:10<00:33,  3.34s/it]
Training:  89%|████████▉ | 76/85 [04:13<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:17<00:26,  3.34s/it]
Training:  92%|█████████▏| 78/85 [04:20<00:23,  3.34s/it]
Training:  93%|█████████▎| 79/85 [04:23<00:20,  3.34s/it]
Training:  94%|█████████▍| 80/85 [04:27<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:30<00:13,  3.35s/it]
Training:  96%|█████████▋| 82/85 [04:33<00:10,  3.34s/it]
Training:  98%|█████████▊| 83/85 [04:37<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:40<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:43<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.34s/it]
2024-08-16 13:07:56.679 | INFO     | __main__:train:207 - Epoch 18 Average Loss: 2.75048
2024-08-16 13:07:57.391 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL18*****
2024-08-16 13:07:57.391 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:07:57.391 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.09it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.25it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.28it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.29it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.29it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.29it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.30it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.30it/s]
Evaluating:  64%|██████▎   | 14/22 [00:10<00:06,  1.30it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.30it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.30it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.30it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.69it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.33it/s]
2024-08-16 13:08:13.960 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6364    0.3333    0.4375        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5385    0.1667    0.2545        42
                     fill-mask     0.2836    0.3167    0.2992        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.8333    0.9091        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.0000    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.0800    0.1176    0.0952        17
            question-answering     0.3171    0.2203    0.2600        59
           sentence-similarity     0.3929    0.3235    0.3548        34
                 summarization     0.6000    1.0000    0.7500         3
           text-classification     0.4167    0.3646    0.3889        96
               text-generation     0.8333    0.9091    0.8696        44
                text-to-speech     0.0000    0.0000       nan         2
          text2text-generation     0.8060    0.9310    0.8640        58
          token-classification     0.2909    0.2963    0.2936        54
                   translation     0.8571    0.6000    0.7059        10
                       unknown     0.3190    0.6066    0.4181        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5037       681
                     macro avg     0.5953    0.5744    0.6207       681
                  weighted avg     0.5050    0.5037    0.5019       681

2024-08-16 13:08:13.961 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5037
2024-08-16 13:08:13.964 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:08:13.964 | INFO     | __main__:eval:454 - Validation loss: 3.84952729398554
2024-08-16 13:08:13.968 | INFO     | __main__:train:256 - epochs: 18
2024-08-16 13:08:13.969 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724]
2024-08-16 13:08:13.969 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554]
2024-08-16 13:08:13.969 | INFO     | __main__:train:159 - ====epoch #19====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:50,  3.46s/it]
Training:   2%|▏         | 2/85 [00:06<04:42,  3.40s/it]
Training:   4%|▎         | 3/85 [00:10<04:36,  3.37s/it]
Training:   5%|▍         | 4/85 [00:13<04:32,  3.36s/it]
Training:   6%|▌         | 5/85 [00:16<04:28,  3.36s/it]
Training:   7%|▋         | 6/85 [00:20<04:24,  3.35s/it]
Training:   8%|▊         | 7/85 [00:23<04:21,  3.36s/it]
Training:   9%|▉         | 8/85 [00:26<04:17,  3.35s/it]
Training:  11%|█         | 9/85 [00:30<04:14,  3.35s/it]
Training:  12%|█▏        | 10/85 [00:33<04:10,  3.35s/it]
Training:  13%|█▎        | 11/85 [00:36<04:07,  3.34s/it]
Training:  14%|█▍        | 12/85 [00:40<04:03,  3.34s/it]
Training:  15%|█▌        | 13/85 [00:43<04:00,  3.35s/it]
Training:  16%|█▋        | 14/85 [00:46<03:57,  3.34s/it]
Training:  18%|█▊        | 15/85 [00:50<03:54,  3.35s/it]
Training:  19%|█▉        | 16/85 [00:53<03:50,  3.35s/it]
Training:  20%|██        | 17/85 [00:56<03:47,  3.34s/it]
Training:  21%|██        | 18/85 [01:00<03:43,  3.34s/it]
Training:  22%|██▏       | 19/85 [01:03<03:40,  3.34s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.34s/it]
Training:  25%|██▍       | 21/85 [01:10<03:33,  3.34s/it]
Training:  26%|██▌       | 22/85 [01:13<03:30,  3.34s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.34s/it]
Training:  28%|██▊       | 24/85 [01:20<03:23,  3.34s/it]
Training:  29%|██▉       | 25/85 [01:23<03:20,  3.34s/it]
Training:  31%|███       | 26/85 [01:27<03:17,  3.34s/it]
Training:  32%|███▏      | 27/85 [01:30<03:13,  3.34s/it]
Training:  33%|███▎      | 28/85 [01:33<03:10,  3.34s/it]
Training:  34%|███▍      | 29/85 [01:37<03:06,  3.33s/it]
Training:  35%|███▌      | 30/85 [01:40<03:03,  3.34s/it]
Training:  36%|███▋      | 31/85 [01:43<03:00,  3.34s/it]
Training:  38%|███▊      | 32/85 [01:47<02:56,  3.33s/it]
Training:  39%|███▉      | 33/85 [01:50<02:53,  3.34s/it]
Training:  40%|████      | 34/85 [01:53<02:49,  3.33s/it]
Training:  41%|████      | 35/85 [01:57<02:46,  3.34s/it]
Training:  42%|████▏     | 36/85 [02:00<02:43,  3.33s/it]
Training:  44%|████▎     | 37/85 [02:03<02:39,  3.33s/it]
Training:  45%|████▍     | 38/85 [02:07<02:36,  3.33s/it]
Training:  46%|████▌     | 39/85 [02:10<02:33,  3.34s/it]
Training:  47%|████▋     | 40/85 [02:13<02:30,  3.33s/it]
Training:  48%|████▊     | 41/85 [02:17<02:26,  3.33s/it]
Training:  49%|████▉     | 42/85 [02:20<02:23,  3.33s/it]
Training:  51%|█████     | 43/85 [02:23<02:20,  3.34s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:16,  3.34s/it]
Training:  53%|█████▎    | 45/85 [02:30<02:13,  3.33s/it]
Training:  54%|█████▍    | 46/85 [02:33<02:09,  3.33s/it]
Training:  55%|█████▌    | 47/85 [02:37<02:06,  3.34s/it]
Training:  56%|█████▋    | 48/85 [02:40<02:03,  3.34s/it]
Training:  58%|█████▊    | 49/85 [02:43<02:00,  3.34s/it]
Training:  59%|█████▉    | 50/85 [02:47<01:56,  3.34s/it]
Training:  60%|██████    | 51/85 [02:50<01:53,  3.34s/it]
Training:  61%|██████    | 52/85 [02:53<01:50,  3.34s/it]
Training:  62%|██████▏   | 53/85 [02:57<01:46,  3.34s/it]
Training:  64%|██████▎   | 54/85 [03:00<01:43,  3.34s/it]
Training:  65%|██████▍   | 55/85 [03:03<01:39,  3.33s/it]
Training:  66%|██████▌   | 56/85 [03:07<01:36,  3.34s/it]
Training:  67%|██████▋   | 57/85 [03:10<01:33,  3.33s/it]
Training:  68%|██████▊   | 58/85 [03:13<01:29,  3.33s/it]
Training:  69%|██████▉   | 59/85 [03:17<01:26,  3.34s/it]
Training:  71%|███████   | 60/85 [03:20<01:23,  3.34s/it]
Training:  72%|███████▏  | 61/85 [03:23<01:20,  3.34s/it]
Training:  73%|███████▎  | 62/85 [03:27<01:16,  3.34s/it]
Training:  74%|███████▍  | 63/85 [03:30<01:13,  3.34s/it]
Training:  75%|███████▌  | 64/85 [03:33<01:10,  3.35s/it]
Training:  76%|███████▋  | 65/85 [03:37<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:40<01:03,  3.33s/it]
Training:  79%|███████▉  | 67/85 [03:43<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:47<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:50<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:53<00:50,  3.35s/it]
Training:  84%|████████▎ | 71/85 [03:57<00:46,  3.35s/it]
Training:  85%|████████▍ | 72/85 [04:00<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:03<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:07<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:10<00:33,  3.35s/it]
Training:  89%|████████▉ | 76/85 [04:13<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:17<00:26,  3.33s/it]
Training:  92%|█████████▏| 78/85 [04:20<00:23,  3.33s/it]
Training:  93%|█████████▎| 79/85 [04:23<00:19,  3.33s/it]
Training:  94%|█████████▍| 80/85 [04:27<00:16,  3.33s/it]
Training:  95%|█████████▌| 81/85 [04:30<00:13,  3.32s/it]
Training:  96%|█████████▋| 82/85 [04:33<00:10,  3.33s/it]
Training:  98%|█████████▊| 83/85 [04:37<00:06,  3.34s/it]
Training:  99%|█████████▉| 84/85 [04:40<00:03,  3.34s/it]
Training: 100%|██████████| 85/85 [04:43<00:00,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.34s/it]
2024-08-16 13:12:57.980 | INFO     | __main__:train:207 - Epoch 19 Average Loss: 2.72081
2024-08-16 13:12:58.679 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL19*****
2024-08-16 13:12:58.679 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:12:58.679 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.27it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.29it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.28it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.27it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.27it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.27it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.27it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.27it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.27it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.30it/s]
2024-08-16 13:13:15.608 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6667    0.3810    0.4848        21
  automatic-speech-recognition     0.6875    0.9706    0.8049        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5909    0.3095    0.4063        42
                     fill-mask     0.3462    0.1500    0.2093        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.7500    0.8571        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.5000    0.0588    0.1053        17
            question-answering     0.2667    0.2034    0.2308        59
           sentence-similarity     0.6667    0.2353    0.3478        34
                 summarization     0.6000    1.0000    0.7500         3
           text-classification     0.5238    0.3438    0.4151        96
               text-generation     0.9512    0.8864    0.9176        44
                text-to-speech     0.0000    0.0000       nan         2
          text2text-generation     0.9074    0.8448    0.8750        58
          token-classification     0.2363    0.7963    0.3644        54
                   translation     0.7500    0.6000    0.6667        10
                       unknown     0.3093    0.4918    0.3797        61
      zero-shot-classification     0.8000    0.5000    0.6154         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5125       681
                     macro avg     0.6728    0.5879    0.6395       681
                  weighted avg     0.5767    0.5125    0.5156       681

2024-08-16 13:13:15.608 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5125
2024-08-16 13:13:15.612 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:13:15.613 | INFO     | __main__:eval:454 - Validation loss: 3.817299875346097
2024-08-16 13:13:15.618 | INFO     | __main__:train:256 - epochs: 19
2024-08-16 13:13:15.618 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578]
2024-08-16 13:13:15.618 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097]
2024-08-16 13:13:15.618 | INFO     | __main__:train:159 - ====epoch #20====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:56,  3.53s/it]
Training:   2%|▏         | 2/85 [00:06<04:44,  3.42s/it]
Training:   4%|▎         | 3/85 [00:10<04:39,  3.40s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:17<04:30,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:24,  3.39s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.39s/it]
Training:  15%|█▌        | 13/85 [00:44<04:03,  3.38s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.38s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.37s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:11<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:37,  3.45s/it]
Training:  27%|██▋       | 23/85 [01:18<03:32,  3.43s/it]
Training:  28%|██▊       | 24/85 [01:21<03:28,  3.41s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.39s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.38s/it]
Training:  36%|███▋      | 31/85 [01:45<03:02,  3.38s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.39s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.38s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.38s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.37s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.38s/it]
Training:  47%|████▋     | 40/85 [02:15<02:31,  3.38s/it]
Training:  48%|████▊     | 41/85 [02:18<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:14,  3.37s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.37s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.37s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:04,  3.37s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.38s/it]
Training:  61%|██████    | 52/85 [02:55<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.38s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.38s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:34,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:30,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.39s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.40s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:18,  3.41s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.41s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:11,  3.41s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:08,  3.42s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.41s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:01,  3.41s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.40s/it]
Training:  81%|████████  | 69/85 [03:53<00:54,  3.40s/it]
Training:  82%|████████▏ | 70/85 [03:57<00:50,  3.39s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.39s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:44,  3.39s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.39s/it]
Training:  88%|████████▊ | 75/85 [04:14<00:33,  3.38s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:20<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.37s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.38s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.37s/it]
Training:  98%|█████████▊| 83/85 [04:41<00:06,  3.38s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.39s/it]
2024-08-16 13:18:03.429 | INFO     | __main__:train:207 - Epoch 20 Average Loss: 2.71196
2024-08-16 13:18:04.136 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL20*****
2024-08-16 13:18:04.136 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:18:04.137 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.18it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.23it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.26it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.26it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.26it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.26it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.27it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.28it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.28it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.28it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.28it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.28it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.67it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.30it/s]
2024-08-16 13:18:21.024 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.6364    0.3333    0.4375        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.3333    0.1190    0.1754        42
                     fill-mask     0.2432    0.1500    0.1856        60
          image-classification     1.0000    0.9722    0.9859        36
            image-segmentation     0.8571    1.0000    0.9231        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice        nan    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.1176    0.1176    0.1176        17
            question-answering     0.3478    0.1356    0.1951        59
           sentence-similarity     0.5000    0.2941    0.3704        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4762    0.4167    0.4444        96
               text-generation     0.9286    0.8864    0.9070        44
                text-to-speech        nan    0.0000       nan         2
          text2text-generation     0.8095    0.8793    0.8430        58
          token-classification     0.2078    0.5926    0.3077        54
                   translation     0.8333    0.5000    0.6250        10
                       unknown     0.3667    0.5410    0.4371        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.4949       681
                     macro avg     0.6323    0.5563    0.5976       681
                  weighted avg     0.5203    0.4949    0.4906       681

2024-08-16 13:18:21.024 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.4949
2024-08-16 13:18:21.027 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:18:21.027 | INFO     | __main__:eval:454 - Validation loss: 3.9152129780162466
2024-08-16 13:18:21.034 | INFO     | __main__:train:256 - epochs: 20
2024-08-16 13:18:21.034 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623]
2024-08-16 13:18:21.034 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466]
2024-08-16 13:18:21.034 | INFO     | __main__:train:159 - ====epoch #21====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:54,  3.51s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.41s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.41s/it]
Training:   7%|▋         | 6/85 [00:20<04:29,  3.42s/it]
Training:   8%|▊         | 7/85 [00:23<04:26,  3.42s/it]
Training:   9%|▉         | 8/85 [00:27<04:22,  3.41s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.41s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.40s/it]
Training:  14%|█▍        | 12/85 [00:40<04:08,  3.40s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.39s/it]
Training:  18%|█▊        | 15/85 [00:51<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:53,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.39s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.39s/it]
Training:  22%|██▏       | 19/85 [01:04<03:44,  3.40s/it]
Training:  24%|██▎       | 20/85 [01:08<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.41s/it]
Training:  26%|██▌       | 22/85 [01:14<03:34,  3.40s/it]
Training:  27%|██▋       | 23/85 [01:18<03:31,  3.40s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:25<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.39s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.37s/it]
Training:  33%|███▎      | 28/85 [01:35<03:11,  3.36s/it]
Training:  34%|███▍      | 29/85 [01:38<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.38s/it]
Training:  36%|███▋      | 31/85 [01:45<03:02,  3.38s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:52<02:56,  3.40s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.39s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:09<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.38s/it]
Training:  47%|████▋     | 40/85 [02:15<02:31,  3.37s/it]
Training:  48%|████▊     | 41/85 [02:19<02:28,  3.38s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:18,  3.38s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:11,  3.38s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.38s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.38s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:55,  3.39s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:44,  3.38s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.38s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.38s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:34,  3.38s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:30,  3.36s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.37s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.37s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:20,  3.36s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.36s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.36s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:03,  3.36s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.35s/it]
Training:  80%|████████  | 68/85 [03:50<00:56,  3.35s/it]
Training:  81%|████████  | 69/85 [03:53<00:53,  3.35s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.34s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.34s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:20<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.35s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.35s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.35s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.35s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.36s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.37s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.36s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 13:23:08.203 | INFO     | __main__:train:207 - Epoch 21 Average Loss: 2.70642
2024-08-16 13:23:08.930 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL21*****
2024-08-16 13:23:08.930 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:23:08.930 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.26it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.27it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.28it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.27it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.27it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 13:23:25.943 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7000    0.3333    0.4516        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5238    0.2619    0.3492        42
                     fill-mask     0.2955    0.2167    0.2500        60
          image-classification     1.0000    0.9722    0.9859        36
            image-segmentation     0.9231    1.0000    0.9600        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1429    0.0588    0.0833        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2857    0.1176    0.1667        17
            question-answering     0.3636    0.4746    0.4118        59
           sentence-similarity     0.3636    0.3529    0.3582        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4853    0.3438    0.4024        96
               text-generation     0.9512    0.8864    0.9176        44
                text-to-speech     0.5000    0.5000    0.5000         2
          text2text-generation     0.8644    0.8793    0.8718        58
          token-classification     0.2821    0.4074    0.3333        54
                   translation     0.7500    0.6000    0.6667        10
                       unknown     0.3148    0.5574    0.4024        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5228       681
                     macro avg     0.6246    0.6009    0.5959       681
                  weighted avg     0.5365    0.5228    0.5141       681

2024-08-16 13:23:25.943 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5228
2024-08-16 13:23:25.946 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:23:25.946 | INFO     | __main__:eval:454 - Validation loss: 3.899768991903825
2024-08-16 13:23:25.952 | INFO     | __main__:train:256 - epochs: 21
2024-08-16 13:23:25.953 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405]
2024-08-16 13:23:25.953 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825]
2024-08-16 13:23:25.953 | INFO     | __main__:train:159 - ====epoch #22====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:54,  3.51s/it]
Training:   2%|▏         | 2/85 [00:06<04:44,  3.43s/it]
Training:   4%|▎         | 3/85 [00:10<04:39,  3.40s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:16<04:30,  3.38s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:19,  3.37s/it]
Training:  11%|█         | 9/85 [00:30<04:16,  3.37s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.39s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.38s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:49,  3.37s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.37s/it]
Training:  22%|██▏       | 19/85 [01:04<03:42,  3.37s/it]
Training:  24%|██▎       | 20/85 [01:07<03:38,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:10<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.37s/it]
Training:  27%|██▋       | 23/85 [01:17<03:28,  3.37s/it]
Training:  28%|██▊       | 24/85 [01:21<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:27<03:19,  3.39s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:13,  3.39s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:01,  3.36s/it]
Training:  38%|███▊      | 32/85 [01:48<02:57,  3.36s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.37s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.37s/it]
Training:  41%|████      | 35/85 [01:58<02:47,  3.34s/it]
Training:  42%|████▏     | 36/85 [02:01<02:43,  3.35s/it]
Training:  44%|████▎     | 37/85 [02:04<02:40,  3.35s/it]
Training:  45%|████▍     | 38/85 [02:08<02:37,  3.35s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.36s/it]
Training:  47%|████▋     | 40/85 [02:14<02:31,  3.36s/it]
Training:  48%|████▊     | 41/85 [02:18<02:27,  3.36s/it]
Training:  49%|████▉     | 42/85 [02:21<02:24,  3.36s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.37s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:17,  3.36s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:15,  3.38s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:08,  3.37s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.37s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.37s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.36s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.36s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.36s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.36s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.36s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:33,  3.36s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.36s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.36s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.36s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.36s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:17,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:13,  3.35s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.35s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:07,  3.36s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.36s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.35s/it]
Training:  80%|████████  | 68/85 [03:49<00:56,  3.35s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.35s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.34s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.35s/it]
Training:  86%|████████▌ | 73/85 [04:05<00:40,  3.34s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.35s/it]
Training:  89%|████████▉ | 76/85 [04:15<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.35s/it]
Training:  93%|█████████▎| 79/85 [04:25<00:20,  3.35s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.35s/it]
Training:  96%|█████████▋| 82/85 [04:35<00:10,  3.35s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:42<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.34s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.36s/it]
2024-08-16 13:28:11.896 | INFO     | __main__:train:207 - Epoch 22 Average Loss: 2.59632
2024-08-16 13:28:12.605 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL22*****
2024-08-16 13:28:12.605 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:28:12.605 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 13:28:29.711 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6667    0.9412    0.7805        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.4737    0.2143    0.2951        42
                     fill-mask     0.2963    0.2667    0.2807        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.9167    0.9565        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1429    0.0588    0.0833        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.1818    0.1176    0.1429        17
            question-answering     0.3621    0.3559    0.3590        59
           sentence-similarity     0.4762    0.2941    0.3636        34
                 summarization     0.5000    1.0000    0.6667         3
           text-classification     0.4396    0.4167    0.4278        96
               text-generation     0.9286    0.8864    0.9070        44
                text-to-speech     0.5000    0.5000    0.5000         2
          text2text-generation     0.8387    0.8966    0.8667        58
          token-classification     0.2759    0.2963    0.2857        54
                   translation     0.8571    0.6000    0.7059        10
                       unknown     0.3083    0.6066    0.4088        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5213       681
                     macro avg     0.6279    0.6086    0.5992       681
                  weighted avg     0.5297    0.5213    0.5114       681

2024-08-16 13:28:29.712 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5213
2024-08-16 13:28:29.716 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:28:29.716 | INFO     | __main__:eval:454 - Validation loss: 3.9461101943796333
2024-08-16 13:28:29.722 | INFO     | __main__:train:256 - epochs: 22
2024-08-16 13:28:29.723 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566]
2024-08-16 13:28:29.723 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333]
2024-08-16 13:28:29.723 | INFO     | __main__:train:159 - ====epoch #23====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:55,  3.51s/it]
Training:   2%|▏         | 2/85 [00:06<04:44,  3.43s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.42s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.40s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.40s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:24,  3.39s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:15,  3.40s/it]
Training:  13%|█▎        | 11/85 [00:37<04:11,  3.39s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.39s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.39s/it]
Training:  18%|█▊        | 15/85 [00:50<03:57,  3.39s/it]
Training:  19%|█▉        | 16/85 [00:54<03:53,  3.38s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.38s/it]
Training:  21%|██        | 18/85 [01:01<03:46,  3.38s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.38s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:11<03:36,  3.39s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.39s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.39s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.38s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.37s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:06,  3.39s/it]
Training:  36%|███▋      | 31/85 [01:45<03:02,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.38s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.38s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.39s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.38s/it]
Training:  45%|████▍     | 38/85 [02:08<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.39s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.39s/it]
Training:  48%|████▊     | 41/85 [02:18<02:29,  3.39s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.39s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.39s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.39s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.38s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.38s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:55,  3.39s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.38s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.38s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.39s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:34,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.39s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:28,  3.39s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.39s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.39s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.38s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.38s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.38s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.38s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.38s/it]
Training:  81%|████████  | 69/85 [03:53<00:54,  3.38s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.38s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.39s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:44,  3.39s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.39s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.39s/it]
Training:  88%|████████▊ | 75/85 [04:14<00:34,  3.44s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.43s/it]
Training:  91%|█████████ | 77/85 [04:20<00:27,  3.41s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:31<00:16,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.39s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.39s/it]
Training:  98%|█████████▊| 83/85 [04:41<00:06,  3.39s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.39s/it]
Training: 100%|██████████| 85/85 [04:48<00:00,  3.39s/it]
Training: 100%|██████████| 85/85 [04:48<00:00,  3.39s/it]
2024-08-16 13:33:17.761 | INFO     | __main__:train:207 - Epoch 23 Average Loss: 2.54116
2024-08-16 13:33:18.475 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL23*****
2024-08-16 13:33:18.475 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:33:18.475 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.07it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.23it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.26it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.68it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.32it/s]
2024-08-16 13:33:35.175 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7000    0.3333    0.4516        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.6667    0.1905    0.2963        42
                     fill-mask     0.2667    0.2667    0.2667        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.9167    0.9565        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1000    0.0588    0.0741        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.5000    0.1176    0.1905        17
            question-answering     0.3594    0.3898    0.3740        59
           sentence-similarity     0.4231    0.3235    0.3667        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4300    0.4479    0.4388        96
               text-generation     0.9512    0.8864    0.9176        44
                text-to-speech     0.5000    0.5000    0.5000         2
          text2text-generation     0.8621    0.8621    0.8621        58
          token-classification     0.2787    0.3148    0.2957        54
                   translation     0.7500    0.6000    0.6667        10
                       unknown     0.3241    0.5738    0.4142        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5213       681
                     macro avg     0.6405    0.5930    0.5942       681
                  weighted avg     0.5436    0.5213    0.5128       681

2024-08-16 13:33:35.175 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5213
2024-08-16 13:33:35.178 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:33:35.178 | INFO     | __main__:eval:454 - Validation loss: 3.998409477147189
2024-08-16 13:33:35.184 | INFO     | __main__:train:256 - epochs: 23
2024-08-16 13:33:35.185 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455]
2024-08-16 13:33:35.185 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189]
2024-08-16 13:33:35.185 | INFO     | __main__:train:159 - ====epoch #24====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:46,  3.46s/it]
Training:   4%|▎         | 3/85 [00:10<04:40,  3.42s/it]
Training:   5%|▍         | 4/85 [00:13<04:35,  3.40s/it]
Training:   6%|▌         | 5/85 [00:17<04:30,  3.38s/it]
Training:   7%|▋         | 6/85 [00:20<04:26,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:22,  3.36s/it]
Training:   9%|▉         | 8/85 [00:27<04:18,  3.36s/it]
Training:  11%|█         | 9/85 [00:30<04:14,  3.36s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.39s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:01,  3.41s/it]
Training:  18%|█▊        | 15/85 [00:50<03:58,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.40s/it]
Training:  20%|██        | 17/85 [00:57<03:51,  3.40s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.40s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.39s/it]
Training:  24%|██▎       | 20/85 [01:07<03:40,  3.39s/it]
Training:  25%|██▍       | 21/85 [01:11<03:36,  3.39s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.39s/it]
Training:  27%|██▋       | 23/85 [01:18<03:30,  3.39s/it]
Training:  28%|██▊       | 24/85 [01:21<03:27,  3.40s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:31<03:17,  3.40s/it]
Training:  33%|███▎      | 28/85 [01:35<03:13,  3.40s/it]
Training:  34%|███▍      | 29/85 [01:38<03:10,  3.40s/it]
Training:  35%|███▌      | 30/85 [01:41<03:06,  3.40s/it]
Training:  36%|███▋      | 31/85 [01:45<03:03,  3.40s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.38s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:02<02:46,  3.39s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.39s/it]
Training:  45%|████▍     | 38/85 [02:08<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.38s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.39s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.39s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.36s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:17,  3.36s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:14,  3.36s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:11,  3.36s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:07,  3.36s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:04,  3.36s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:00,  3.35s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:57,  3.35s/it]
Training:  60%|██████    | 51/85 [02:52<01:53,  3.35s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.35s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:47,  3.35s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:43,  3.34s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.35s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.35s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:33,  3.35s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.35s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.35s/it]
Training:  71%|███████   | 60/85 [03:22<01:23,  3.35s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:16,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:13,  3.34s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.34s/it]
Training:  76%|███████▋  | 65/85 [03:39<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.34s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:49<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.34s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:06<00:40,  3.34s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:36,  3.34s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.34s/it]
Training:  89%|████████▉ | 76/85 [04:16<00:30,  3.35s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.38s/it]
Training:  93%|█████████▎| 79/85 [04:26<00:20,  3.38s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.37s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.35s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:43<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.36s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
2024-08-16 13:38:21.669 | INFO     | __main__:train:207 - Epoch 24 Average Loss: 2.53623
2024-08-16 13:38:22.379 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL24*****
2024-08-16 13:38:22.379 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:38:22.379 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.02it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.21it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.26it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.27it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.27it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.28it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.28it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.28it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.28it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.29it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.29it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.29it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.68it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.31it/s]
2024-08-16 13:38:39.131 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7000    0.3333    0.4516        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5238    0.2619    0.3492        42
                     fill-mask     0.3000    0.3000    0.3000        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.9167    0.9565        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1111    0.0588    0.0769        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.1818    0.1176    0.1429        17
            question-answering     0.3500    0.3559    0.3529        59
           sentence-similarity     0.3250    0.3824    0.3514        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4545    0.3646    0.4046        96
               text-generation     0.9512    0.8864    0.9176        44
                text-to-speech     0.5000    0.5000    0.5000         2
          text2text-generation     0.8929    0.8621    0.8772        58
          token-classification     0.2388    0.2963    0.2645        54
                   translation     0.6667    0.6000    0.6316        10
                       unknown     0.3366    0.5574    0.4198        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5140       681
                     macro avg     0.6153    0.5935    0.5909       681
                  weighted avg     0.5272    0.5140    0.5093       681

2024-08-16 13:38:39.132 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.514
2024-08-16 13:38:39.134 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:38:39.135 | INFO     | __main__:eval:454 - Validation loss: 3.928745139728893
2024-08-16 13:38:39.142 | INFO     | __main__:train:256 - epochs: 24
2024-08-16 13:38:39.142 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295]
2024-08-16 13:38:39.142 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893]
2024-08-16 13:38:39.142 | INFO     | __main__:train:159 - ====epoch #25====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:51,  3.47s/it]
Training:   2%|▏         | 2/85 [00:06<04:42,  3.41s/it]
Training:   4%|▎         | 3/85 [00:10<04:36,  3.38s/it]
Training:   5%|▍         | 4/85 [00:13<04:32,  3.37s/it]
Training:   6%|▌         | 5/85 [00:16<04:28,  3.35s/it]
Training:   7%|▋         | 6/85 [00:20<04:24,  3.35s/it]
Training:   8%|▊         | 7/85 [00:23<04:21,  3.35s/it]
Training:   9%|▉         | 8/85 [00:26<04:18,  3.35s/it]
Training:  11%|█         | 9/85 [00:30<04:14,  3.35s/it]
Training:  12%|█▏        | 10/85 [00:33<04:11,  3.35s/it]
Training:  13%|█▎        | 11/85 [00:36<04:08,  3.35s/it]
Training:  14%|█▍        | 12/85 [00:40<04:04,  3.35s/it]
Training:  15%|█▌        | 13/85 [00:43<04:01,  3.35s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.35s/it]
Training:  18%|█▊        | 15/85 [00:50<03:54,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:53<03:51,  3.36s/it]
Training:  20%|██        | 17/85 [00:57<03:48,  3.35s/it]
Training:  21%|██        | 18/85 [01:00<03:44,  3.35s/it]
Training:  22%|██▏       | 19/85 [01:03<03:41,  3.35s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.35s/it]
Training:  25%|██▍       | 21/85 [01:10<03:33,  3.34s/it]
Training:  26%|██▌       | 22/85 [01:13<03:30,  3.34s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.34s/it]
Training:  28%|██▊       | 24/85 [01:20<03:24,  3.35s/it]
Training:  29%|██▉       | 25/85 [01:23<03:20,  3.35s/it]
Training:  31%|███       | 26/85 [01:27<03:17,  3.34s/it]
Training:  32%|███▏      | 27/85 [01:30<03:13,  3.34s/it]
Training:  33%|███▎      | 28/85 [01:33<03:10,  3.34s/it]
Training:  34%|███▍      | 29/85 [01:37<03:07,  3.34s/it]
Training:  35%|███▌      | 30/85 [01:40<03:03,  3.34s/it]
Training:  36%|███▋      | 31/85 [01:43<03:00,  3.35s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.35s/it]
Training:  39%|███▉      | 33/85 [01:50<02:54,  3.35s/it]
Training:  40%|████      | 34/85 [01:53<02:51,  3.35s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.35s/it]
Training:  42%|████▏     | 36/85 [02:00<02:44,  3.36s/it]
Training:  44%|████▎     | 37/85 [02:04<02:40,  3.35s/it]
Training:  45%|████▍     | 38/85 [02:07<02:37,  3.35s/it]
Training:  46%|████▌     | 39/85 [02:10<02:34,  3.35s/it]
Training:  47%|████▋     | 40/85 [02:14<02:30,  3.35s/it]
Training:  48%|████▊     | 41/85 [02:17<02:27,  3.35s/it]
Training:  49%|████▉     | 42/85 [02:20<02:23,  3.35s/it]
Training:  51%|█████     | 43/85 [02:24<02:20,  3.35s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:17,  3.35s/it]
Training:  53%|█████▎    | 45/85 [02:30<02:13,  3.35s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:10,  3.34s/it]
Training:  55%|█████▌    | 47/85 [02:37<02:07,  3.34s/it]
Training:  56%|█████▋    | 48/85 [02:40<02:03,  3.34s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:00,  3.34s/it]
Training:  59%|█████▉    | 50/85 [02:47<01:56,  3.34s/it]
Training:  60%|██████    | 51/85 [02:50<01:53,  3.34s/it]
Training:  61%|██████    | 52/85 [02:54<01:50,  3.35s/it]
Training:  62%|██████▏   | 53/85 [02:57<01:47,  3.35s/it]
Training:  64%|██████▎   | 54/85 [03:00<01:43,  3.34s/it]
Training:  65%|██████▍   | 55/85 [03:04<01:40,  3.35s/it]
Training:  66%|██████▌   | 56/85 [03:07<01:37,  3.35s/it]
Training:  67%|██████▋   | 57/85 [03:10<01:33,  3.35s/it]
Training:  68%|██████▊   | 58/85 [03:14<01:30,  3.35s/it]
Training:  69%|██████▉   | 59/85 [03:17<01:27,  3.35s/it]
Training:  71%|███████   | 60/85 [03:21<01:23,  3.36s/it]
Training:  72%|███████▏  | 61/85 [03:24<01:20,  3.35s/it]
Training:  73%|███████▎  | 62/85 [03:27<01:17,  3.35s/it]
Training:  74%|███████▍  | 63/85 [03:31<01:13,  3.35s/it]
Training:  75%|███████▌  | 64/85 [03:34<01:10,  3.35s/it]
Training:  76%|███████▋  | 65/85 [03:37<01:06,  3.35s/it]
Training:  78%|███████▊  | 66/85 [03:41<01:03,  3.35s/it]
Training:  79%|███████▉  | 67/85 [03:44<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:47<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:51<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:54<00:50,  3.35s/it]
Training:  84%|████████▎ | 71/85 [03:57<00:46,  3.33s/it]
Training:  85%|████████▍ | 72/85 [04:01<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:04<00:40,  3.34s/it]
Training:  87%|████████▋ | 74/85 [04:07<00:36,  3.34s/it]
Training:  88%|████████▊ | 75/85 [04:11<00:33,  3.34s/it]
Training:  89%|████████▉ | 76/85 [04:14<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:17<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:21<00:23,  3.35s/it]
Training:  93%|█████████▎| 79/85 [04:24<00:20,  3.35s/it]
Training:  94%|█████████▍| 80/85 [04:27<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:31<00:13,  3.33s/it]
Training:  96%|█████████▋| 82/85 [04:34<00:10,  3.34s/it]
Training:  98%|█████████▊| 83/85 [04:37<00:06,  3.34s/it]
Training:  99%|█████████▉| 84/85 [04:41<00:03,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.34s/it]
Training: 100%|██████████| 85/85 [04:44<00:00,  3.35s/it]
2024-08-16 13:43:23.785 | INFO     | __main__:train:207 - Epoch 25 Average Loss: 2.50531
2024-08-16 13:43:24.490 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL25*****
2024-08-16 13:43:24.490 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:43:24.490 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.04it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:08,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.25it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 13:43:41.621 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6809    0.9412    0.7901        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.4783    0.2619    0.3385        42
                     fill-mask     0.2982    0.2833    0.2906        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     0.9231    1.0000    0.9600        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1250    0.0588    0.0800        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2500    0.1176    0.1600        17
            question-answering     0.4079    0.5254    0.4593        59
           sentence-similarity     0.3514    0.3824    0.3662        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4444    0.3750    0.4068        96
               text-generation     0.9500    0.8636    0.9048        44
                text-to-speech     0.5000    0.5000    0.5000         2
          text2text-generation     0.8361    0.8793    0.8571        58
          token-classification     0.2432    0.3333    0.2812        54
                   translation     0.8571    0.6000    0.7059        10
                       unknown     0.3165    0.4098    0.3571        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5213       681
                     macro avg     0.6242    0.6013    0.5992       681
                  weighted avg     0.5284    0.5213    0.5153       681

2024-08-16 13:43:41.621 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5213
2024-08-16 13:43:41.633 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:43:41.633 | INFO     | __main__:eval:454 - Validation loss: 3.9679910378022627
2024-08-16 13:43:41.638 | INFO     | __main__:train:256 - epochs: 25
2024-08-16 13:43:41.638 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563]
2024-08-16 13:43:41.638 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627]
2024-08-16 13:43:41.638 | INFO     | __main__:train:159 - ====epoch #26====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:55,  3.52s/it]
Training:   2%|▏         | 2/85 [00:06<04:47,  3.47s/it]
Training:   4%|▎         | 3/85 [00:10<04:42,  3.44s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.42s/it]
Training:   6%|▌         | 5/85 [00:17<04:32,  3.40s/it]
Training:   7%|▋         | 6/85 [00:20<04:28,  3.40s/it]
Training:   8%|▊         | 7/85 [00:23<04:25,  3.40s/it]
Training:   9%|▉         | 8/85 [00:27<04:21,  3.40s/it]
Training:  11%|█         | 9/85 [00:30<04:18,  3.40s/it]
Training:  12%|█▏        | 10/85 [00:34<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.38s/it]
Training:  14%|█▍        | 12/85 [00:40<04:06,  3.38s/it]
Training:  15%|█▌        | 13/85 [00:44<04:02,  3.37s/it]
Training:  16%|█▋        | 14/85 [00:47<03:57,  3.35s/it]
Training:  18%|█▊        | 15/85 [00:50<03:54,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:54<03:51,  3.36s/it]
Training:  20%|██        | 17/85 [00:57<03:48,  3.36s/it]
Training:  21%|██        | 18/85 [01:00<03:44,  3.36s/it]
Training:  22%|██▏       | 19/85 [01:04<03:41,  3.36s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.37s/it]
Training:  25%|██▍       | 21/85 [01:11<03:35,  3.37s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.37s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.37s/it]
Training:  28%|██▊       | 24/85 [01:21<03:25,  3.37s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.37s/it]
Training:  31%|███       | 26/85 [01:27<03:18,  3.37s/it]
Training:  32%|███▏      | 27/85 [01:31<03:15,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.36s/it]
Training:  36%|███▋      | 31/85 [01:44<03:01,  3.36s/it]
Training:  38%|███▊      | 32/85 [01:48<02:58,  3.37s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.37s/it]
Training:  40%|████      | 34/85 [01:54<02:51,  3.37s/it]
Training:  41%|████      | 35/85 [01:58<02:48,  3.37s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.37s/it]
Training:  44%|████▎     | 37/85 [02:04<02:41,  3.37s/it]
Training:  45%|████▍     | 38/85 [02:08<02:38,  3.36s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.36s/it]
Training:  47%|████▋     | 40/85 [02:15<02:31,  3.36s/it]
Training:  48%|████▊     | 41/85 [02:18<02:27,  3.36s/it]
Training:  49%|████▉     | 42/85 [02:21<02:24,  3.37s/it]
Training:  51%|█████     | 43/85 [02:25<02:21,  3.37s/it]
Training:  52%|█████▏    | 44/85 [02:28<02:18,  3.37s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:14,  3.36s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:10,  3.35s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:07,  3.36s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:04,  3.35s/it]
Training:  58%|█████▊    | 49/85 [02:45<02:00,  3.34s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:57,  3.34s/it]
Training:  60%|██████    | 51/85 [02:51<01:53,  3.35s/it]
Training:  61%|██████    | 52/85 [02:55<01:50,  3.35s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:47,  3.35s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:43,  3.35s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:40,  3.35s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:37,  3.35s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:33,  3.35s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:30,  3.34s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.35s/it]
Training:  71%|███████   | 60/85 [03:22<01:23,  3.34s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.34s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:16,  3.34s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:13,  3.34s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.34s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:06,  3.34s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.34s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.34s/it]
Training:  80%|████████  | 68/85 [03:48<00:56,  3.34s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.34s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.34s/it]
Training:  84%|████████▎ | 71/85 [03:58<00:46,  3.34s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.34s/it]
Training:  86%|████████▌ | 73/85 [04:05<00:40,  3.35s/it]
Training:  87%|████████▋ | 74/85 [04:08<00:36,  3.35s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.35s/it]
Training:  89%|████████▉ | 76/85 [04:15<00:30,  3.34s/it]
Training:  91%|█████████ | 77/85 [04:18<00:26,  3.34s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.34s/it]
Training:  93%|█████████▎| 79/85 [04:25<00:20,  3.34s/it]
Training:  94%|█████████▍| 80/85 [04:28<00:16,  3.34s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.34s/it]
Training:  96%|█████████▋| 82/85 [04:35<00:10,  3.35s/it]
Training:  98%|█████████▊| 83/85 [04:38<00:06,  3.35s/it]
Training:  99%|█████████▉| 84/85 [04:42<00:03,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:45<00:00,  3.36s/it]
2024-08-16 13:48:27.283 | INFO     | __main__:train:207 - Epoch 26 Average Loss: 2.59512
2024-08-16 13:48:27.986 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL26*****
2024-08-16 13:48:27.986 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:48:27.986 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.08it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.20it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.24it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.24it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.25it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.25it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.26it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.27it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.26it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.27it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.26it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.26it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.63it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 13:48:45.009 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6667    0.9412    0.7805        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5000    0.1667    0.2500        42
                     fill-mask     0.2759    0.2667    0.2712        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.9167    0.9565        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.2500    0.1176    0.1600        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2857    0.1176    0.1667        17
            question-answering     0.3509    0.3390    0.3448        59
           sentence-similarity     0.3824    0.3824    0.3824        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4304    0.3542    0.3886        96
               text-generation     0.9250    0.8409    0.8810        44
                text-to-speech     0.5000    0.5000    0.5000         2
          text2text-generation     0.8500    0.8793    0.8644        58
          token-classification     0.2581    0.2963    0.2759        54
                   translation     0.8571    0.6000    0.7059        10
                       unknown     0.3413    0.7049    0.4599        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5169       681
                     macro avg     0.6334    0.5966    0.5962       681
                  weighted avg     0.5301    0.5169    0.5060       681

2024-08-16 13:48:45.009 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5169
2024-08-16 13:48:45.012 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:48:45.012 | INFO     | __main__:eval:454 - Validation loss: 3.9991576238112017
2024-08-16 13:48:45.019 | INFO     | __main__:train:256 - epochs: 26
2024-08-16 13:48:45.021 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563, 2.5951157443663653]
2024-08-16 13:48:45.021 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627, 3.9991576238112017]
2024-08-16 13:48:45.021 | INFO     | __main__:train:159 - ====epoch #27====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:57,  3.54s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:41,  3.43s/it]
Training:   5%|▍         | 4/85 [00:13<04:36,  3.41s/it]
Training:   6%|▌         | 5/85 [00:17<04:31,  3.39s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.39s/it]
Training:   8%|▊         | 7/85 [00:23<04:24,  3.39s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:33<04:12,  3.37s/it]
Training:  13%|█▎        | 11/85 [00:37<04:09,  3.37s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.37s/it]
Training:  15%|█▌        | 13/85 [00:44<04:02,  3.37s/it]
Training:  16%|█▋        | 14/85 [00:47<03:59,  3.37s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.37s/it]
Training:  19%|█▉        | 16/85 [00:54<03:52,  3.37s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.39s/it]
Training:  21%|██        | 18/85 [01:00<03:47,  3.39s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.39s/it]
Training:  24%|██▎       | 20/85 [01:07<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.39s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:17<03:30,  3.39s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.39s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:08,  3.37s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.37s/it]
Training:  36%|███▋      | 31/85 [01:44<03:02,  3.37s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:51<02:55,  3.38s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.38s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:02<02:50,  3.48s/it]
Training:  44%|████▎     | 37/85 [02:05<02:45,  3.46s/it]
Training:  45%|████▍     | 38/85 [02:08<02:41,  3.44s/it]
Training:  46%|████▌     | 39/85 [02:12<02:37,  3.43s/it]
Training:  47%|████▋     | 40/85 [02:15<02:33,  3.42s/it]
Training:  48%|████▊     | 41/85 [02:19<02:29,  3.40s/it]
Training:  49%|████▉     | 42/85 [02:22<02:26,  3.40s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.39s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:16,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.40s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.39s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:02,  3.39s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.39s/it]
Training:  60%|██████    | 51/85 [02:53<01:55,  3.38s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:03<01:44,  3.38s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.38s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.38s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:34,  3.38s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:20<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.38s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.38s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:17,  3.39s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.38s/it]
Training:  75%|███████▌  | 64/85 [03:37<01:11,  3.38s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.39s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.39s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:00,  3.39s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.38s/it]
Training:  81%|████████  | 69/85 [03:53<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:57<00:50,  3.38s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.38s/it]
Training:  85%|████████▍ | 72/85 [04:04<00:43,  3.38s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.38s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.38s/it]
Training:  88%|████████▊ | 75/85 [04:14<00:33,  3.38s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.38s/it]
Training:  91%|█████████ | 77/85 [04:20<00:26,  3.36s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.36s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:31<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.38s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.38s/it]
Training:  98%|█████████▊| 83/85 [04:41<00:06,  3.38s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.37s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.39s/it]
2024-08-16 13:53:32.953 | INFO     | __main__:train:207 - Epoch 27 Average Loss: 2.53043
2024-08-16 13:53:33.662 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL27*****
2024-08-16 13:53:33.662 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:53:33.662 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.08it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.17it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.26it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.27it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.28it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.28it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.68it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.32it/s]
2024-08-16 13:53:50.381 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6809    0.9412    0.7901        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.4737    0.2143    0.2951        42
                     fill-mask     0.2833    0.2833    0.2833        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     0.9231    1.0000    0.9600        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.0000    0.0000       nan        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2000    0.1176    0.1481        17
            question-answering     0.3729    0.3729    0.3729        59
           sentence-similarity     0.3514    0.3824    0.3662        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.5000    0.3646    0.4217        96
               text-generation     0.9250    0.8409    0.8810        44
                text-to-speech     1.0000    0.5000    0.6667         2
          text2text-generation     0.8644    0.8793    0.8718        58
          token-classification     0.2692    0.3889    0.3182        54
                   translation     0.8571    0.6000    0.7059        10
                       unknown     0.3365    0.5738    0.4242        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5198       681
                     macro avg     0.6405    0.5981    0.6286       681
                  weighted avg     0.5334    0.5198    0.5266       681

2024-08-16 13:53:50.382 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5198
2024-08-16 13:53:50.384 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:53:50.385 | INFO     | __main__:eval:454 - Validation loss: 3.994490872729908
2024-08-16 13:53:50.389 | INFO     | __main__:train:256 - epochs: 27
2024-08-16 13:53:50.390 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563, 2.5951157443663653, 2.530434283088235]
2024-08-16 13:53:50.390 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627, 3.9991576238112017, 3.994490872729908]
2024-08-16 13:53:50.390 | INFO     | __main__:train:159 - ====epoch #28====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:54,  3.50s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:38,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.38s/it]
Training:   6%|▌         | 5/85 [00:16<04:30,  3.38s/it]
Training:   7%|▋         | 6/85 [00:20<04:27,  3.38s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.38s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.38s/it]
Training:  12%|█▏        | 10/85 [00:33<04:13,  3.38s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.39s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.39s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.39s/it]
Training:  18%|█▊        | 15/85 [00:50<03:57,  3.40s/it]
Training:  19%|█▉        | 16/85 [00:54<03:54,  3.39s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.39s/it]
Training:  21%|██        | 18/85 [01:01<03:47,  3.39s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.39s/it]
Training:  24%|██▎       | 20/85 [01:07<03:40,  3.40s/it]
Training:  25%|██▍       | 21/85 [01:11<03:37,  3.39s/it]
Training:  26%|██▌       | 22/85 [01:14<03:32,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.38s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.39s/it]
Training:  29%|██▉       | 25/85 [01:24<03:23,  3.39s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.38s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:05,  3.38s/it]
Training:  36%|███▋      | 31/85 [01:45<03:02,  3.38s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.38s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.39s/it]
Training:  40%|████      | 34/85 [01:55<02:53,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:01<02:45,  3.39s/it]
Training:  44%|████▎     | 37/85 [02:05<02:42,  3.39s/it]
Training:  45%|████▍     | 38/85 [02:08<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:35,  3.39s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.39s/it]
Training:  48%|████▊     | 41/85 [02:18<02:29,  3.39s/it]
Training:  49%|████▉     | 42/85 [02:22<02:25,  3.39s/it]
Training:  51%|█████     | 43/85 [02:25<02:22,  3.39s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:18,  3.39s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.39s/it]
Training:  54%|█████▍    | 46/85 [02:35<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.39s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:01,  3.39s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.38s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.37s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.38s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.39s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:45,  3.39s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.39s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:38,  3.39s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:35,  3.40s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:31,  3.39s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:28,  3.39s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.39s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:21,  3.39s/it]
Training:  73%|███████▎  | 62/85 [03:30<01:18,  3.39s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.40s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:11,  3.39s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.39s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.39s/it]
Training:  79%|███████▉  | 67/85 [03:47<01:01,  3.39s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.39s/it]
Training:  81%|████████  | 69/85 [03:53<00:54,  3.39s/it]
Training:  82%|████████▏ | 70/85 [03:57<00:50,  3.39s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.38s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:44,  3.39s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.40s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.39s/it]
Training:  88%|████████▊ | 75/85 [04:14<00:33,  3.40s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.40s/it]
Training:  91%|█████████ | 77/85 [04:21<00:27,  3.40s/it]
Training:  92%|█████████▏| 78/85 [04:24<00:23,  3.40s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.40s/it]
Training:  94%|█████████▍| 80/85 [04:31<00:17,  3.40s/it]
Training:  95%|█████████▌| 81/85 [04:34<00:13,  3.40s/it]
Training:  96%|█████████▋| 82/85 [04:38<00:10,  3.40s/it]
Training:  98%|█████████▊| 83/85 [04:41<00:06,  3.40s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.40s/it]
Training: 100%|██████████| 85/85 [04:48<00:00,  3.40s/it]
Training: 100%|██████████| 85/85 [04:48<00:00,  3.39s/it]
2024-08-16 13:58:38.621 | INFO     | __main__:train:207 - Epoch 28 Average Loss: 2.54240
2024-08-16 13:58:39.329 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL28*****
2024-08-16 13:58:39.329 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 13:58:39.329 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:18,  1.11it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:16,  1.20it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.24it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.26it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.27it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.28it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:11,  1.29it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:10,  1.29it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.29it/s]
Evaluating:  45%|████▌     | 10/22 [00:07<00:09,  1.29it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.29it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.29it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:06,  1.29it/s]
Evaluating:  64%|██████▎   | 14/22 [00:10<00:06,  1.29it/s]
Evaluating:  68%|██████▊   | 15/22 [00:11<00:05,  1.29it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.29it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.29it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.30it/s]
Evaluating:  86%|████████▋ | 19/22 [00:14<00:02,  1.30it/s]
Evaluating:  91%|█████████ | 20/22 [00:15<00:01,  1.30it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.30it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.68it/s]
Evaluating: 100%|██████████| 22/22 [00:16<00:00,  1.33it/s]
2024-08-16 13:58:55.952 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5000    0.2857    0.3636        42
                     fill-mask     0.2857    0.2333    0.2569        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    1.0000    1.0000        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1111    0.0588    0.0769        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2143    0.1765    0.1935        17
            question-answering     0.3731    0.4237    0.3968        59
           sentence-similarity     0.3824    0.3824    0.3824        34
                 summarization     0.6000    1.0000    0.7500         3
           text-classification     0.4625    0.3854    0.4205        96
               text-generation     0.9268    0.8636    0.8941        44
                text-to-speech     1.0000    0.5000    0.6667         2
          text2text-generation     0.8644    0.8793    0.8718        58
          token-classification     0.2532    0.3704    0.3008        54
                   translation     0.8333    0.5000    0.6250        10
                       unknown     0.3218    0.4590    0.3784        61
      zero-shot-classification     0.7500    0.3750    0.5000         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5213       681
                     macro avg     0.6547    0.6181    0.6190       681
                  weighted avg     0.5332    0.5213    0.5175       681

2024-08-16 13:58:55.952 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5213
2024-08-16 13:58:55.956 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 13:58:55.956 | INFO     | __main__:eval:454 - Validation loss: 4.003542271527377
2024-08-16 13:58:55.961 | INFO     | __main__:train:256 - epochs: 28
2024-08-16 13:58:55.961 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563, 2.5951157443663653, 2.530434283088235, 2.542398609834559]
2024-08-16 13:58:55.961 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627, 3.9991576238112017, 3.994490872729908, 4.003542271527377]
2024-08-16 13:58:55.961 | INFO     | __main__:train:159 - ====epoch #29====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:58,  3.55s/it]
Training:   2%|▏         | 2/85 [00:06<04:45,  3.44s/it]
Training:   4%|▎         | 3/85 [00:10<04:39,  3.41s/it]
Training:   5%|▍         | 4/85 [00:13<04:34,  3.39s/it]
Training:   6%|▌         | 5/85 [00:17<04:30,  3.38s/it]
Training:   7%|▋         | 6/85 [00:20<04:25,  3.37s/it]
Training:   8%|▊         | 7/85 [00:23<04:22,  3.37s/it]
Training:   9%|▉         | 8/85 [00:27<04:18,  3.36s/it]
Training:  11%|█         | 9/85 [00:30<04:15,  3.36s/it]
Training:  12%|█▏        | 10/85 [00:33<04:11,  3.36s/it]
Training:  13%|█▎        | 11/85 [00:37<04:08,  3.36s/it]
Training:  14%|█▍        | 12/85 [00:40<04:05,  3.36s/it]
Training:  15%|█▌        | 13/85 [00:43<04:01,  3.36s/it]
Training:  16%|█▋        | 14/85 [00:47<03:58,  3.36s/it]
Training:  18%|█▊        | 15/85 [00:50<03:55,  3.36s/it]
Training:  19%|█▉        | 16/85 [00:53<03:51,  3.35s/it]
Training:  20%|██        | 17/85 [00:57<03:48,  3.35s/it]
Training:  21%|██        | 18/85 [01:00<03:45,  3.36s/it]
Training:  22%|██▏       | 19/85 [01:03<03:41,  3.35s/it]
Training:  24%|██▎       | 20/85 [01:07<03:37,  3.35s/it]
Training:  25%|██▍       | 21/85 [01:10<03:34,  3.35s/it]
Training:  26%|██▌       | 22/85 [01:14<03:30,  3.35s/it]
Training:  27%|██▋       | 23/85 [01:17<03:27,  3.35s/it]
Training:  28%|██▊       | 24/85 [01:20<03:24,  3.35s/it]
Training:  29%|██▉       | 25/85 [01:24<03:21,  3.35s/it]
Training:  31%|███       | 26/85 [01:27<03:17,  3.35s/it]
Training:  32%|███▏      | 27/85 [01:30<03:14,  3.36s/it]
Training:  33%|███▎      | 28/85 [01:34<03:11,  3.36s/it]
Training:  34%|███▍      | 29/85 [01:37<03:07,  3.35s/it]
Training:  35%|███▌      | 30/85 [01:40<03:04,  3.35s/it]
Training:  36%|███▋      | 31/85 [01:44<03:00,  3.35s/it]
Training:  38%|███▊      | 32/85 [01:47<02:57,  3.35s/it]
Training:  39%|███▉      | 33/85 [01:50<02:54,  3.35s/it]
Training:  40%|████      | 34/85 [01:54<02:50,  3.35s/it]
Training:  41%|████      | 35/85 [01:57<02:47,  3.35s/it]
Training:  42%|████▏     | 36/85 [02:00<02:44,  3.35s/it]
Training:  44%|████▎     | 37/85 [02:04<02:40,  3.35s/it]
Training:  45%|████▍     | 38/85 [02:07<02:37,  3.35s/it]
Training:  46%|████▌     | 39/85 [02:11<02:34,  3.36s/it]
Training:  47%|████▋     | 40/85 [02:14<02:30,  3.36s/it]
Training:  48%|████▊     | 41/85 [02:17<02:28,  3.37s/it]
Training:  49%|████▉     | 42/85 [02:21<02:25,  3.38s/it]
Training:  51%|█████     | 43/85 [02:24<02:22,  3.38s/it]
Training:  52%|█████▏    | 44/85 [02:27<02:18,  3.38s/it]
Training:  53%|█████▎    | 45/85 [02:31<02:15,  3.39s/it]
Training:  54%|█████▍    | 46/85 [02:34<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:38<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:41<02:05,  3.39s/it]
Training:  58%|█████▊    | 49/85 [02:44<02:02,  3.40s/it]
Training:  59%|█████▉    | 50/85 [02:48<01:58,  3.40s/it]
Training:  60%|██████    | 51/85 [02:51<01:55,  3.40s/it]
Training:  61%|██████    | 52/85 [02:55<01:51,  3.39s/it]
Training:  62%|██████▏   | 53/85 [02:58<01:48,  3.39s/it]
Training:  64%|██████▎   | 54/85 [03:01<01:45,  3.39s/it]
Training:  65%|██████▍   | 55/85 [03:05<01:41,  3.39s/it]
Training:  66%|██████▌   | 56/85 [03:08<01:38,  3.39s/it]
Training:  67%|██████▋   | 57/85 [03:12<01:35,  3.39s/it]
Training:  68%|██████▊   | 58/85 [03:15<01:31,  3.39s/it]
Training:  69%|██████▉   | 59/85 [03:18<01:27,  3.38s/it]
Training:  71%|███████   | 60/85 [03:22<01:24,  3.37s/it]
Training:  72%|███████▏  | 61/85 [03:25<01:20,  3.37s/it]
Training:  73%|███████▎  | 62/85 [03:28<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:32<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:35<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:38<01:07,  3.36s/it]
Training:  78%|███████▊  | 66/85 [03:42<01:03,  3.36s/it]
Training:  79%|███████▉  | 67/85 [03:45<01:00,  3.36s/it]
Training:  80%|████████  | 68/85 [03:49<00:57,  3.36s/it]
Training:  81%|████████  | 69/85 [03:52<00:53,  3.35s/it]
Training:  82%|████████▏ | 70/85 [03:55<00:50,  3.36s/it]
Training:  84%|████████▎ | 71/85 [03:59<00:47,  3.36s/it]
Training:  85%|████████▍ | 72/85 [04:02<00:43,  3.36s/it]
Training:  86%|████████▌ | 73/85 [04:05<00:40,  3.36s/it]
Training:  87%|████████▋ | 74/85 [04:09<00:36,  3.36s/it]
Training:  88%|████████▊ | 75/85 [04:12<00:33,  3.36s/it]
Training:  89%|████████▉ | 76/85 [04:15<00:30,  3.35s/it]
Training:  91%|█████████ | 77/85 [04:19<00:26,  3.35s/it]
Training:  92%|█████████▏| 78/85 [04:22<00:23,  3.36s/it]
Training:  93%|█████████▎| 79/85 [04:25<00:20,  3.35s/it]
Training:  94%|█████████▍| 80/85 [04:29<00:16,  3.35s/it]
Training:  95%|█████████▌| 81/85 [04:32<00:13,  3.36s/it]
Training:  96%|█████████▋| 82/85 [04:36<00:10,  3.36s/it]
Training:  98%|█████████▊| 83/85 [04:39<00:06,  3.36s/it]
Training:  99%|█████████▉| 84/85 [04:42<00:03,  3.36s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.35s/it]
Training: 100%|██████████| 85/85 [04:46<00:00,  3.37s/it]
2024-08-16 14:03:42.095 | INFO     | __main__:train:207 - Epoch 29 Average Loss: 2.53340
2024-08-16 14:03:42.814 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL29*****
2024-08-16 14:03:42.814 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:03:42.814 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:20,  1.03it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.15it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.23it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.26it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.26it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 14:03:59.939 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6809    0.9412    0.7901        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5652    0.3095    0.4000        42
                     fill-mask     0.2742    0.2833    0.2787        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    0.9167    0.9565        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1667    0.1176    0.1379        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.1818    0.1176    0.1429        17
            question-answering     0.3396    0.3051    0.3214        59
           sentence-similarity     0.3514    0.3824    0.3662        34
                 summarization     0.5000    0.6667    0.5714         3
           text-classification     0.4359    0.3542    0.3908        96
               text-generation     0.9024    0.8409    0.8706        44
                text-to-speech     1.0000    0.5000    0.6667         2
          text2text-generation     0.8387    0.8966    0.8667        58
          token-classification     0.2459    0.2778    0.2609        54
                   translation     1.0000    0.6000    0.7500        10
                       unknown     0.3303    0.5902    0.4235        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     1.0000    1.0000    1.0000         4

                      accuracy                         0.5140       681
                     macro avg     0.6612    0.5970    0.6112       681
                  weighted avg     0.5286    0.5140    0.5096       681

2024-08-16 14:03:59.939 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.514
2024-08-16 14:03:59.943 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 14:03:59.943 | INFO     | __main__:eval:454 - Validation loss: 4.044064738533714
2024-08-16 14:03:59.948 | INFO     | __main__:train:256 - epochs: 29
2024-08-16 14:03:59.948 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563, 2.5951157443663653, 2.530434283088235, 2.542398609834559, 2.5334042885724237]
2024-08-16 14:03:59.948 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627, 3.9991576238112017, 3.994490872729908, 4.003542271527377, 4.044064738533714]
2024-08-16 14:03:59.948 | INFO     | __main__:train:159 - ====epoch #30====

Training:   0%|          | 0/85 [00:00<?, ?it/s]
Training:   1%|          | 1/85 [00:03<04:55,  3.51s/it]
Training:   2%|▏         | 2/85 [00:06<04:43,  3.42s/it]
Training:   4%|▎         | 3/85 [00:10<04:38,  3.39s/it]
Training:   5%|▍         | 4/85 [00:13<04:33,  3.38s/it]
Training:   6%|▌         | 5/85 [00:16<04:29,  3.37s/it]
Training:   7%|▋         | 6/85 [00:20<04:25,  3.36s/it]
Training:   8%|▊         | 7/85 [00:23<04:23,  3.38s/it]
Training:   9%|▉         | 8/85 [00:27<04:20,  3.39s/it]
Training:  11%|█         | 9/85 [00:30<04:17,  3.39s/it]
Training:  12%|█▏        | 10/85 [00:33<04:14,  3.39s/it]
Training:  13%|█▎        | 11/85 [00:37<04:10,  3.39s/it]
Training:  14%|█▍        | 12/85 [00:40<04:07,  3.38s/it]
Training:  15%|█▌        | 13/85 [00:44<04:04,  3.39s/it]
Training:  16%|█▋        | 14/85 [00:47<04:00,  3.39s/it]
Training:  18%|█▊        | 15/85 [00:50<03:56,  3.38s/it]
Training:  19%|█▉        | 16/85 [00:54<03:53,  3.39s/it]
Training:  20%|██        | 17/85 [00:57<03:50,  3.38s/it]
Training:  21%|██        | 18/85 [01:00<03:46,  3.38s/it]
Training:  22%|██▏       | 19/85 [01:04<03:43,  3.39s/it]
Training:  24%|██▎       | 20/85 [01:07<03:39,  3.38s/it]
Training:  25%|██▍       | 21/85 [01:11<03:36,  3.38s/it]
Training:  26%|██▌       | 22/85 [01:14<03:33,  3.38s/it]
Training:  27%|██▋       | 23/85 [01:17<03:29,  3.39s/it]
Training:  28%|██▊       | 24/85 [01:21<03:26,  3.39s/it]
Training:  29%|██▉       | 25/85 [01:24<03:22,  3.38s/it]
Training:  31%|███       | 26/85 [01:28<03:19,  3.39s/it]
Training:  32%|███▏      | 27/85 [01:31<03:16,  3.38s/it]
Training:  33%|███▎      | 28/85 [01:34<03:12,  3.38s/it]
Training:  34%|███▍      | 29/85 [01:38<03:09,  3.38s/it]
Training:  35%|███▌      | 30/85 [01:41<03:06,  3.39s/it]
Training:  36%|███▋      | 31/85 [01:44<03:03,  3.39s/it]
Training:  38%|███▊      | 32/85 [01:48<02:59,  3.39s/it]
Training:  39%|███▉      | 33/85 [01:51<02:56,  3.39s/it]
Training:  40%|████      | 34/85 [01:55<02:52,  3.39s/it]
Training:  41%|████      | 35/85 [01:58<02:49,  3.39s/it]
Training:  42%|████▏     | 36/85 [02:01<02:46,  3.40s/it]
Training:  44%|████▎     | 37/85 [02:05<02:43,  3.40s/it]
Training:  45%|████▍     | 38/85 [02:08<02:39,  3.39s/it]
Training:  46%|████▌     | 39/85 [02:12<02:36,  3.39s/it]
Training:  47%|████▋     | 40/85 [02:15<02:32,  3.39s/it]
Training:  48%|████▊     | 41/85 [02:19<02:32,  3.46s/it]
Training:  49%|████▉     | 42/85 [02:22<02:27,  3.44s/it]
Training:  51%|█████     | 43/85 [02:25<02:23,  3.41s/it]
Training:  52%|█████▏    | 44/85 [02:29<02:19,  3.40s/it]
Training:  53%|█████▎    | 45/85 [02:32<02:15,  3.40s/it]
Training:  54%|█████▍    | 46/85 [02:36<02:12,  3.39s/it]
Training:  55%|█████▌    | 47/85 [02:39<02:08,  3.39s/it]
Training:  56%|█████▋    | 48/85 [02:42<02:05,  3.38s/it]
Training:  58%|█████▊    | 49/85 [02:46<02:01,  3.38s/it]
Training:  59%|█████▉    | 50/85 [02:49<01:58,  3.37s/it]
Training:  60%|██████    | 51/85 [02:52<01:54,  3.38s/it]
Training:  61%|██████    | 52/85 [02:56<01:51,  3.37s/it]
Training:  62%|██████▏   | 53/85 [02:59<01:48,  3.38s/it]
Training:  64%|██████▎   | 54/85 [03:02<01:44,  3.37s/it]
Training:  65%|██████▍   | 55/85 [03:06<01:41,  3.37s/it]
Training:  66%|██████▌   | 56/85 [03:09<01:37,  3.38s/it]
Training:  67%|██████▋   | 57/85 [03:13<01:34,  3.38s/it]
Training:  68%|██████▊   | 58/85 [03:16<01:30,  3.37s/it]
Training:  69%|██████▉   | 59/85 [03:19<01:27,  3.37s/it]
Training:  71%|███████   | 60/85 [03:23<01:24,  3.37s/it]
Training:  72%|███████▏  | 61/85 [03:26<01:20,  3.37s/it]
Training:  73%|███████▎  | 62/85 [03:29<01:17,  3.37s/it]
Training:  74%|███████▍  | 63/85 [03:33<01:14,  3.37s/it]
Training:  75%|███████▌  | 64/85 [03:36<01:10,  3.37s/it]
Training:  76%|███████▋  | 65/85 [03:40<01:07,  3.37s/it]
Training:  78%|███████▊  | 66/85 [03:43<01:04,  3.37s/it]
Training:  79%|███████▉  | 67/85 [03:46<01:00,  3.38s/it]
Training:  80%|████████  | 68/85 [03:50<00:57,  3.37s/it]
Training:  81%|████████  | 69/85 [03:53<00:53,  3.37s/it]
Training:  82%|████████▏ | 70/85 [03:56<00:50,  3.37s/it]
Training:  84%|████████▎ | 71/85 [04:00<00:47,  3.37s/it]
Training:  85%|████████▍ | 72/85 [04:03<00:43,  3.36s/it]
Training:  86%|████████▌ | 73/85 [04:07<00:40,  3.37s/it]
Training:  87%|████████▋ | 74/85 [04:10<00:37,  3.37s/it]
Training:  88%|████████▊ | 75/85 [04:13<00:33,  3.37s/it]
Training:  89%|████████▉ | 76/85 [04:17<00:30,  3.37s/it]
Training:  91%|█████████ | 77/85 [04:20<00:26,  3.37s/it]
Training:  92%|█████████▏| 78/85 [04:23<00:23,  3.37s/it]
Training:  93%|█████████▎| 79/85 [04:27<00:20,  3.37s/it]
Training:  94%|█████████▍| 80/85 [04:30<00:16,  3.37s/it]
Training:  95%|█████████▌| 81/85 [04:33<00:13,  3.37s/it]
Training:  96%|█████████▋| 82/85 [04:37<00:10,  3.38s/it]
Training:  98%|█████████▊| 83/85 [04:40<00:06,  3.38s/it]
Training:  99%|█████████▉| 84/85 [04:44<00:03,  3.38s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.39s/it]
Training: 100%|██████████| 85/85 [04:47<00:00,  3.38s/it]
2024-08-16 14:08:47.543 | INFO     | __main__:train:207 - Epoch 30 Average Loss: 2.53365
2024-08-16 14:08:48.248 | INFO     | __main__:eval:312 - ***** Running evaluation longformer_CL30*****
2024-08-16 14:08:48.248 | INFO     | __main__:eval:313 -   Num examples = 681
2024-08-16 14:08:48.249 | INFO     | __main__:eval:314 -   Batch size = 32

Evaluating:   0%|          | 0/22 [00:00<?, ?it/s]
Evaluating:   5%|▍         | 1/22 [00:00<00:19,  1.06it/s]
Evaluating:   9%|▉         | 2/22 [00:01<00:17,  1.16it/s]
Evaluating:  14%|█▎        | 3/22 [00:02<00:15,  1.20it/s]
Evaluating:  18%|█▊        | 4/22 [00:03<00:14,  1.22it/s]
Evaluating:  23%|██▎       | 5/22 [00:04<00:13,  1.24it/s]
Evaluating:  27%|██▋       | 6/22 [00:04<00:12,  1.24it/s]
Evaluating:  32%|███▏      | 7/22 [00:05<00:12,  1.25it/s]
Evaluating:  36%|███▋      | 8/22 [00:06<00:11,  1.25it/s]
Evaluating:  41%|████      | 9/22 [00:07<00:10,  1.25it/s]
Evaluating:  45%|████▌     | 10/22 [00:08<00:09,  1.25it/s]
Evaluating:  50%|█████     | 11/22 [00:08<00:08,  1.25it/s]
Evaluating:  55%|█████▍    | 12/22 [00:09<00:07,  1.25it/s]
Evaluating:  59%|█████▉    | 13/22 [00:10<00:07,  1.25it/s]
Evaluating:  64%|██████▎   | 14/22 [00:11<00:06,  1.25it/s]
Evaluating:  68%|██████▊   | 15/22 [00:12<00:05,  1.26it/s]
Evaluating:  73%|███████▎  | 16/22 [00:12<00:04,  1.25it/s]
Evaluating:  77%|███████▋  | 17/22 [00:13<00:03,  1.26it/s]
Evaluating:  82%|████████▏ | 18/22 [00:14<00:03,  1.26it/s]
Evaluating:  86%|████████▋ | 19/22 [00:15<00:02,  1.26it/s]
Evaluating:  91%|█████████ | 20/22 [00:16<00:01,  1.26it/s]
Evaluating:  95%|█████████▌| 21/22 [00:16<00:00,  1.26it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.64it/s]
Evaluating: 100%|██████████| 22/22 [00:17<00:00,  1.29it/s]
2024-08-16 14:09:05.352 | INFO     | __main__:eval:422 - Classification Report for task
                                precision    recall  f1-score   support

          audio-classification     0.7273    0.3810    0.5000        21
  automatic-speech-recognition     0.6531    0.9412    0.7711        34
              depth-estimation     1.0000    1.0000    1.0000         1
            feature-extraction     0.5789    0.2619    0.3607        42
                     fill-mask     0.2273    0.2500    0.2381        60
          image-classification     1.0000    1.0000    1.0000        36
            image-segmentation     1.0000    1.0000    1.0000        12
               mask-generation     1.0000    1.0000    1.0000         2
               multiple-choice     0.1000    0.1176    0.1081        17
              object-detection     1.0000    1.0000    1.0000         6
                   pretraining     0.2000    0.3529    0.2553        17
            question-answering     0.3462    0.3051    0.3243        59
           sentence-similarity     0.4194    0.3824    0.4000        34
                 summarization     0.6000    1.0000    0.7500         3
           text-classification     0.4697    0.3229    0.3827        96
               text-generation     0.9048    0.8636    0.8837        44
                text-to-speech     1.0000    0.5000    0.6667         2
          text2text-generation     0.8525    0.8966    0.8739        58
          token-classification     0.2222    0.4074    0.2876        54
                   translation     0.7143    0.5000    0.5882        10
                       unknown     0.4035    0.3770    0.3898        61
      zero-shot-classification     0.6667    0.2500    0.3636         8
zero-shot-image-classification     0.8000    1.0000    0.8889         4

                      accuracy                         0.5037       681
                     macro avg     0.6472    0.6135    0.6101       681
                  weighted avg     0.5325    0.5037    0.5046       681

2024-08-16 14:09:05.352 | INFO     | __main__:eval:423 - Validation Accuracy for task: 0.5037
2024-08-16 14:09:05.355 | INFO     | __main__:eval:426 - Classification report saved to ./eval/longformer_task_CLCE_32_5e-05_report_3
2024-08-16 14:09:05.355 | INFO     | __main__:eval:454 - Validation loss: 4.096006133339622
2024-08-16 14:09:05.359 | INFO     | __main__:train:256 - epochs: 30
2024-08-16 14:09:05.360 | INFO     | __main__:train:257 - train_loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563, 2.5951157443663653, 2.530434283088235, 2.542398609834559, 2.5334042885724237, 2.5336518918766693]
2024-08-16 14:09:05.360 | INFO     | __main__:train:258 - test_loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627, 3.9991576238112017, 3.994490872729908, 4.003542271527377, 4.044064738533714, 4.096006133339622]
2024-08-16 14:09:05.360 | INFO     | __main__:train:296 - Train loss: [3.9817034132340376, 3.4582227678859936, 3.123426055908203, 3.1444011057124417, 3.085732639537138, 2.9909572026308844, 3.0279437794404873, 2.939073841712054, 2.902874541282654, 2.89146106523626, 2.866700626822079, 2.8328392870285932, 2.797400513817282, 2.822180588105146, 2.80043007626253, 2.7286813203026266, 2.791180407299715, 2.7504825157277724, 2.720807257820578, 2.711960565342623, 2.7064230245702405, 2.596315015063566, 2.5411627166411455, 2.5362349902882295, 2.5053108047036563, 2.5951157443663653, 2.530434283088235, 2.542398609834559, 2.5334042885724237, 2.5336518918766693], Test loss: [4.633326801386747, 4.3744566440582275, 4.136557448994029, 4.07809532772411, 3.9312113523483276, 3.9003078070553867, 3.9666170423681084, 4.068221514875239, 3.879074226726185, 3.916156129403548, 3.808758995749734, 3.879854126410051, 3.745134180242365, 3.777950731190768, 3.779793771830472, 3.7634851282293145, 3.8972615762190386, 3.84952729398554, 3.817299875346097, 3.9152129780162466, 3.899768991903825, 3.9461101943796333, 3.998409477147189, 3.928745139728893, 3.9679910378022627, 3.9991576238112017, 3.994490872729908, 4.003542271527377, 4.044064738533714, 4.096006133339622]
